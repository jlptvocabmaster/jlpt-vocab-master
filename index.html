<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ—¥æœ¬èªž JLPT Vocab Master</title>
<meta name="description" content="Learn Japanese JLPT vocabulary the anime way. Free forever â€” quiz, flashcards, and memory hooks for N5 to N1.">
<meta property="og:title" content="ðŸ‡¯ðŸ‡µ JLPT Vocabulary Master">
<meta property="og:description" content="Learn Japanese the anime way. Quiz mode, flashcards, memory hooks â€” always free for N5 to N1.">
<meta property="og:image" content="https://placehold.co/1200x630/1a1a2e/c0392b?text=%E6%97%A5%E6%9C%AC%E8%AA%9E+JLPT+Vocab+Master">
<meta property="og:type" content="website">
<meta property="og:url" content="https://jlptvocabmaster.github.io/jlpt-vocab-master/">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="ðŸ‡¯ðŸ‡µ JLPT Vocabulary Master">
<meta name="twitter:description" content="Learn Japanese the anime way. Free forever â€” quiz, flashcards, N5 to N1.">
<meta name="twitter:image" content="https://placehold.co/1200x630/1a1a2e/c0392b?text=%E6%97%A5%E6%9C%AC%E8%AA%9E+JLPT+Vocab+Master">
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;700&family=Noto+Sans+JP:wght@400;500;700&family=DM+Serif+Display&display=swap" rel="stylesheet">
<style>
:root {
  --crimson: #c0392b;
  --crimson-dk: #922b21;
  --crimson-lt: #fadbd8;
  --gold: #d4ac0d;
  --gold-lt: #fef9e7;
  --ink: #1a1a2e;
  --paper: #fdf6ec;
  --stone: #7f8c8d;
  --border: #e8ddd0;
  --white: #ffffff;
  --n5: #27ae60; --n4: #2980b9; --n3: #8e44ad; --n2: #e67e22; --n1: #c0392b;
  --radius: 16px;
  --shadow: 0 8px 40px rgba(0,0,0,0.12);
}
/* â”€â”€ DARK MODE â”€â”€ */
body.dark {
  --crimson: #e05a4b;
  --crimson-dk: #c0392b;
  --crimson-lt: #3d1a17;
  --gold: #f0c040;
  --gold-lt: #2a2200;
  --ink: #f0ece4;
  --paper: #0f0f1a;
  --stone: #94a3b8;
  --border: #2a2a3e;
  --white: #1a1a2e;
  --shadow: 0 8px 40px rgba(0,0,0,0.45);
}
body.dark .stripe { background: linear-gradient(180deg, var(--crimson), #e74c3c, var(--gold), var(--crimson)); }
body.dark .lp-tile { background: #1a1a2e; }
body.dark .ms-screen { background: #1a1a2e; }
body.dark .q-card { background: #1a1a2e; }
body.dark .score-wrap { background: linear-gradient(180deg, #1a1a2e 0%, #0f0f1a 100%); }
body.dark .pp-opt { background: #13131f; }
body.dark .intro-inner { background: #1a1a2e; }
body.dark .intro-script-chip { background: #13131f; }
body.dark .intro-level-row { background: #13131f; }
body.dark #kanjiCanvas { opacity: 0.08; }
body.dark .welcome-back { background: linear-gradient(135deg, #0d0d1a, #1a2035); }

/* dark mode toggle button */
.dm-toggle {
  position: fixed; top: 14px; right: 16px; z-index: 500;
  background: var(--white); border: 1.5px solid var(--border);
  border-radius: 99px; padding: 6px 12px; font-size: 0.75rem;
  font-weight: 700; color: var(--ink); cursor: pointer;
  transition: all .2s; display: flex; align-items: center; gap: 5px;
  box-shadow: 0 2px 12px rgba(0,0,0,0.1);
}
.dm-toggle:hover { border-color: var(--crimson); }

* { box-sizing: border-box; margin: 0; padding: 0; }
html { overflow-x: hidden; }
body { font-family: 'Noto Sans JP', sans-serif; background: var(--paper); min-height: 100vh; color: var(--ink); transition: background .3s, color .3s; }

/* Washi texture */
body::before { content: ''; position: fixed; inset: 0; pointer-events: none; z-index: -1; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='300'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='300' height='300' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E"); opacity: 0.5; }

/* Floating kanji canvas */
#kanjiCanvas { position: fixed; inset: 0; z-index: 0; pointer-events: none; opacity: 0.045; }

/* Radial glow centre */
body::after { content: ''; position: fixed; top: 30%; left: 50%; transform: translate(-50%,-50%); width: 600px; height: 600px; background: radial-gradient(circle, rgba(192,57,43,0.07) 0%, transparent 70%); pointer-events: none; border-radius: 50%; z-index: -1; }

.stripe { position: fixed; top: 0; left: 0; bottom: 0; width: 6px; background: linear-gradient(180deg, var(--crimson), #e74c3c, var(--gold), var(--crimson)); z-index: 2; }

/* Welcome back banner */
.welcome-back {
  display: none;
  background: linear-gradient(135deg, var(--ink), #2c3e50);
  border-radius: var(--radius); padding: 16px 18px;
  margin-bottom: 20px; position: relative; overflow: hidden;
  animation: fadeUp .5s ease both;
}
.welcome-back.show { display: flex; align-items: center; gap: 14px; }
.welcome-back::before { content: ''; position: absolute; top: -20px; right: -20px; width: 80px; height: 80px; background: radial-gradient(circle, rgba(212,172,13,0.3), transparent); border-radius: 50%; }
.wb-emoji { font-size: 2rem; flex-shrink: 0; }
.wb-text { flex: 1; }
.wb-title { font-family: 'DM Serif Display', serif; font-size: 1rem; color: var(--gold); margin-bottom: 3px; }
.wb-sub { font-size: 0.75rem; color: #94a3b8; line-height: 1.4; }
.wb-streak { font-family: 'DM Serif Display', serif; font-size: 1.4rem; color: var(--gold); flex-shrink: 0; }

/* â”€â”€ LEVEL CARD RING PROGRESS â”€â”€ */
.lc-ring-wrap {
  position: relative; width: 56px; height: 56px; flex-shrink: 0;
}
.lc-ring { width: 56px; height: 56px; transform: rotate(-90deg); }
.lc-ring-bg { fill: none; stroke: rgba(0,0,0,0.08); stroke-width: 4; }
.lc-ring-fill {
  fill: none; stroke-width: 4; stroke-linecap: round;
  stroke-dasharray: 138.23; stroke-dashoffset: 138.23;
  transition: stroke-dashoffset 1.1s cubic-bezier(.4,0,.2,1) .3s;
}
.lc-ring-label {
  position: absolute; inset: 0; display: flex; flex-direction: column;
  align-items: center; justify-content: center; line-height: 1;
}
.lc-ring-num {
  font-family: 'DM Serif Display', serif; font-size: 0.9rem;
  color: var(--ink); font-weight: 700; line-height: 1;
}
.lc-ring-tot { font-size: 0.5rem; color: var(--stone); margin-top: 1px; }
.lc-info { flex: 1; min-width: 0; }
.lc-badge {
  font-family: 'DM Serif Display', serif; font-size: 1.4rem;
  font-weight: 700; line-height: 1; margin-bottom: 2px;
}
.lc-rank { font-size: 0.62rem; font-weight: 700; color: var(--stone); margin-bottom: 2px; }
.lc-desc { font-size: 0.62rem; color: var(--stone); }

/* Continue session banner */
.continue-bar {
  display: none; background: var(--gold-lt); border: 1.5px solid var(--gold);
  border-radius: 14px; padding: 14px 16px; margin-bottom: 20px;
  animation: fadeUp .4s ease both;
}
.continue-bar.show { display: flex; align-items: center; gap: 12px; }
.continue-bar-text { flex: 1; }
.continue-bar-title { font-weight: 700; font-size: 0.88rem; color: var(--ink); margin-bottom: 2px; }
.continue-bar-sub { font-size: 0.72rem; color: var(--stone); }
.continue-btn { background: var(--gold); color: var(--ink); border: none; border-radius: 10px; padding: 9px 16px; font-family: 'DM Serif Display', serif; font-size: 0.9rem; cursor: pointer; white-space: nowrap; transition: transform .18s; flex-shrink: 0; }
.continue-btn:hover { transform: translateY(-2px); }
.wrapper { position: relative; max-width: 680px; margin: 0 auto; padding: 0 20px 80px; }

/* Support floating button â€” FIXED, never moves */
.support-float {
  position: fixed !important; bottom: 24px; right: 20px; z-index: 9999;
  background: var(--gold); color: var(--ink); border: none;
  border-radius: 99px; padding: 10px 18px;
  font-family: 'Noto Sans JP', sans-serif; font-size: 0.82rem; font-weight: 700;
  cursor: pointer; box-shadow: 0 4px 20px rgba(212,172,13,0.45);
  transition: transform .2s, box-shadow .2s;
  text-decoration: none; display: flex; align-items: center; gap: 6px;
}
.support-float:hover { transform: translateY(-3px); box-shadow: 0 8px 28px rgba(212,172,13,0.55); }

/* â”€â”€ BACK BUTTON in game header â”€â”€ */
.gt-back {
  background: none; border: 1.5px solid var(--border); border-radius: 10px;
  padding: 6px 12px; font-size: 0.78rem; font-weight: 700; color: var(--stone);
  cursor: pointer; transition: all .18s; display: flex; align-items: center; gap: 5px;
}
.gt-back:hover { border-color: var(--crimson); color: var(--crimson); background: var(--crimson-lt); }

/* â”€â”€ SESSION SIZE SELECTOR â”€â”€ */
.session-size-row {
  background: var(--white); border: 1.5px solid var(--border); border-radius: 14px;
  padding: 13px 16px; margin-bottom: 16px;
  transition: border-color .18s;
}
.ss-label { font-size: 0.78rem; font-weight: 700; color: var(--ink); margin-bottom: 9px; }
.ss-pills { display: flex; gap: 7px; margin-bottom: 7px; }
.ss-pill {
  flex: 1; padding: 7px 0; border-radius: 10px; border: 1.5px solid var(--border);
  background: transparent; font-family: 'DM Serif Display', serif;
  font-size: 0.9rem; color: var(--stone); cursor: pointer;
  transition: all .18s;
}
.ss-pill:hover { border-color: var(--crimson); color: var(--crimson); }
.ss-pill.sel { background: var(--crimson); border-color: var(--crimson); color: white; }
.ss-pill.all { border-color: var(--gold); color: var(--gold); }
.ss-pill.all.sel { background: var(--gold); border-color: var(--gold); color: var(--ink); }
.ss-sub { font-size: 0.67rem; color: var(--stone); }

/* â”€â”€ Q progress counter â”€â”€ */
.q-counter {
  font-size: 0.68rem; font-weight: 700; color: var(--stone);
  text-align: center; margin-bottom: 6px; letter-spacing: 0.5px;
}
.q-counter span { color: var(--crimson); font-weight: 700; }

/* â”€â”€ PAST PAPER mode pill â”€â”€ */
.mode-pill.past { border-color: var(--gold); color: var(--gold); }
.mode-pill.past.sel { background: var(--gold); color: var(--ink); border-color: var(--gold); }

/* â”€â”€ STORY SCREEN â”€â”€ */
.story-wrap { background: var(--white); border-radius: 20px; padding: 0; overflow: hidden; box-shadow: var(--shadow); margin-top: 20px; animation: fadeUp .5s ease both; }
.story-hero { background: linear-gradient(135deg, var(--ink), #2c3e50); padding: 32px 24px; text-align: center; position: relative; overflow: hidden; }
.story-hero::before { content: 'ç‰©èªž'; position: absolute; top: -10px; right: -5px; font-family: 'Noto Serif JP', serif; font-size: 6rem; color: rgba(255,255,255,0.04); pointer-events: none; line-height: 1; }
.story-badge { display: inline-block; background: var(--gold); color: var(--ink); border-radius: 99px; padding: 4px 14px; font-size: 0.65rem; font-weight: 700; letter-spacing: 2px; text-transform: uppercase; margin-bottom: 12px; }
.story-hero-title { font-family: 'Noto Serif JP', serif; font-size: 1.6rem; color: white; margin-bottom: 6px; line-height: 1.3; }
.story-hero-sub { font-size: 0.78rem; color: #94a3b8; }
.story-body { padding: 24px; }
.story-loading { text-align: center; padding: 40px 20px; }
.story-loading-bars { display: flex; align-items: flex-end; justify-content: center; gap: 3px; height: 32px; margin-bottom: 14px; }
.story-loading-bars span { display: block; width: 4px; background: var(--crimson); border-radius: 2px; animation: bar-pulse .9s ease-in-out infinite; }
.story-loading-bars span:nth-child(1){height:10px;animation-delay:0s}.story-loading-bars span:nth-child(2){height:20px;animation-delay:.1s}.story-loading-bars span:nth-child(3){height:30px;animation-delay:.2s}.story-loading-bars span:nth-child(4){height:20px;animation-delay:.3s}.story-loading-bars span:nth-child(5){height:12px;animation-delay:.4s}
@keyframes bar-pulse { 0%,100%{transform:scaleY(.3);opacity:.4} 50%{transform:scaleY(1);opacity:1} }
.story-loading-text { font-size: 0.8rem; color: var(--stone); font-style: italic; }
.story-section { margin-bottom: 22px; }
.story-section-label { font-size: 0.6rem; font-weight: 700; letter-spacing: 2.5px; text-transform: uppercase; color: var(--crimson); margin-bottom: 10px; display: flex; align-items: center; gap: 6px; }
.story-jp { font-family: 'Noto Serif JP', serif; font-size: 1.02rem; color: var(--ink); line-height: 2.1; background: #fdf9f5; border-radius: 12px; padding: 16px 18px; border: 1px solid var(--border); margin-bottom: 10px; }
.story-en { font-size: 0.86rem; color: var(--stone); line-height: 1.7; padding: 12px 16px; background: #f8f6f2; border-radius: 10px; border-left: 3px solid var(--gold); }
.story-vocab-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: 10px; }
.story-vocab-chip { background: var(--crimson-lt); border-radius: 10px; padding: 8px 12px; }
.svc-kanji { font-family: 'Noto Serif JP', serif; font-size: 1rem; color: var(--crimson); font-weight: 700; }
.svc-reading { font-size: 0.68rem; color: var(--stone); }
.svc-meaning { font-size: 0.72rem; color: var(--ink); font-weight: 600; }
.story-actions { display: flex; gap: 10px; padding: 0 24px 24px; flex-wrap: wrap; }

/* â”€â”€ PAST PAPER SCREEN â”€â”€ */
.pp-wrap { background: var(--white); border-radius: 20px; overflow: hidden; box-shadow: var(--shadow); margin-top: 20px; animation: fadeUp .4s ease both; }
.pp-header { background: linear-gradient(135deg, #1a1a2e, #2c3e50); padding: 20px 22px 16px; }
.pp-title-row { display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px; }
.pp-title { font-family: 'DM Serif Display', serif; font-size: 1.2rem; color: white; }
.pp-meta { font-size: 0.65rem; color: #94a3b8; letter-spacing: 1px; }
.pp-prog-track { flex: 1; height: 5px; background: rgba(255,255,255,0.1); border-radius: 99px; overflow: hidden; margin-top: 8px; }
.pp-prog-fill { height: 100%; border-radius: 99px; background: var(--gold); transition: width .5s ease; }
.pp-body { padding: 20px 22px; }
.pp-q-type { display: inline-block; border-radius: 6px; padding: 3px 10px; font-size: 0.62rem; font-weight: 700; letter-spacing: 1.5px; text-transform: uppercase; margin-bottom: 12px; }
.pp-q-type.vocab { background: #eaf4fb; color: #2980b9; }
.pp-q-type.grammar { background: #f5eef8; color: #8e44ad; }
.pp-q-type.reading { background: #eafaf1; color: #27ae60; }
.pp-question { font-size: 1rem; color: var(--ink); line-height: 1.9; margin-bottom: 18px; font-family: 'Noto Serif JP', serif; }
.pp-question .blank { display: inline-block; min-width: 60px; border-bottom: 2.5px solid var(--crimson); text-align: center; color: var(--crimson); font-weight: 700; margin: 0 4px; }
.pp-opts { display: flex; flex-direction: column; gap: 9px; margin-bottom: 10px; }
.pp-opt { padding: 12px 16px; background: #f8f6f2; border: 2px solid var(--border); border-radius: 12px; cursor: pointer; font-size: 0.9rem; color: var(--ink); transition: all .18s; text-align: left; display: flex; align-items: center; gap: 10px; font-family: 'Noto Serif JP', serif; }
.pp-opt:hover:not(:disabled) { border-color: var(--crimson); background: var(--crimson-lt); }
.pp-opt.correct { background: #eafaf1 !important; border-color: #27ae60 !important; color: #1e8449; }
.pp-opt.wrong   { background: var(--crimson-lt) !important; border-color: var(--crimson) !important; color: var(--crimson-dk); }
.pp-opt-letter { width: 24px; height: 24px; border-radius: 50%; background: var(--border); display: flex; align-items: center; justify-content: center; font-size: 0.68rem; font-weight: 700; flex-shrink: 0; font-family: 'Noto Sans JP', sans-serif; }
.pp-opt.correct .pp-opt-letter { background: #27ae60; color: white; }
.pp-opt.wrong   .pp-opt-letter { background: var(--crimson); color: white; }
.pp-explanation { display: none; background: var(--ink); border-radius: 12px; padding: 14px 16px; margin-top: 10px; font-size: 0.82rem; color: #e2e8f0; line-height: 1.6; }
.pp-explanation.show { display: block; animation: fadeUp .3s ease; }
.pp-explanation strong { color: var(--gold); }
.pp-score-wrap { padding: 28px 22px; text-align: center; }
.pp-score-jp { font-family: 'Noto Serif JP', serif; font-size: 2rem; color: var(--crimson); margin-bottom: 4px; }
.pp-score-en { font-family: 'DM Serif Display', serif; font-size: 1.3rem; color: var(--ink); margin-bottom: 14px; }
.pp-score-num { font-family: 'DM Serif Display', serif; font-size: 3rem; color: var(--crimson); line-height: 1; margin-bottom: 4px; }
.pp-score-denom { font-size: 0.9rem; color: var(--stone); margin-bottom: 6px; }
.pp-pass-badge { display: inline-block; border-radius: 99px; padding: 6px 20px; font-size: 0.78rem; font-weight: 700; letter-spacing: 1px; margin-bottom: 20px; }
.pp-pass-badge.pass { background: #eafaf1; color: #27ae60; border: 2px solid #27ae60; }
.pp-pass-badge.fail { background: var(--crimson-lt); color: var(--crimson); border: 2px solid var(--crimson); }
.pp-review { text-align: left; margin-bottom: 20px; }
.pp-review-title { font-size: 0.65rem; font-weight: 700; letter-spacing: 2px; text-transform: uppercase; color: var(--stone); margin-bottom: 10px; }
.pp-review-item { display: flex; gap: 10px; padding: 10px 0; border-bottom: 1px solid var(--border); font-size: 0.8rem; align-items: flex-start; }
.pp-review-item:last-child { border-bottom: none; }
.pp-review-dot { width: 20px; height: 20px; border-radius: 50%; flex-shrink: 0; font-size: 0.7rem; display: flex; align-items: center; justify-content: center; }
.pp-review-dot.hit { background: #eafaf1; color: #27ae60; }
.pp-review-dot.miss { background: var(--crimson-lt); color: var(--crimson); }

/* SCREENS */
.screen { display: none; }
.screen.active { display: block; animation: fadeUp .4s ease both; }
@keyframes fadeUp { from { opacity:0; transform:translateY(20px); } to { opacity:1; transform:none; } }

/* â”€â”€ HOME â”€â”€ */
.home-header { text-align: center; padding: 40px 0 24px; border-bottom: 2px solid var(--border); margin-bottom: 28px; }
.jp-title { font-family: 'Noto Serif JP', serif; font-size: clamp(2rem,8vw,3.4rem); color: var(--crimson); letter-spacing: 6px; line-height: 1.2; margin-bottom: 4px; }
.en-title { font-family: 'DM Serif Display', serif; font-size: clamp(0.9rem,3vw,1.15rem); color: var(--stone); letter-spacing: 3px; text-transform: uppercase; }

/* Anime quote card */
.quote-card {
  background: var(--ink); border-radius: var(--radius); padding: 20px 22px;
  margin-bottom: 28px; position: relative; overflow: hidden;
}
.quote-card::before { content: 'ã€Œ'; position: absolute; top: -10px; left: 10px; font-family: 'Noto Serif JP', serif; font-size: 5rem; color: var(--crimson); opacity: 0.2; line-height: 1; pointer-events: none; }
.quote-jp { font-family: 'Noto Serif JP', serif; font-size: 1rem; color: #e2e8f0; line-height: 1.7; margin-bottom: 6px; }
.quote-en { font-size: 0.78rem; color: #94a3b8; font-style: italic; margin-bottom: 8px; line-height: 1.5; }
.quote-source { font-size: 0.68rem; color: var(--gold); font-weight: 700; letter-spacing: 1px; }
.quote-tag { font-size: 0.62rem; color: #475569; letter-spacing: 1px; text-transform: uppercase; margin-bottom: 8px; font-weight: 700; }

.section-label {
  font-size: 0.62rem; font-weight: 700; letter-spacing: 3px;
  text-transform: uppercase; color: var(--stone); margin-bottom: 14px; padding-left: 2px;
  display: flex; align-items: center; gap: 10px;
}
.section-label::after { content: ''; flex: 1; height: 1px; background: var(--border); }

/* Level grid */
.level-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 28px; }
.level-card {
  background: var(--white); border: 2px solid var(--border);
  border-radius: var(--radius); padding: 14px 14px 14px 14px;
  cursor: pointer; transition: all .22s ease;
  position: relative; overflow: hidden;
  display: flex; align-items: center; gap: 12px;
}
.level-card::after {
  content: ''; position: absolute; inset: 0;
  background: linear-gradient(135deg, transparent 60%, rgba(255,255,255,0.5));
  pointer-events: none;
}
.level-card:hover { transform: translateY(-3px); box-shadow: 0 10px 32px rgba(0,0,0,0.1); }
.level-card.selected { border-width: 2.5px; }
.level-card[data-level="N5"].selected{border-color:var(--n5);background:linear-gradient(135deg,#eafaf1,#f8fffe)}
.level-card[data-level="N4"].selected{border-color:var(--n4);background:linear-gradient(135deg,#eaf4fb,#f0f8ff)}
.level-card[data-level="N3"].selected{border-color:var(--n3);background:linear-gradient(135deg,#f5eef8,#fdf5ff)}
.level-card[data-level="N2"].selected{border-color:var(--n2);background:linear-gradient(135deg,#fef5e7,#fffbf0)}
.level-card[data-level="N1"].selected{border-color:var(--n1);background:linear-gradient(135deg,#fdedec,#fff5f5)}
.level-rank { font-size: 0.6rem; font-weight: 700; color: var(--stone); letter-spacing: 1px; margin-bottom: 1px; }
.level-desc { font-size: 0.6rem; color: var(--stone); }
.level-free { display: none; }
.level-kanji { display: none; }

/* Mode pills */
.mode-row { display: flex; gap: 8px; margin-bottom: 24px; flex-wrap: wrap; }
.mode-pill { padding: 9px 14px; background: var(--white); border: 2px solid var(--border); border-radius: 99px; font-size: 0.82rem; font-weight: 700; cursor: pointer; transition: all .18s; color: var(--ink); }
.mode-pill:hover { border-color: var(--crimson); color: var(--crimson); }
.mode-pill.sel { background: var(--crimson); color: white; border-color: var(--crimson); }

.start-btn { width: 100%; padding: 17px; background: var(--crimson); border: none; border-radius: var(--radius); font-family: 'DM Serif Display', serif; font-size: 1.35rem; letter-spacing: 2px; color: white; cursor: pointer; box-shadow: 0 4px 20px rgba(192,57,43,.35); transition: transform .2s, box-shadow .2s; }
.start-btn:hover { transform: translateY(-3px); box-shadow: 0 10px 32px rgba(192,57,43,.45); }

/* â”€â”€ GAME HEADER â”€â”€ */
.game-top { display: flex; align-items: center; justify-content: space-between; padding: 18px 0 12px; border-bottom: 1px solid var(--border); margin-bottom: 18px; position: sticky; top: 0; background: var(--paper); z-index: 5; }
.gt-left { display: flex; flex-direction: column; gap: 2px; }
.gt-level { font-family: 'Noto Serif JP', serif; font-size: 1.1rem; font-weight: 700; }
.gt-rank { font-size: 0.68rem; color: var(--stone); font-weight: 700; letter-spacing: 1px; }
.gt-right { text-align: right; }
.gt-score { font-size: 0.88rem; font-weight: 700; color: var(--gold); }
.gt-lives { font-size: 1rem; letter-spacing: 2px; }
.prog-bar-wrap { height: 6px; background: var(--border); border-radius: 99px; overflow: hidden; margin-bottom: 20px; }
.prog-bar-fill { height: 100%; border-radius: 99px; transition: width .5s cubic-bezier(.4,0,.2,1); }

/* â”€â”€ QUIZ CARD â”€â”€ */
.q-card { background: var(--white); border: 1.5px solid var(--border); border-radius: 20px; padding: 26px 22px 20px; box-shadow: 0 4px 24px rgba(0,0,0,.06); }
.q-tag { display: inline-block; background: var(--crimson-lt); color: var(--crimson); font-size: 0.65rem; font-weight: 700; letter-spacing: 1.5px; text-transform: uppercase; border-radius: 6px; padding: 3px 9px; margin-bottom: 14px; }
.word-header { position: relative; text-align: center; margin-bottom: 18px; }
.kanji-display { font-family: 'Noto Serif JP', serif; font-size: clamp(2rem,9vw,3.2rem); font-weight: 700; color: var(--ink); line-height: 1.2; margin-bottom: 4px; }
.furigana-display { font-size: 0.88rem; color: var(--stone); margin-bottom: 3px; }
.romaji-display { font-size: 0.78rem; color: #aaa; font-style: italic; }
.origin-btn {
  position: absolute; top: 0; right: 0;
  background: none; border: 2px solid var(--border);
  border-radius: 10px; padding: 6px 10px; cursor: pointer;
  font-size: 1rem; color: var(--stone);
  transition: all .18s; line-height: 1;
}
.origin-btn:hover { border-color: var(--gold); background: var(--gold-lt); transform: scale(1.1); }

.opts-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 9px; }
.opt-btn { background: #f8f6f2; border: 2px solid var(--border); border-radius: 12px; padding: 12px 10px; font-family: 'Noto Sans JP', sans-serif; font-size: 0.86rem; font-weight: 700; color: var(--ink); cursor: pointer; text-align: center; line-height: 1.4; transition: all .16s ease; }
.opt-btn:hover:not(:disabled) { border-color: var(--crimson); background: var(--crimson-lt); transform: translateY(-2px); }
.opt-btn.correct { border-color: #27ae60; background: #eafaf1; color: #1e8449; animation: pulse .35s ease; }
.opt-btn.wrong { border-color: var(--crimson); background: var(--crimson-lt); color: var(--crimson-dk); animation: jolt .3s ease; }
@keyframes pulse { 0%,100%{transform:scale(1)} 50%{transform:scale(1.04)} }
@keyframes jolt { 0%,100%{transform:translateX(0)} 30%{transform:translateX(-6px)} 70%{transform:translateX(6px)} }

.fill-wrap { display: flex; flex-direction: column; gap: 9px; }
.fill-inp { width: 100%; padding: 12px 14px; border: 2px solid var(--border); border-radius: 12px; font-family: 'Noto Sans JP', sans-serif; font-size: 1rem; font-weight: 600; color: var(--ink); background: #f8f6f2; outline: none; transition: border-color .2s; }
.fill-inp:focus { border-color: var(--crimson); background: white; }
.fill-inp.correct { border-color: #27ae60; background: #eafaf1; }
.fill-inp.wrong { border-color: var(--crimson); background: var(--crimson-lt); }
.fill-sub { padding: 12px; background: var(--crimson); color: white; border: none; border-radius: 12px; font-family: 'DM Serif Display', serif; font-size: 1.05rem; letter-spacing: 1px; cursor: pointer; transition: transform .18s; }
.fill-sub:hover { transform: translateY(-2px); }

.flashcard-scene { perspective: 1000px; width: 100%; cursor: pointer; margin-bottom: 12px; }
.flashcard { width: 100%; min-height: 180px; position: relative; transform-style: preserve-3d; transition: transform .6s cubic-bezier(.4,0,.2,1); border-radius: 20px; }
.flashcard.flipped { transform: rotateY(180deg); }
.card-face { position: absolute; inset: 0; backface-visibility: hidden; border-radius: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 26px 22px; border: 1.5px solid var(--border); background: var(--white); box-shadow: 0 4px 24px rgba(0,0,0,.06); }
.card-back { transform: rotateY(180deg); background: var(--ink); border-color: var(--ink); color: white; }
.flip-hint { font-size: 0.68rem; color: var(--stone); letter-spacing: 1px; margin-top: 10px; }
.flashcard-btns { display: flex; gap: 10px; margin-top: 6px; }
.fc-btn { flex: 1; padding: 12px; border: none; border-radius: 12px; font-family: 'DM Serif Display', serif; font-size: 0.9rem; cursor: pointer; transition: transform .18s; }
.fc-btn:hover { transform: translateY(-2px); }
.fc-got { background: #eafaf1; color: #1e8449; border: 2px solid #27ae60; }
.fc-miss { background: var(--crimson-lt); color: var(--crimson); border: 2px solid var(--crimson); }

/* Anime sensei wrong answer quote */
.sensei-quote { margin-top: 10px; background: var(--ink); border-radius: 12px; padding: 12px 14px; display: none; }
.sensei-quote.show { display: block; animation: fadeUp .3s ease; }
.sensei-text { font-size: 0.78rem; color: #94a3b8; font-style: italic; line-height: 1.5; }
.sensei-src { font-size: 0.65rem; color: var(--gold); margin-top: 4px; font-weight: 700; }

.feedback { margin-top: 12px; padding: 11px 14px; border-radius: 12px; font-weight: 600; font-size: 0.86rem; display: none; line-height: 1.5; gap: 6px; align-items: flex-start; }
.feedback.show { display: flex; animation: fadeUp .3s ease; }
.feedback.good { background: #eafaf1; color: #1e8449; }
.feedback.bad { background: var(--crimson-lt); color: var(--crimson-dk); }
.next-btn { width: 100%; margin-top: 10px; padding: 13px; background: var(--ink); border: none; border-radius: 12px; color: white; font-family: 'DM Serif Display', serif; font-size: 1.05rem; letter-spacing: 1px; cursor: pointer; display: none; transition: background .2s, transform .2s; }
.next-btn:hover { background: var(--crimson); transform: translateY(-2px); }
.next-btn.show { display: block; animation: fadeUp .3s .1s both; }

/* â”€â”€ ORIGIN PANEL â”€â”€ */
.panel-overlay { display: none; position: fixed; inset: 0; background: rgba(26,26,46,0.65); backdrop-filter: blur(4px); z-index: 200; align-items: flex-end; justify-content: center; padding: 0; }
.panel-overlay.show { display: flex; animation: fadeUp .3s ease; }
.origin-panel {
  background: var(--white); border-radius: 24px 24px 0 0; width: 100%; max-width: 680px;
  padding: 28px 24px 40px; max-height: 85vh; overflow-y: auto;
  animation: slideUp .35s cubic-bezier(.4,0,.2,1) both;
}
@keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
.panel-handle { width: 40px; height: 4px; background: var(--border); border-radius: 99px; margin: 0 auto 20px; }
.panel-word { font-family: 'Noto Serif JP', serif; font-size: 2rem; font-weight: 700; color: var(--crimson); text-align: center; margin-bottom: 4px; }
.panel-reading { font-size: 0.85rem; color: var(--stone); text-align: center; margin-bottom: 20px; }
.panel-close { position: absolute; top: 16px; right: 20px; background: none; border: none; font-size: 1.4rem; cursor: pointer; color: var(--stone); }
.origin-section { margin-bottom: 18px; padding-bottom: 18px; border-bottom: 1px solid var(--border); }
.origin-section:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0; }
.origin-section-title { font-size: 0.65rem; font-weight: 700; letter-spacing: 2px; text-transform: uppercase; color: var(--crimson); margin-bottom: 8px; display: flex; align-items: center; gap: 6px; }
.origin-section-body { font-size: 0.88rem; color: var(--ink); line-height: 1.7; }
.origin-section-body strong { color: var(--crimson); }
.radical-pills { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px; }
.radical-pill { background: #f8f6f2; border: 1.5px solid var(--border); border-radius: 10px; padding: 6px 12px; font-size: 0.82rem; }
.radical-pill .rp-kanji { font-family: 'Noto Serif JP', serif; font-size: 1.1rem; color: var(--crimson); display: block; text-align: center; }
.radical-pill .rp-mean { font-size: 0.65rem; color: var(--stone); display: block; text-align: center; margin-top: 2px; }
.related-row { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px; }
.related-chip { background: var(--crimson-lt); border-radius: 8px; padding: 5px 10px; font-size: 0.82rem; color: var(--crimson-dk); font-family: 'Noto Serif JP', serif; }

/* â”€â”€ MODALS â”€â”€ */
.modal-overlay { display: none; position: fixed; inset: 0; background: rgba(26,26,46,0.72); backdrop-filter: blur(4px); z-index: 100; align-items: center; justify-content: center; padding: 20px; }
.modal-overlay.show { display: flex; animation: fadeUp .3s ease; }
.modal-box { background: var(--white); border-radius: 24px; padding: 34px 26px; max-width: 420px; width: 100%; text-align: center; position: relative; box-shadow: 0 24px 80px rgba(0,0,0,.25); }
.modal-icon { font-size: 3rem; margin-bottom: 10px; }
.modal-title { font-family: 'DM Serif Display', serif; font-size: 1.5rem; color: var(--ink); margin-bottom: 8px; }
.modal-sub { font-size: 0.86rem; color: var(--stone); margin-bottom: 22px; line-height: 1.6; }
.modal-btn { width: 100%; padding: 14px; background: var(--crimson); border: none; border-radius: 12px; color: white; font-family: 'DM Serif Display', serif; font-size: 1.1rem; cursor: pointer; transition: transform .18s; margin-bottom: 10px; display: block; text-decoration: none; }
.modal-btn:hover { transform: translateY(-2px); }
.modal-btn-gold { background: var(--gold); color: var(--ink); }
.modal-dismiss { font-size: 0.78rem; color: var(--stone); cursor: pointer; text-decoration: underline; display: block; }
.modal-dismiss:hover { color: var(--crimson); }

/* Email form */
.email-form { display: flex; flex-direction: column; gap: 9px; margin-bottom: 14px; }
.email-inp { width: 100%; padding: 12px 14px; border: 2px solid var(--border); border-radius: 12px; font-family: 'Noto Sans JP', sans-serif; font-size: 0.95rem; color: var(--ink); outline: none; transition: border-color .2s; }
.email-inp:focus { border-color: var(--crimson); }

/* â”€â”€ SCORE â”€â”€ */
.score-wrap { background: var(--white); border-radius: 20px; padding: 34px 22px; text-align: center; box-shadow: var(--shadow); margin-top: 20px; }
.score-jp { font-family: 'Noto Serif JP', serif; font-size: 2.4rem; color: var(--crimson); margin-bottom: 4px; }
.score-en { font-family: 'DM Serif Display', serif; font-size: 1.45rem; color: var(--ink); margin-bottom: 8px; }
.score-num { font-family: 'DM Serif Display', serif; font-size: 3rem; color: var(--crimson); line-height: 1; }
.score-denom { font-size: 1rem; color: var(--stone); margin-bottom: 4px; }
.score-sub { font-size: 0.86rem; color: var(--stone); margin-bottom: 20px; }
.dots-row { display: flex; flex-wrap: wrap; justify-content: center; gap: 5px; margin-bottom: 20px; }
.dot { width: 23px; height: 23px; border-radius: 50%; font-size: 0.75rem; display: flex; align-items: center; justify-content: center; }
.dot.hit { background: #eafaf1; } .dot.miss { background: var(--crimson-lt); }
.score-actions { display: flex; gap: 10px; }
.sc-btn { flex: 1; padding: 13px; border-radius: 12px; border: none; font-family: 'DM Serif Display', serif; font-size: 0.95rem; letter-spacing: 1px; cursor: pointer; transition: transform .18s; }
.sc-btn:hover { transform: translateY(-2px); }
.sc-home { background: #f1f5f9; color: var(--ink); }
.sc-again { background: var(--crimson); color: white; }

/* Score anime quote */
.score-quote { background: var(--ink); border-radius: 14px; padding: 16px 18px; margin-bottom: 20px; text-align: left; }
.sq-label { font-size: 0.6rem; color: var(--gold); font-weight: 700; letter-spacing: 2px; text-transform: uppercase; margin-bottom: 6px; }
.sq-jp { font-family: 'Noto Serif JP', serif; font-size: 0.9rem; color: #e2e8f0; line-height: 1.6; margin-bottom: 4px; }
.sq-en { font-size: 0.75rem; color: #94a3b8; font-style: italic; margin-bottom: 4px; }
.sq-src { font-size: 0.62rem; color: var(--gold); font-weight: 700; }

/* â”€â”€ XP & STREAK HUD â”€â”€ */
.xp-hud {
  display: flex; align-items: center; gap: 10px;
  background: var(--ink); border-radius: 12px; padding: 8px 14px;
  margin-bottom: 14px; position: sticky; top: 62px; z-index: 4;
}
.xp-bar-wrap { flex: 1; }
.xp-bar-label { display: flex; justify-content: space-between; font-size: 0.62rem; color: #94a3b8; font-weight: 700; letter-spacing: 1px; margin-bottom: 4px; }
.xp-bar-track { height: 5px; background: #2c3e50; border-radius: 99px; overflow: hidden; }
.xp-bar-fill { height: 100%; border-radius: 99px; background: linear-gradient(90deg, var(--gold), #f39c12); transition: width 0.6s cubic-bezier(.4,0,.2,1); }
.xp-streak { font-size: 0.9rem; font-weight: 700; color: var(--gold); white-space: nowrap; flex-shrink: 0; }
.xp-rank-badge { font-size: 0.7rem; font-weight: 700; color: var(--gold); flex-shrink: 0; letter-spacing: 1px; }

/* XP pop float animation */
.xp-pop {
  position: fixed; pointer-events: none; z-index: 999;
  font-family: 'DM Serif Display', serif; font-size: 1.1rem;
  font-weight: 700; color: var(--gold);
  text-shadow: 0 2px 8px rgba(0,0,0,0.4);
  animation: xpFloat 1.2s ease forwards;
}
@keyframes xpFloat {
  0%   { opacity: 1; transform: translateY(0) scale(1); }
  60%  { opacity: 1; transform: translateY(-40px) scale(1.2); }
  100% { opacity: 0; transform: translateY(-70px) scale(0.9); }
}

/* Level-up toast */
.levelup-toast {
  position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
  background: linear-gradient(135deg, var(--gold), #f39c12);
  color: var(--ink); border-radius: 99px; padding: 10px 22px;
  font-family: 'DM Serif Display', serif; font-size: 1rem; font-weight: 700;
  box-shadow: 0 8px 32px rgba(212,172,13,0.5); z-index: 1000;
  animation: toastIn .4s ease, toastOut .4s ease 2.2s forwards;
  white-space: nowrap;
}
@keyframes toastIn { from { opacity:0; transform:translateX(-50%) translateY(-20px); } to { opacity:1; transform:translateX(-50%) translateY(0); } }
@keyframes toastOut { to { opacity:0; transform:translateX(-50%) translateY(-20px); } }

/* Score XP summary */
.score-xp-summary { background: linear-gradient(135deg, var(--ink), #2c3e50); border-radius: 14px; padding: 16px 18px; margin-bottom: 18px; display: flex; align-items: center; gap: 14px; }
.sxp-icon { font-size: 2rem; flex-shrink: 0; }
.sxp-text { flex: 1; }
.sxp-title { font-family: 'DM Serif Display', serif; font-size: 1rem; color: var(--gold); margin-bottom: 2px; }
.sxp-sub { font-size: 0.75rem; color: #94a3b8; }
.sxp-total { font-family: 'DM Serif Display', serif; font-size: 1.4rem; color: var(--gold); flex-shrink: 0; }
.share-app-btn {
  display: flex; align-items: center; justify-content: center; gap: 8px;
  width: 100%; padding: 11px; margin-bottom: 24px;
  background: var(--white); border: 2px dashed var(--border); border-radius: var(--radius);
  font-family: 'Noto Sans JP', sans-serif; font-size: 0.82rem; font-weight: 700;
  color: var(--stone); cursor: pointer; transition: all .2s;
}
.share-app-btn:hover { border-color: var(--crimson); color: var(--crimson); background: var(--crimson-lt); }

.sc-share { background: #f0fdf4; color: #166534; border: 2px solid #86efac; flex: 1; }

.share-word-btn {
  display: inline-flex; align-items: center; gap: 5px;
  background: none; border: 1.5px solid var(--border);
  border-radius: 8px; padding: 5px 10px; cursor: pointer;
  font-size: 0.72rem; font-weight: 700; color: var(--stone);
  transition: all .18s; margin-top: 10px;
}
.share-word-btn:hover { border-color: var(--gold); color: var(--gold); background: var(--gold-lt); }

/* Share modal */
.share-modal-box { background: var(--white); border-radius: 24px; padding: 28px 22px; max-width: 380px; width: 100%; text-align: center; position: relative; box-shadow: 0 24px 80px rgba(0,0,0,.25); }
.share-title { font-family: 'DM Serif Display', serif; font-size: 1.25rem; color: var(--ink); margin-bottom: 6px; }
.share-text-preview { background: #f8f6f2; border: 1.5px solid var(--border); border-radius: 10px; padding: 12px 14px; font-size: 0.82rem; color: var(--stone); margin-bottom: 16px; line-height: 1.6; text-align: left; }
.share-socials { display: grid; grid-template-columns: 1fr 1fr; gap: 9px; margin-bottom: 12px; }
.share-soc-btn { padding: 11px 8px; border: none; border-radius: 10px; font-size: 0.8rem; font-weight: 700; cursor: pointer; transition: transform .16s, opacity .16s; display: flex; align-items: center; justify-content: center; gap: 6px; }
.share-soc-btn:hover { transform: translateY(-2px); opacity: 0.9; }
.soc-twitter { background: #000; color: white; }
.soc-whatsapp { background: #25d366; color: white; }
.soc-facebook { background: #1877f2; color: white; }
.soc-linkedin { background: #0a66c2; color: white; }
.copy-link-btn { width: 100%; padding: 11px; background: #f8f6f2; border: 1.5px solid var(--border); border-radius: 10px; font-family: 'Noto Sans JP', sans-serif; font-size: 0.82rem; font-weight: 700; color: var(--stone); cursor: pointer; transition: all .18s; margin-bottom: 10px; display: flex; align-items: center; justify-content: center; gap: 6px; }
.copy-link-btn:hover { border-color: var(--crimson); color: var(--crimson); }
.copy-link-btn.copied { border-color: #27ae60; color: #27ae60; background: #eafaf1; }

/* â”€â”€ FLOATING SHARE BUTTON + POP MENU â”€â”€ */
.share-fab-wrap {
  position: fixed; bottom: 24px; left: 20px; z-index: 50;
  display: flex; flex-direction: column-reverse; align-items: flex-start; gap: 10px;
}
.share-fab {
  width: 46px; height: 46px; border-radius: 50%;
  background: var(--crimson); color: white; border: none;
  font-size: 1.1rem; cursor: pointer;
  box-shadow: 0 4px 18px rgba(192,57,43,0.45);
  display: flex; align-items: center; justify-content: center;
  transition: transform .2s, box-shadow .2s;
  flex-shrink: 0;
}
.share-fab:hover { transform: scale(1.1); box-shadow: 0 6px 24px rgba(192,57,43,0.55); }
.share-fab.open { background: var(--ink); transform: rotate(45deg); }

.share-fan {
  display: flex; flex-direction: column-reverse; gap: 8px;
  overflow: hidden; max-height: 0;
  transition: max-height .35s cubic-bezier(.4,0,.2,1), opacity .25s ease;
  opacity: 0; pointer-events: none;
}
.share-fan.open {
  max-height: 320px; opacity: 1; pointer-events: auto;
}
.sfan-btn {
  width: 40px; height: 40px; border-radius: 50%; border: none;
  display: flex; align-items: center; justify-content: center;
  cursor: pointer; box-shadow: 0 3px 12px rgba(0,0,0,0.25);
  transition: transform .18s, box-shadow .18s;
  transform: scale(0); opacity: 0;
}
.share-fan.open .sfan-btn {
  transform: scale(1); opacity: 1;
}
/* stagger each icon */
.share-fan.open .sfan-btn:nth-child(1) { transition: transform .2s .04s, opacity .2s .04s, box-shadow .18s; }
.share-fan.open .sfan-btn:nth-child(2) { transition: transform .2s .09s, opacity .2s .09s, box-shadow .18s; }
.share-fan.open .sfan-btn:nth-child(3) { transition: transform .2s .14s, opacity .2s .14s, box-shadow .18s; }
.share-fan.open .sfan-btn:nth-child(4) { transition: transform .2s .19s, opacity .2s .19s, box-shadow .18s; }
.share-fan.open .sfan-btn:nth-child(5) { transition: transform .2s .24s, opacity .2s .24s, box-shadow .18s; }
.sfan-btn:hover { transform: scale(1.15) !important; box-shadow: 0 5px 18px rgba(0,0,0,0.3); }
.sfan-btn svg { width: 18px; height: 18px; }
.sfan-tw  { background: #000; color: white; }
.sfan-wa  { background: #25d366; color: white; }
.sfan-fb  { background: #1877f2; color: white; }
.sfan-rd  { background: #ff4500; color: white; }
.sfan-li  { background: #0a66c2; color: white; }

/* tooltip labels on hover */
.sfan-btn { position: relative; }
.sfan-btn::after {
  content: attr(data-tip);
  position: absolute; left: 52px; top: 50%; transform: translateY(-50%);
  background: var(--ink); color: white; border-radius: 8px;
  padding: 4px 10px; font-size: 0.7rem; font-weight: 700;
  white-space: nowrap; pointer-events: none;
  opacity: 0; transition: opacity .15s;
}
.sfan-btn:hover::after { opacity: 1; }

/* â”€â”€ DAILY WORD OF THE DAY â”€â”€ */
.daily-word-card {
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
  border-radius: var(--radius); padding: 20px 22px;
  margin-bottom: 20px; position: relative; overflow: hidden;
  animation: fadeUp .5s .1s ease both;
  border: 1px solid rgba(212,172,13,0.2);
  cursor: pointer;
}
.daily-word-card::before {
  content: 'ä»Šæ—¥';
  position: absolute; top: -8px; right: -5px;
  font-family: 'Noto Serif JP', serif; font-size: 5.5rem;
  color: rgba(212,172,13,0.06); pointer-events: none; line-height: 1;
}
.dw-label {
  font-size: 0.6rem; font-weight: 700; letter-spacing: 2.5px;
  text-transform: uppercase; color: var(--gold); margin-bottom: 10px;
  display: flex; align-items: center; gap: 7px;
}
.dw-label::after {
  content: ''; flex: 1; height: 1px; background: rgba(212,172,13,0.2);
}
.dw-streak-badge {
  background: rgba(212,172,13,0.15); border: 1px solid rgba(212,172,13,0.3);
  border-radius: 99px; padding: 2px 9px; font-size: 0.62rem;
  color: var(--gold); font-weight: 700; margin-left: auto; flex-shrink: 0;
}
.dw-main {
  display: flex; align-items: center; gap: 16px; margin-bottom: 12px;
}
.dw-kanji {
  font-family: 'Noto Serif JP', serif; font-size: 3rem;
  color: white; line-height: 1; flex-shrink: 0;
  text-shadow: 0 0 30px rgba(212,172,13,0.4);
}
.dw-info { flex: 1; }
.dw-reading {
  font-size: 0.72rem; color: #94a3b8; margin-bottom: 3px;
  letter-spacing: 0.5px;
}
.dw-meaning {
  font-family: 'DM Serif Display', serif; font-size: 1.15rem;
  color: white; margin-bottom: 4px;
}
.dw-level {
  display: inline-block; font-size: 0.58rem; font-weight: 700;
  letter-spacing: 1px; border-radius: 4px; padding: 2px 7px;
  background: rgba(255,255,255,0.08); color: #94a3b8;
}
.dw-hook {
  font-size: 0.78rem; color: #cbd5e1; line-height: 1.55;
  background: rgba(255,255,255,0.04); border-radius: 10px;
  padding: 10px 13px; border-left: 3px solid rgba(212,172,13,0.5);
  margin-bottom: 12px;
}
.dw-footer {
  display: flex; align-items: center; justify-content: space-between;
  font-size: 0.65rem;
}
.dw-seen-badge {
  background: rgba(39,174,96,0.15); border: 1px solid rgba(39,174,96,0.3);
  border-radius: 99px; padding: 2px 9px; color: #27ae60; font-weight: 700;
}
.dw-seen-badge.new {
  background: rgba(192,57,43,0.15); border-color: rgba(192,57,43,0.3);
  color: var(--crimson);
}
.dw-cta {
  font-size: 0.68rem; color: #94a3b8;
  opacity: 0.7;
}


/* â”€â”€ AESTHETIC OVERHAUL â”€â”€ */

/* Enhanced root colors */
:root {
  --glow-crimson: rgba(192,57,43,0.15);
  --glow-gold: rgba(212,172,13,0.2);
}

/* Richer background */
body { background: #fdf4e8; }

/* Enhanced header */
.home-header .jp-title {
  background: linear-gradient(135deg, var(--crimson) 0%, #e74c3c 40%, var(--gold) 100%);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
  background-clip: text;
}

/* Enhanced quote card */
.quote-card {
  background: linear-gradient(145deg, #141428 0%, #1a1a2e 50%, #0d1117 100%);
  border: 1px solid rgba(212,172,13,0.15);
  box-shadow: 0 8px 32px rgba(0,0,0,0.2), inset 0 1px 0 rgba(255,255,255,0.05);
}

/* Enhanced mode pills */
.mode-row { display: flex; flex-wrap: wrap; gap: 7px; margin-bottom: 16px; }
.mode-pill {
  flex: 1; min-width: calc(33% - 8px);
  padding: 9px 6px; border-radius: 11px;
  border: 1.5px solid var(--border);
  background: var(--white); font-family: 'Noto Sans JP', sans-serif;
  font-size: 0.73rem; font-weight: 700; color: var(--stone);
  cursor: pointer; transition: all .18s; text-align: center;
  white-space: nowrap;
}
.mode-pill:hover { border-color: var(--crimson); color: var(--crimson); background: var(--crimson-lt); }
.mode-pill.sel {
  background: linear-gradient(135deg, var(--crimson), #e74c3c);
  border-color: transparent; color: white;
  box-shadow: 0 4px 14px rgba(192,57,43,0.35);
}
.mode-pill.past { border-color: var(--gold); color: #b8860b; }
.mode-pill.past.sel {
  background: linear-gradient(135deg, var(--gold), #f0c030);
  border-color: transparent; color: var(--ink);
  box-shadow: 0 4px 14px rgba(212,172,13,0.35);
}

/* Enhanced start button */
.start-btn {
  background: linear-gradient(135deg, var(--crimson) 0%, #e74c3c 50%, #c0392b 100%);
  box-shadow: 0 6px 24px rgba(192,57,43,0.4), 0 2px 4px rgba(0,0,0,0.1);
  border: none; position: relative; overflow: hidden;
  transition: all .22s ease;
}
.start-btn::before {
  content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.12), transparent);
  transition: left .5s ease;
}
.start-btn:hover { transform: translateY(-3px); box-shadow: 0 10px 32px rgba(192,57,43,0.5); }
.start-btn:hover::before { left: 100%; }
.start-btn:active { transform: translateY(0); }

/* Enhanced share-app-btn */
.share-app-btn {
  background: var(--white);
  transition: all .18s;
}

/* Enhanced session size row */
.session-size-row {
  background: linear-gradient(135deg, #fff 0%, #fdf9f3 100%);
  box-shadow: 0 2px 12px rgba(0,0,0,0.04);
}

/* Enhanced welcome back */
.welcome-back {
  box-shadow: 0 6px 24px rgba(0,0,0,0.15);
  border: 1px solid rgba(212,172,13,0.1);
}

/* Enhanced level cards */
.level-card {
  box-shadow: 0 2px 12px rgba(0,0,0,0.05);
}
.level-card:hover {
  box-shadow: 0 10px 32px rgba(0,0,0,0.12);
}
.level-card.selected {
  box-shadow: 0 6px 20px rgba(0,0,0,0.1);
}

/* Score screen enhancement */
.score-wrap {
  background: linear-gradient(180deg, #fff 0%, var(--paper) 100%);
}

/* Game screen card enhancement */
.q-card {
  box-shadow: 0 8px 32px rgba(0,0,0,0.08), 0 2px 8px rgba(0,0,0,0.04);
  border: 1px solid rgba(232,221,208,0.6);
}

/* Subtle page shimmer on wrapper */
/* wrapper isolation removed â€” would trap fixed positioned elements */


/* â”€â”€â”€ NEW LEVEL-PICKER HOME â”€â”€â”€ */
.home-hdr {
  text-align:center; padding:36px 0 8px;
  animation: fadeUp .5s ease both;
}
.home-hdr-jp {
  font-family:'DM Serif Display',serif; font-size:2.2rem;
  color:var(--ink); letter-spacing:3px; line-height:1;
}
.home-hdr-en {
  font-size:0.65rem; color:var(--stone);
  letter-spacing:2px; margin-top:6px; text-transform:uppercase;
}

/* mini stat pill */
.home-pill {
  display:flex; align-items:center; justify-content:center;
  gap:10px; margin:10px auto 18px; width:fit-content;
  background:var(--white); border:1.5px solid var(--border);
  border-radius:99px; padding:6px 16px;
  font-size:0.7rem; font-weight:700; color:var(--ink);
  animation: fadeUp .4s ease both .1s;
}
.home-pill-sep { color:var(--border); }

/* level picker label */
.lp-label {
  text-align:center; font-size:0.6rem; font-weight:700;
  letter-spacing:2.5px; text-transform:uppercase; color:var(--stone);
  margin-bottom:12px; animation: fadeUp .4s ease both .15s;
}

/* level picker grid */
.lp-grid {
  display:grid; grid-template-columns:1fr 1fr; gap:10px;
  margin-bottom:14px; animation: fadeUp .4s ease both .2s;
}

/* individual level tile */
.lp-tile {
  position:relative; background:var(--white);
  border:2px solid var(--border); border-radius:18px;
  padding:16px 12px 14px; cursor:pointer; overflow:hidden;
  transition: transform .22s cubic-bezier(.34,1.56,.64,1),
              box-shadow .22s, border-color .18s;
  display:flex; flex-direction:column; gap:2px;
  -webkit-tap-highlight-color: transparent;
}
.lp-tile:hover  { transform:translateY(-5px) scale(1.01); box-shadow:0 14px 40px rgba(0,0,0,.13); }
.lp-tile:active { transform:scale(.96); transition:transform .1s; }
.lp-tile.lp-n1  { grid-column:span 2; flex-direction:row; align-items:center; gap:12px; }
.lp-tile.lp-n1 .lp-ring { margin-left:auto; margin-top:0; }

/* colour glow overlay */
.lp-glow {
  position:absolute; inset:0; pointer-events:none; opacity:0;
  transition:opacity .3s;
  background:radial-gradient(ellipse at 25% 60%,
    color-mix(in srgb, var(--tc) 22%, transparent) 0%,
    transparent 65%);
}
.lp-tile:hover .lp-glow { opacity:1; }

/* tile text */
.lp-lvname {
  font-family:'DM Serif Display',serif; font-size:1.9rem;
  font-weight:700; line-height:1; color:var(--tc);
}
.lp-kana  { font-size:0.58rem; color:var(--stone); margin-top:2px; }
.lp-rank  { font-size:0.68rem; font-weight:700; color:var(--ink); margin-top:5px; }
.lp-desc  { font-size:0.6rem; color:var(--stone); }

/* progress ring inside tile */
.lp-ring {
  position:relative; width:50px; height:50px;
  flex-shrink:0; margin-top:auto; align-self:flex-end;
}
.lp-ring svg { display:block; }
.lp-ring-txt {
  position:absolute; inset:0; display:flex; flex-direction:column;
  align-items:center; justify-content:center;
  font-family:'DM Serif Display',serif; font-size:0.78rem;
  font-weight:700; line-height:1; color:var(--ink);
}
.lp-ring-txt small {
  font-size:0.48rem; color:var(--stone); font-family:sans-serif; font-weight:400;
}

/* bottom utility bar */
.lp-utils {
  display:flex; gap:8px; margin-bottom:24px;
  animation: fadeUp .4s ease both .3s;
}
.lp-util-btn {
  flex:1; padding:10px 6px; background:var(--white);
  border:1.5px solid var(--border); border-radius:12px;
  font-size:0.7rem; font-weight:700; color:var(--stone);
  cursor:pointer; transition:all .18s; text-align:center;
}
.lp-util-btn:hover {
  border-color:var(--crimson); color:var(--crimson);
  background:var(--crimson-lt);
}

/* â”€â”€â”€ MODE SCREEN â”€â”€â”€ */
.ms-screen {
  background:var(--white); border-radius:20px;
  box-shadow:var(--shadow); margin-top:16px;
  overflow:hidden; animation:fadeUp .3s ease both;
}
.ms-topbar {
  display:flex; align-items:center; justify-content:space-between;
  padding:14px 16px; border-bottom:1.5px solid var(--border);
}
.ms-topbar-badge {
  font-family:'DM Serif Display',serif; font-size:1.6rem;
  font-weight:700;
}
.ms-title {
  font-family:'DM Serif Display',serif; font-size:1.05rem;
  color:var(--ink); padding:14px 18px 4px;
}
.ms-sub {
  font-size:0.66rem; color:var(--stone);
  padding:0 18px 12px; letter-spacing:.5px;
}
.ms-quote-box {
  margin:0 18px 14px; background:#f8f6f2; border-radius:12px;
  padding:10px 14px; border-left:3px solid var(--gold);
  font-size:0.78rem; color:var(--stone); line-height:1.65; font-style:italic;
}
.ms-modes-lbl {
  padding:0 18px 10px; font-size:0.58rem; font-weight:700;
  letter-spacing:2.5px; text-transform:uppercase; color:var(--stone);
}
.ms-mode-grid {
  display:grid; grid-template-columns:1fr 1fr; gap:9px;
  padding:0 18px 14px;
}
.ms-mode-card {
  border:2px solid var(--border); border-radius:14px;
  padding:14px 10px 12px; cursor:pointer; text-align:center;
  background:var(--paper); transition:all .18s;
  -webkit-tap-highlight-color: transparent;
}
.ms-mode-card:hover  { border-color:var(--crimson); background:var(--crimson-lt); }
.ms-mode-card.active { border-color:var(--crimson); background:var(--crimson-lt); }
.ms-mode-card.pp-card { grid-column:span 2; display:flex; align-items:center; gap:10px; text-align:left; padding:12px 14px; }
.ms-mode-icon { font-size:1.5rem; margin-bottom:4px; }
.ms-mode-card.pp-card .ms-mode-icon { margin-bottom:0; flex-shrink:0; }
.ms-mode-name { font-family:'DM Serif Display',serif; font-size:0.9rem; color:var(--ink); }
.ms-mode-hint { font-size:0.6rem; color:var(--stone); margin-top:2px; }

.ms-size-section {
  padding:14px 18px 14px;
  border-top:1.5px solid var(--border);
}
.ms-size-lbl { font-size:0.7rem; font-weight:700; color:var(--ink); margin-bottom:9px; }
.ms-size-pills { display:flex; gap:8px; margin-bottom:6px; }
.ms-size-pill {
  flex:1; padding:8px 0; border-radius:10px; border:1.5px solid var(--border);
  background:transparent; font-family:'DM Serif Display',serif;
  font-size:0.9rem; color:var(--stone); cursor:pointer; transition:all .18s;
}
.ms-size-pill:hover { border-color:var(--crimson); color:var(--crimson); }
.ms-size-pill.active { background:var(--crimson); border-color:var(--crimson); color:white; }
.ms-size-hint { font-size:0.65rem; color:var(--stone); }

.ms-start-btn {
  display:block; width:calc(100% - 36px); margin:0 18px 18px;
  padding:16px; background:linear-gradient(135deg, var(--crimson), var(--crimson-dk));
  color:white; border:none; border-radius:14px; cursor:pointer;
  font-family:'DM Serif Display',serif; font-size:1.1rem;
  box-shadow:0 6px 20px rgba(192,57,43,.35);
  transition:transform .18s, box-shadow .18s;
}
.ms-start-btn:hover { transform:translateY(-2px); box-shadow:0 10px 28px rgba(192,57,43,.45); }
.ms-start-btn:active { transform:scale(.98); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ONBOARDING OVERLAY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.onboard-overlay {
  display: none; position: fixed; inset: 0; z-index: 19999;
  background: rgba(15,15,26,0.97); align-items: center;
  justify-content: center; padding: 20px;
}
.onboard-overlay.show { display: flex; }
.onboard-box {
  background: var(--white); border-radius: 24px; max-width: 380px;
  width: 100%; overflow: hidden;
  box-shadow: 0 24px 80px rgba(0,0,0,.5);
  animation: fadeUp .4s ease both;
}
.onboard-slides { display: flex; transition: transform .4s cubic-bezier(.4,0,.2,1); }
.onboard-slide {
  min-width: 100%; padding: 36px 28px 28px;
  display: flex; flex-direction: column; align-items: center; text-align: center;
}
.onboard-emoji { font-size: 3.5rem; margin-bottom: 16px; }
.onboard-title {
  font-family: 'DM Serif Display', serif; font-size: 1.4rem;
  color: var(--ink); margin-bottom: 10px; line-height: 1.25;
}
.onboard-body {
  font-size: 0.83rem; color: var(--stone); line-height: 1.7;
  margin-bottom: 24px;
}
.onboard-body strong { color: var(--crimson); }
.onboard-dots {
  display: flex; gap: 6px; justify-content: center; margin-bottom: 22px;
}
.onboard-dot {
  width: 7px; height: 7px; border-radius: 50%;
  background: var(--border); transition: background .3s, transform .3s;
}
.onboard-dot.active { background: var(--crimson); transform: scale(1.3); }
.onboard-btns { display: flex; gap: 10px; width: 100%; }
.onboard-skip {
  flex: 1; padding: 13px; background: transparent;
  border: 1.5px solid var(--border); border-radius: 12px;
  font-family: 'DM Serif Display', serif; font-size: 0.9rem;
  color: var(--stone); cursor: pointer; transition: all .18s;
}
.onboard-skip:hover { border-color: var(--stone); }
.onboard-next {
  flex: 2; padding: 13px;
  background: linear-gradient(135deg, var(--crimson), var(--crimson-dk));
  border: none; border-radius: 12px;
  font-family: 'DM Serif Display', serif; font-size: 0.95rem;
  color: white; cursor: pointer;
  box-shadow: 0 4px 16px rgba(192,57,43,.35);
  transition: all .18s;
}
.onboard-next:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(192,57,43,.45); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   STATS DASHBOARD OVERLAY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.stats-overlay {
  display: none; position: fixed; inset: 0; z-index: 9998;
  background: rgba(15,15,26,.7); backdrop-filter: blur(4px);
  align-items: flex-start; justify-content: center;
  padding: 20px; overflow-y: auto;
}
.stats-overlay.show { display: flex; }
.stats-box {
  background: var(--paper); border-radius: 24px;
  max-width: 480px; width: 100%; margin: auto;
  overflow: hidden; box-shadow: 0 24px 80px rgba(0,0,0,.35);
  animation: fadeUp .35s ease both;
}
.stats-header {
  background: linear-gradient(135deg, var(--ink), #2c3e50);
  padding: 22px 22px 18px;
  display: flex; align-items: flex-start; justify-content: space-between;
}
.stats-header-title {
  font-family: 'DM Serif Display', serif; font-size: 1.3rem; color: white;
}
.stats-header-sub { font-size: 0.65rem; color: #94a3b8; margin-top: 3px; }
.stats-close-btn {
  background: rgba(255,255,255,.1); border: none; border-radius: 10px;
  padding: 8px 12px; color: white; cursor: pointer; font-size: 0.85rem;
  transition: background .18s; flex-shrink: 0;
}
.stats-close-btn:hover { background: rgba(255,255,255,.2); }
.stats-body { padding: 18px; }
.stats-kpi-grid {
  display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;
  margin-bottom: 18px;
}
.stats-kpi {
  background: var(--white); border: 1.5px solid var(--border);
  border-radius: 14px; padding: 14px 10px; text-align: center;
}
.stats-kpi-val {
  font-family: 'DM Serif Display', serif; font-size: 1.5rem;
  color: var(--crimson); line-height: 1;
}
.stats-kpi-lbl { font-size: 0.6rem; color: var(--stone); margin-top: 4px; font-weight: 700; letter-spacing: .5px; }

.stats-section-title {
  font-size: 0.6rem; font-weight: 700; letter-spacing: 2.5px;
  text-transform: uppercase; color: var(--stone);
  margin-bottom: 10px; margin-top: 16px;
  display: flex; align-items: center; gap: 8px;
}
.stats-section-title::after { content: ''; flex: 1; height: 1px; background: var(--border); }

/* Per-level accuracy bars */
.stats-level-row {
  display: flex; align-items: center; gap: 10px; margin-bottom: 10px;
}
.slr-badge {
  font-family: 'DM Serif Display', serif; font-size: 0.9rem;
  font-weight: 700; min-width: 26px;
}
.slr-bar-wrap { flex: 1; background: var(--border); border-radius: 99px; height: 7px; overflow: hidden; }
.slr-bar-fill { height: 100%; border-radius: 99px; transition: width 1s ease .3s; }
.slr-pct { font-size: 0.7rem; font-weight: 700; color: var(--stone); min-width: 36px; text-align: right; }
.slr-seen { font-size: 0.62rem; color: var(--stone); min-width: 50px; text-align: right; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PROGRESS HEATMAP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.heatmap-wrap {
  background: var(--white); border: 1.5px solid var(--border);
  border-radius: 14px; padding: 14px 14px 10px;
  margin-bottom: 16px; overflow-x: auto;
}
.heatmap-grid {
  display: grid;
  grid-template-columns: repeat(15, 1fr);
  gap: 3px;
  min-width: 200px;
}
.hm-cell {
  aspect-ratio: 1; border-radius: 3px;
  background: var(--border); cursor: default;
  transition: transform .15s;
  position: relative;
}
.hm-cell:hover { transform: scale(1.4); z-index: 2; }
.hm-cell[data-tip]:hover::after {
  content: attr(data-tip);
  position: absolute; bottom: 120%; left: 50%; transform: translateX(-50%);
  background: var(--ink); color: white; border-radius: 6px;
  padding: 3px 8px; font-size: 0.6rem; white-space: nowrap;
  pointer-events: none; z-index: 10;
}
.hm-cell.l1 { background: #c8e6c9; }
.hm-cell.l2 { background: #81c784; }
.hm-cell.l3 { background: #4caf50; }
.hm-cell.l4 { background: #2e7d32; }
body.dark .hm-cell.l1 { background: #1b4d1e; }
body.dark .hm-cell.l2 { background: #2a6e2d; }
body.dark .hm-cell.l3 { background: #388e3c; }
body.dark .hm-cell.l4 { background: #1b5e20; }

.hm-legend {
  display: flex; align-items: center; gap: 4px;
  margin-top: 8px; justify-content: flex-end; font-size: 0.6rem;
  color: var(--stone);
}
.hm-legend-cell {
  width: 10px; height: 10px; border-radius: 2px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ACHIEVEMENTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.ach-overlay {
  display: none; position: fixed; inset: 0; z-index: 9997;
  background: rgba(15,15,26,.7); backdrop-filter: blur(4px);
  align-items: flex-start; justify-content: center;
  padding: 20px; overflow-y: auto;
}
.ach-overlay.show { display: flex; }
.ach-box {
  background: var(--paper); border-radius: 24px;
  max-width: 480px; width: 100%; margin: auto;
  overflow: hidden; box-shadow: 0 24px 80px rgba(0,0,0,.35);
  animation: fadeUp .35s ease both;
}
.ach-header {
  background: linear-gradient(135deg, #1a1a2e, #2c3050);
  padding: 20px 22px;
  display: flex; align-items: center; justify-content: space-between;
}
.ach-header-title {
  font-family: 'DM Serif Display', serif; font-size: 1.2rem; color: white;
}
.ach-header-sub { font-size: 0.65rem; color: #94a3b8; margin-top: 3px; }
.ach-body { padding: 16px; max-height: 70vh; overflow-y: auto; }
.ach-grid {
  display: grid; grid-template-columns: 1fr 1fr; gap: 9px;
}
.ach-card {
  background: var(--white); border: 1.5px solid var(--border);
  border-radius: 14px; padding: 12px 10px; text-align: center;
  transition: all .2s; position: relative; overflow: hidden;
}
.ach-card.unlocked {
  border-color: var(--gold);
  background: linear-gradient(135deg, var(--gold-lt), var(--white));
}
.ach-card.locked { opacity: 0.5; filter: grayscale(0.6); }
.ach-icon { font-size: 1.8rem; margin-bottom: 5px; }
.ach-name {
  font-family: 'DM Serif Display', serif; font-size: 0.82rem;
  color: var(--ink); margin-bottom: 3px; line-height: 1.2;
}
.ach-desc { font-size: 0.6rem; color: var(--stone); line-height: 1.4; }
.ach-card.unlocked .ach-desc { color: var(--crimson); font-weight: 700; }
.ach-unlocked-badge {
  position: absolute; top: 6px; right: 6px;
  background: var(--gold); color: var(--ink);
  border-radius: 99px; font-size: 0.5rem; font-weight: 700;
  padding: 2px 6px; letter-spacing: .5px;
}

/* Achievement pop toast */
.ach-toast {
  position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%) translateY(20px);
  background: linear-gradient(135deg, #1a1a2e, #2c3050);
  border: 1.5px solid var(--gold); border-radius: 16px;
  padding: 14px 20px; display: flex; align-items: center; gap: 12px;
  z-index: 19998; opacity: 0; pointer-events: none;
  transition: all .35s cubic-bezier(.34,1.56,.64,1);
  max-width: 300px; box-shadow: 0 8px 32px rgba(0,0,0,.4);
}
.ach-toast.show {
  opacity: 1; transform: translateX(-50%) translateY(0);
}
.ach-toast-icon { font-size: 2rem; flex-shrink: 0; }
.ach-toast-title {
  font-size: 0.6rem; font-weight: 700; color: var(--gold);
  letter-spacing: 1.5px; text-transform: uppercase; margin-bottom: 3px;
}
.ach-toast-name {
  font-family: 'DM Serif Display', serif; font-size: 1rem; color: white;
}
.ach-toast-desc { font-size: 0.68rem; color: #94a3b8; }

/* â”€â”€ INTRO / GUIDE SECTION â”€â”€ */
.intro-section {
  margin-top: 10px; margin-bottom: 28px;
  animation: fadeUp .5s ease both .35s;
}
.intro-toggle-btn {
  width: 100%; padding: 13px 18px;
  background: var(--white); border: 1.5px solid var(--border);
  border-radius: 14px; cursor: pointer; text-align: left;
  display: flex; align-items: center; justify-content: space-between;
  transition: all .18s; font-family: 'Noto Sans JP', sans-serif;
}
.intro-toggle-btn:hover { border-color: var(--crimson); background: var(--crimson-lt); }
.intro-toggle-left { display: flex; align-items: center; gap: 10px; }
.intro-toggle-icon { font-size: 1.3rem; }
.intro-toggle-title { font-family: 'DM Serif Display', serif; font-size: 0.95rem; color: var(--ink); }
.intro-toggle-sub { font-size: 0.62rem; color: var(--stone); margin-top: 1px; }
.intro-chevron { font-size: 0.85rem; color: var(--stone); transition: transform .3s; }
.intro-chevron.open { transform: rotate(180deg); }

.intro-body {
  overflow: hidden; max-height: 0;
  transition: max-height .45s cubic-bezier(.4,0,.2,1);
}
.intro-body.open { max-height: 2000px; }
.intro-inner {
  background: var(--white); border: 1.5px solid var(--border);
  border-top: none; border-radius: 0 0 14px 14px;
  padding: 20px 18px 22px;
}

.intro-block { margin-bottom: 20px; }
.intro-block:last-child { margin-bottom: 0; }
.intro-block-title {
  font-family: 'DM Serif Display', serif; font-size: 0.95rem;
  color: var(--crimson); margin-bottom: 8px;
  display: flex; align-items: center; gap: 7px;
}
.intro-block-body {
  font-size: 0.8rem; color: var(--ink); line-height: 1.75;
}
.intro-block-body strong { color: var(--crimson); }
.intro-script-row {
  display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-top: 10px;
}
.intro-script-chip {
  background: #f8f6f2; border: 1.5px solid var(--border);
  border-radius: 12px; padding: 10px 8px; text-align: center;
}
.isc-title { font-family: 'Noto Serif JP', serif; font-size: 1.1rem; color: var(--crimson); font-weight: 700; }
.isc-name { font-size: 0.65rem; font-weight: 700; color: var(--ink); margin-top: 3px; }
.isc-desc { font-size: 0.6rem; color: var(--stone); margin-top: 2px; }

.intro-levels-grid {
  display: flex; flex-direction: column; gap: 7px; margin-top: 10px;
}
.intro-level-row {
  display: flex; align-items: center; gap: 10px;
  padding: 9px 12px; border-radius: 10px; background: #f8f6f2;
  border: 1px solid var(--border);
}
.ilr-badge {
  font-family: 'DM Serif Display', serif; font-size: 1rem;
  font-weight: 700; min-width: 28px;
}
.ilr-info { flex: 1; }
.ilr-name { font-size: 0.75rem; font-weight: 700; color: var(--ink); }
.ilr-desc { font-size: 0.62rem; color: var(--stone); margin-top: 1px; }
.ilr-vocab { font-size: 0.6rem; font-weight: 700; padding: 2px 8px; border-radius: 99px; }

.intro-divider {
  height: 1px; background: var(--border); margin: 16px 0;
}

/* â”€â”€ DAILY CHALLENGE â”€â”€ */
.daily-challenge-card {
  background: linear-gradient(135deg, #0d0d1a, #1a1a30);
  border: 2px solid var(--gold);
  border-radius: var(--radius); padding: 16px 18px;
  margin-bottom: 16px; cursor: pointer;
  position: relative; overflow: hidden;
  animation: fadeUp .4s ease both .1s;
  box-shadow: 0 4px 24px rgba(212,172,13,0.2);
  transition: transform .2s, box-shadow .2s;
}
.daily-challenge-card:hover { transform: translateY(-3px); box-shadow: 0 8px 32px rgba(212,172,13,0.35); }
.daily-challenge-card::before {
  content: 'ðŸ†'; position: absolute; right: -8px; top: -10px;
  font-size: 5rem; opacity: 0.08; pointer-events: none;
}
.dc-label {
  font-size: 0.58rem; font-weight: 700; letter-spacing: 3px;
  text-transform: uppercase; color: var(--gold); margin-bottom: 8px;
  display: flex; align-items: center; gap: 8px;
}
.dc-gold-badge {
  background: var(--gold); color: var(--ink);
  border-radius: 99px; padding: 2px 8px; font-size: 0.6rem;
}
.dc-title { font-family: 'DM Serif Display', serif; font-size: 1.1rem; color: white; margin-bottom: 4px; }
.dc-sub { font-size: 0.72rem; color: #94a3b8; margin-bottom: 12px; }
.dc-progress-row { display: flex; align-items: center; gap: 10px; }
.dc-progress-track { flex: 1; height: 6px; background: rgba(255,255,255,0.1); border-radius: 99px; overflow: hidden; }
.dc-progress-fill { height: 100%; background: linear-gradient(90deg, var(--gold), #f0c040); border-radius: 99px; transition: width .5s ease; }
.dc-progress-label { font-size: 0.68rem; color: var(--gold); font-weight: 700; white-space: nowrap; }
.dc-completed-badge {
  display: inline-flex; align-items: center; gap: 6px;
  background: rgba(212,172,13,0.15); border: 1px solid var(--gold);
  border-radius: 99px; padding: 4px 12px; font-size: 0.72rem;
  color: var(--gold); font-weight: 700; margin-top: 8px;
}

/* â”€â”€ DAILY CHALLENGE GAME HEADER â”€â”€ */
.dc-game-header {
  background: linear-gradient(135deg, #0d0d1a, #1a1a30);
  border: 2px solid var(--gold); border-radius: 14px;
  padding: 12px 16px; margin-bottom: 14px; text-align: center;
}
.dc-game-title { font-family: 'DM Serif Display', serif; font-size: 1rem; color: var(--gold); }
.dc-game-sub { font-size: 0.68rem; color: #94a3b8; margin-top: 3px; }

/* â”€â”€ LEVEL COMPLETION CERTIFICATE â”€â”€ */
.cert-overlay {
  display: none; position: fixed; inset: 0; z-index: 20000;
  background: rgba(10,10,20,0.92); backdrop-filter: blur(6px);
  align-items: center; justify-content: center; padding: 20px;
}
.cert-overlay.show { display: flex; }
.cert-box {
  max-width: 480px; width: 100%; background: linear-gradient(145deg, #fdf9f0, #fff8e8);
  border-radius: 24px; overflow: hidden;
  box-shadow: 0 0 0 4px var(--gold), 0 24px 80px rgba(0,0,0,.5);
  animation: certPop .5s cubic-bezier(.34,1.56,.64,1) both;
}
@keyframes certPop { from { transform: scale(.7); opacity: 0; } to { transform: scale(1); opacity: 1; } }
.cert-header {
  background: linear-gradient(135deg, var(--ink), #2c3e50);
  padding: 28px 24px 20px; text-align: center; position: relative;
}
.cert-header::before {
  content: ''; position: absolute; inset: 0;
  background: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(212,172,13,0.04) 10px, rgba(212,172,13,0.04) 20px);
}
.cert-stamp { font-size: 3.5rem; margin-bottom: 10px; display: block; }
.cert-title { font-family: 'DM Serif Display', serif; font-size: 1.6rem; color: white; line-height: 1.2; }
.cert-sub { font-size: 0.8rem; color: var(--gold); margin-top: 6px; letter-spacing: 1px; }
.cert-body { padding: 24px; text-align: center; }
.cert-level-badge {
  display: inline-block; font-family: 'DM Serif Display', serif;
  font-size: 2.5rem; color: white; background: var(--crimson);
  border-radius: 16px; padding: 10px 24px; margin-bottom: 16px;
  box-shadow: 0 6px 20px rgba(192,57,43,.4);
}
.cert-words-count { font-family: 'DM Serif Display', serif; font-size: 1.8rem; color: var(--ink); }
.cert-words-label { font-size: 0.8rem; color: var(--stone); margin-bottom: 16px; }
.cert-date { font-size: 0.72rem; color: var(--stone); margin-bottom: 20px; font-style: italic; }
.cert-border-top, .cert-border-bottom {
  height: 6px;
  background: repeating-linear-gradient(90deg, var(--gold) 0px, var(--gold) 16px, var(--crimson) 16px, var(--crimson) 32px);
}
.cert-actions { display: flex; gap: 10px; padding: 0 24px 24px; flex-wrap: wrap; }
.cert-btn {
  flex: 1; padding: 12px; border: none; border-radius: 12px;
  font-family: 'DM Serif Display', serif; font-size: 0.95rem;
  cursor: pointer; transition: all .18s;
}
.cert-btn-share { background: var(--crimson); color: white; }
.cert-btn-share:hover { background: var(--crimson-dk); transform: translateY(-2px); }
.cert-btn-close { background: #f1f5f9; color: var(--ink); }
.cert-btn-close:hover { background: var(--border); }

/* â”€â”€ SENSEI CHARACTER SYSTEM â”€â”€ */
.sensei-char-wrap {
  display: flex; align-items: flex-start; gap: 12px;
  padding: 14px 16px; border-radius: 14px; margin-top: 6px;
  animation: fadeUp .3s ease;
}
.sensei-char-wrap.correct-style { background: rgba(39,174,96,0.08); border: 1px solid rgba(39,174,96,0.2); }
.sensei-char-wrap.wrong-style { background: rgba(192,57,43,0.06); border: 1px solid rgba(192,57,43,0.15); }
.sensei-char-wrap.streak-style { background: rgba(212,172,13,0.08); border: 1px solid rgba(212,172,13,0.25); }
.sensei-avatar { font-size: 2.8rem; line-height: 1; flex-shrink: 0; }
.sensei-bubble { flex: 1; }
.sensei-char-name { font-size: 0.6rem; font-weight: 700; color: var(--stone); letter-spacing: 1px; margin-bottom: 3px; text-transform: uppercase; }
.sensei-char-text { font-size: 0.82rem; color: var(--ink); line-height: 1.6; }
.sensei-char-src { font-size: 0.65rem; color: var(--stone); margin-top: 4px; }

/* â”€â”€ ROMAJI TOGGLE â”€â”€ */
.romaji-toggle-btn {
  position: fixed; top: 52px; right: 16px; z-index: 500;
  background: var(--white); border: 1.5px solid var(--border);
  border-radius: 99px; padding: 5px 11px; font-size: 0.72rem;
  font-weight: 700; color: var(--ink); cursor: pointer;
  transition: all .2s; display: flex; align-items: center; gap: 4px;
  box-shadow: 0 2px 12px rgba(0,0,0,0.08);
}
.romaji-toggle-btn:hover { border-color: var(--crimson); }
.romaji-toggle-btn.hidden-romaji { border-color: var(--gold); color: var(--gold); }
body.hide-romaji .romaji-display { opacity: 0; pointer-events: none; height: 0; overflow: hidden; margin: 0; }
body.hide-romaji .furigana-display { opacity: 0; pointer-events: none; height: 0; overflow: hidden; margin: 0; }

/* â”€â”€ KEYBOARD SHORTCUT HINTS â”€â”€ */
.kb-hints {
  display: flex; gap: 8px; justify-content: center;
  flex-wrap: wrap; margin: 8px 0 0;
  opacity: 0.5; font-size: 0.62rem; color: var(--stone);
}
.kb-hint { display: flex; align-items: center; gap: 3px; }
.kb-key {
  display: inline-flex; align-items: center; justify-content: center;
  background: var(--white); border: 1px solid var(--border);
  border-radius: 4px; min-width: 18px; height: 18px;
  padding: 0 4px; font-family: monospace; font-size: 0.65rem;
  box-shadow: 0 1px 2px rgba(0,0,0,0.1);
}
@media (hover: none) { .kb-hints { display: none; } } /* hide on touch devices */

/* â”€â”€ PER-WORD ACCURACY OVERLAY â”€â”€ */
.word-acc-overlay {
  display: none; position: fixed; inset: 0; z-index: 9999;
  background: rgba(26,26,46,.65); backdrop-filter: blur(4px);
  align-items: flex-start; justify-content: center; padding: 20px; overflow-y: auto;
}
.word-acc-overlay.show { display: flex; }
.word-acc-box {
  background: var(--paper); border-radius: 20px; max-width: 520px; width: 100%;
  margin: auto; overflow: hidden; box-shadow: 0 24px 80px rgba(0,0,0,.3);
}
.word-acc-header {
  background: linear-gradient(135deg, var(--ink), #2c3e50);
  padding: 18px 22px; display: flex; align-items: center; justify-content: space-between;
}
.word-acc-title { font-family: 'DM Serif Display', serif; font-size: 1.1rem; color: white; }
.word-acc-body { padding: 16px; max-height: 70vh; overflow-y: auto; }
.word-acc-filter { display: flex; gap: 8px; margin-bottom: 14px; }
.waf-pill {
  flex: 1; padding: 7px; border-radius: 10px; border: 1.5px solid var(--border);
  background: transparent; font-size: 0.72rem; font-weight: 700;
  color: var(--stone); cursor: pointer; transition: all .18s;
}
.waf-pill.sel { background: var(--crimson); color: white; border-color: var(--crimson); }
.word-acc-item {
  display: flex; align-items: center; gap: 12px;
  padding: 10px 12px; border-radius: 10px; margin-bottom: 8px;
  background: var(--white); border: 1px solid var(--border);
}
.wai-kanji { font-family: 'Noto Serif JP', serif; font-size: 1.2rem; color: var(--ink); min-width: 40px; }
.wai-info { flex: 1; min-width: 0; }
.wai-reading { font-size: 0.68rem; color: var(--stone); }
.wai-meaning { font-size: 0.78rem; color: var(--ink); font-weight: 600; }
.wai-bar-wrap { width: 80px; }
.wai-bar-track { height: 6px; background: var(--border); border-radius: 99px; overflow: hidden; margin-bottom: 2px; }
.wai-bar-fill { height: 100%; border-radius: 99px; }
.wai-pct { font-size: 0.65rem; font-weight: 700; text-align: right; }

/* â”€â”€ WEEKLY REPORT OVERLAY â”€â”€ */
.weekly-overlay {
  display: none; position: fixed; inset: 0; z-index: 9999;
  background: rgba(26,26,46,.65); backdrop-filter: blur(4px);
  align-items: flex-start; justify-content: center; padding: 20px; overflow-y: auto;
}
.weekly-overlay.show { display: flex; }
.weekly-box {
  background: var(--paper); border-radius: 20px; max-width: 480px; width: 100%;
  margin: auto; overflow: hidden; box-shadow: 0 24px 80px rgba(0,0,0,.3);
}
.weekly-header {
  background: linear-gradient(135deg, #1a1a2e, #2c3e50);
  padding: 20px 22px; position: relative; overflow: hidden;
}
.weekly-header::before { content: 'é€±'; position: absolute; right: -10px; top: -20px; font-family: 'Noto Serif JP', serif; font-size: 7rem; color: rgba(255,255,255,0.04); pointer-events: none; line-height: 1; }
.weekly-header-title { font-family: 'DM Serif Display', serif; font-size: 1.3rem; color: white; margin-bottom: 3px; }
.weekly-header-sub { font-size: 0.7rem; color: #94a3b8; }
.weekly-body { padding: 20px; }
.weekly-kpi-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 18px; }
.weekly-kpi {
  background: var(--white); border-radius: 12px; padding: 14px 12px; text-align: center;
  border: 1px solid var(--border);
}
.weekly-kpi-val { font-family: 'DM Serif Display', serif; font-size: 1.8rem; color: var(--crimson); line-height: 1; }
.weekly-kpi-lbl { font-size: 0.65rem; color: var(--stone); margin-top: 4px; }
.weekly-days-row { display: flex; gap: 6px; margin-bottom: 16px; }
.weekly-day {
  flex: 1; border-radius: 8px; padding: 8px 4px; text-align: center;
  border: 1px solid var(--border); background: var(--white);
}
.wd-name { font-size: 0.58rem; color: var(--stone); margin-bottom: 4px; text-transform: uppercase; }
.wd-dot { width: 16px; height: 16px; border-radius: 50%; margin: 0 auto 4px; background: var(--border); }
.wd-dot.studied { background: var(--crimson); }
.wd-xp { font-size: 0.58rem; color: var(--stone); }
.weekly-export-row { display: flex; gap: 8px; margin-top: 14px; }
.weekly-export-btn {
  flex: 1; padding: 11px; border: 1.5px solid var(--border); border-radius: 12px;
  background: var(--white); font-size: 0.78rem; font-weight: 700;
  color: var(--ink); cursor: pointer; transition: all .18s;
}
.weekly-export-btn:hover { border-color: var(--crimson); color: var(--crimson); }

/* â”€â”€ CERT CANVAS (for share image) â”€â”€ */
#certCanvas { display: none; }

</style>
</head>
<body>

<!-- â”€â”€ DARK MODE TOGGLE â”€â”€ -->
<button class="dm-toggle" id="dmToggle" onclick="toggleDarkMode()" title="Toggle dark mode">ðŸŒ™ Dark</button>
<!-- â”€â”€ ROMAJI TOGGLE â”€â”€ -->
<button class="romaji-toggle-btn" id="romajiToggle" onclick="toggleRomaji()" title="Toggle romaji visibility">RÅmaji âœ“</button>
<!-- â”€â”€ HIDDEN CERT CANVAS â”€â”€ -->
<canvas id="certCanvas" width="800" height="560"></canvas>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ONBOARDING OVERLAY (first-time users)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="onboard-overlay" id="onboardOverlay">
  <div class="onboard-box">
    <div class="onboard-slides" id="onboardSlides">

      <!-- Slide 1 -->
      <div class="onboard-slide">
        <div class="onboard-emoji">ðŸ‡¯ðŸ‡µ</div>
        <div class="onboard-title">Welcome to JLPT Vocab Master</div>
        <div class="onboard-body">
          Learn Japanese vocabulary <strong>the anime way</strong> â€” with kanji origin stories, memory hooks, and wisdom from your favourite characters.<br><br>
          This app covers all 5 JLPT levels, <strong>completely free</strong>, forever.
        </div>
        <div class="onboard-dots">
          <div class="onboard-dot active" id="ob-dot-0"></div>
          <div class="onboard-dot" id="ob-dot-1"></div>
          <div class="onboard-dot" id="ob-dot-2"></div>
        </div>
        <div class="onboard-btns">
          <button class="onboard-skip" onclick="closeOnboarding()">Skip</button>
          <button class="onboard-next" onclick="onboardNext()">Next â†’</button>
        </div>
      </div>

      <!-- Slide 2 -->
      <div class="onboard-slide">
        <div class="onboard-emoji">ðŸ§ </div>
        <div class="onboard-title">Five Levels, Five Modes</div>
        <div class="onboard-body">
          Pick a level â€” <strong>N5</strong> (beginner) to <strong>N1</strong> (near native). Then choose how you study:<br><br>
          ðŸŽ¯ <strong>Meaning</strong> Â· ðŸ“– <strong>Reading</strong> Â· âœï¸ <strong>Type It</strong> Â· ðŸƒ <strong>Flashcard</strong> Â· ðŸ“œ <strong>Past Paper</strong><br><br>
          Your XP, streaks, and progress are saved automatically.
        </div>
        <div class="onboard-dots">
          <div class="onboard-dot" id="ob-dot-0b"></div>
          <div class="onboard-dot active" id="ob-dot-1b"></div>
          <div class="onboard-dot" id="ob-dot-2b"></div>
        </div>
        <div class="onboard-btns">
          <button class="onboard-skip" onclick="closeOnboarding()">Skip</button>
          <button class="onboard-next" onclick="onboardNext()">Next â†’</button>
        </div>
      </div>

      <!-- Slide 3 -->
      <div class="onboard-slide">
        <div class="onboard-emoji">ðŸ”¥</div>
        <div class="onboard-title">Build Your Streak</div>
        <div class="onboard-body">
          Study every day to grow your <strong>ðŸ”¥ streak</strong>. Earn XP to rank up from Genin to Kage. Unlock <strong>achievements</strong> along the way.<br><br>
          A new <strong>Word of the Day</strong> drops every morning â€” tap it to practise!
        </div>
        <div class="onboard-dots">
          <div class="onboard-dot" id="ob-dot-0c"></div>
          <div class="onboard-dot" id="ob-dot-1c"></div>
          <div class="onboard-dot active" id="ob-dot-2c"></div>
        </div>
        <div class="onboard-btns">
          <button class="onboard-skip" onclick="closeOnboarding()">Maybe Later</button>
          <button class="onboard-next" onclick="closeOnboarding()">å§‹ã‚ã¾ã—ã‚‡ã†ï¼ðŸŽŒ</button>
        </div>
      </div>

    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     STATS DASHBOARD OVERLAY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="stats-overlay" id="statsOverlay" onclick="if(event.target===this)closeStats()">
  <div class="stats-box">
    <div class="stats-header">
      <div>
        <div class="stats-header-title">ðŸ“Š Your Stats</div>
        <div class="stats-header-sub">Detailed progress & accuracy breakdown</div>
      </div>
      <button class="stats-close-btn" onclick="closeStats()">âœ• Close</button>
    </div>
    <div class="stats-body">

      <!-- KPI row -->
      <div class="stats-kpi-grid">
        <div class="stats-kpi">
          <div class="stats-kpi-val" id="stKpiXp">0</div>
          <div class="stats-kpi-lbl">Total XP</div>
        </div>
        <div class="stats-kpi">
          <div class="stats-kpi-val" id="stKpiStreak">0</div>
          <div class="stats-kpi-lbl">Day Streak ðŸ”¥</div>
        </div>
        <div class="stats-kpi">
          <div class="stats-kpi-val" id="stKpiSessions">0</div>
          <div class="stats-kpi-lbl">Sessions</div>
        </div>
        <div class="stats-kpi">
          <div class="stats-kpi-val" id="stKpiWords">0</div>
          <div class="stats-kpi-lbl">Words Seen</div>
        </div>
        <div class="stats-kpi">
          <div class="stats-kpi-val" id="stKpiAcc">â€”</div>
          <div class="stats-kpi-lbl">Accuracy</div>
        </div>
        <div class="stats-kpi">
          <div class="stats-kpi-val" id="stKpiMistakes">0</div>
          <div class="stats-kpi-lbl">In Mistake Bank</div>
        </div>
      </div>

      <!-- Progress heatmap -->
      <div class="stats-section-title">Study Calendar (last 105 days)</div>
      <div class="heatmap-wrap">
        <div class="heatmap-grid" id="heatmapGrid"></div>
        <div class="hm-legend">
          Less
          <div class="hm-legend-cell" style="background:var(--border)"></div>
          <div class="hm-legend-cell hm-cell l1"></div>
          <div class="hm-legend-cell hm-cell l2"></div>
          <div class="hm-legend-cell hm-cell l3"></div>
          <div class="hm-legend-cell hm-cell l4"></div>
          More
        </div>
      </div>

      <!-- Per-level accuracy -->
      <div class="stats-section-title">Progress by Level</div>
      <div id="statsLevelBars"></div>

      <!-- Accuracy history note -->
      <div style="font-size:0.68rem;color:var(--stone);margin-top:10px;line-height:1.6;padding:10px 12px;background:var(--white);border-radius:10px;border:1px solid var(--border)">
        ðŸ’¡ Accuracy is calculated from your Mistake Bank â€” the fewer mistakes saved, the higher your accuracy shown here.
      </div>

    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ACHIEVEMENTS OVERLAY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="ach-overlay" id="achOverlay" onclick="if(event.target===this)closeAchievements()">
  <div class="ach-box">
    <div class="ach-header">
      <div>
        <div class="ach-header-title">ðŸ† Achievements</div>
        <div class="ach-header-sub" id="achHeaderSub">0 / 15 unlocked</div>
      </div>
      <button class="stats-close-btn" onclick="closeAchievements()">âœ• Close</button>
    </div>
    <div class="ach-body">
      <div class="ach-grid" id="achGrid"></div>
    </div>
  </div>
</div>

<!-- Achievement toast -->
<div class="ach-toast" id="achToast">
  <div class="ach-toast-icon" id="achToastIcon">ðŸ†</div>
  <div>
    <div class="ach-toast-title">Achievement Unlocked!</div>
    <div class="ach-toast-name" id="achToastName"></div>
    <div class="ach-toast-desc" id="achToastDesc"></div>
  </div>
</div>
<!-- â”€â”€ FLOATING SHARE BUTTON â”€â”€ -->
<div class="share-fab-wrap" id="shareFabWrap">
  <button class="share-fab" id="shareFab" onclick="toggleShareFan()" title="Share this app" aria-label="Share">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round" width="18" height="18"><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/></svg>
  </button>
  <div class="share-fan" id="shareFan">
    <button class="sfan-btn sfan-li" data-tip="LinkedIn" onclick="shareTo('linkedin')">
      <svg viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 0 1-2.063-2.065 2.064 2.064 0 1 1 2.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
    </button>
    <button class="sfan-btn sfan-rd" data-tip="Reddit" onclick="shareTo('reddit')">
      <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/></svg>
    </button>
    <button class="sfan-btn sfan-fb" data-tip="Facebook" onclick="shareTo('facebook')">
      <svg viewBox="0 0 24 24" fill="currentColor"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
    </button>
    <button class="sfan-btn sfan-wa" data-tip="WhatsApp" onclick="shareTo('whatsapp')">
      <svg viewBox="0 0 24 24" fill="currentColor"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>
    </button>
    <button class="sfan-btn sfan-tw" data-tip="X / Twitter" onclick="shareTo('twitter')">
      <svg viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-4.714-6.231-5.401 6.231H2.74l7.73-8.835L1.254 2.25H8.08l4.259 5.63 5.905-5.63zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
    </button>
  </div>
</div>

<a id="supportBtn" href="https://4655550918506.gumroad.com/coffee" target="_blank" class="support-float">
  â­ Say arigatou â€” â‚¹99
</a>

<div class="stripe"></div>
<canvas id="kanjiCanvas"></canvas>

<div class="wrapper">

<!-- â”€â”€ HOME â”€â”€ -->
<div class="screen active" id="homeScreen">

  <!-- Header -->
  <div class="home-hdr">
    <div class="home-hdr-jp">æ—¥æœ¬èªž å˜èªž</div>
    <div class="home-hdr-en">JLPT Vocabulary Master Â· Always Free</div>
  </div>

  <!-- Stats pill (shown if returning) -->
  <div class="home-pill" id="homePill" style="display:none">
    <span id="hpXp">â­ 0 XP</span>
    <span class="home-pill-sep">Â·</span>
    <span id="hpStreak">ðŸ”¥ 0 days</span>
    <span class="home-pill-sep">Â·</span>
    <span id="hpRank">ðŸ¥‹ Genin</span>
  </div>

  <!-- Anime quote card -->
  <div class="quote-card" style="margin-bottom:20px">
    <div class="quote-tag">ä»Šæ—¥ã®åè¨€ Â· ANIME WISDOM</div>
    <div class="quote-jp" id="homeQuoteJP"></div>
    <div class="quote-en" id="homeQuoteEN"></div>
    <div class="quote-source" id="homeQuoteSRC"></div>
  </div>

  <!-- Daily Challenge Card -->
  <div class="daily-challenge-card" id="dailyChallengeCard" onclick="startDailyChallenge()">
    <div class="dc-label">
      ðŸ† DAILY CHALLENGE
      <span class="dc-gold-badge" id="dcResetLabel">Resets at midnight</span>
    </div>
    <div class="dc-title" id="dcTitle">Today's 10-Question Challenge</div>
    <div class="dc-sub" id="dcSub">Same questions for everyone today Â· Earn 2Ã— Bonus XP</div>
    <div class="dc-progress-row" id="dcProgressRow">
      <div class="dc-progress-track"><div class="dc-progress-fill" id="dcProgressFill" style="width:0%"></div></div>
      <div class="dc-progress-label" id="dcProgressLabel">0 / 10</div>
    </div>
  </div>

  <!-- Daily Word of the Day -->
  <div class="daily-word-card" onclick="startDailyWordPractice()" style="cursor:pointer">
    <div class="dw-label">
      ðŸ“… WORD OF THE DAY
      <span class="dw-streak-badge" id="dwStreakBadge">ðŸ”¥ 1 day</span>
    </div>
    <div class="dw-main">
      <div class="dw-kanji" id="dwKanji">å­¦</div>
      <div class="dw-info">
        <div class="dw-reading" id="dwReading">ã¾ãªã¶ (manabu)</div>
        <div class="dw-meaning" id="dwMeaning">to learn</div>
        <div class="dw-level" id="dwLevel" style="font-size:0.65rem;font-weight:700;margin-top:4px;color:var(--n5)">N5</div>
      </div>
      <span class="dw-seen-badge" id="dwSeenBadge">âœ“ Seen today</span>
    </div>
    <div class="dw-hook" id="dwHook" style="font-size:0.78rem;color:#94a3b8;line-height:1.6;margin-bottom:10px;padding:10px 12px;background:rgba(255,255,255,0.05);border-radius:10px;border-left:3px solid var(--gold)">
      âœ¨ Loading hook...
    </div>
    <div class="dw-footer">
      <div class="dw-cta">Tap to practise this word â†’</div>
    </div>
  </div>

  <!-- Level picker label -->
  <div class="lp-label">é¸æŠžã—ã¦ãã ã•ã„ â€” Choose your level</div>

  <!-- Level tiles â€” click goes straight to mode screen -->
  <div class="lp-grid">

    <div class="lp-tile" style="--tc:var(--n5)" onclick="pickLevel('N5')">
      <div class="lp-glow"></div>
      <div class="lp-lvname" style="color:var(--n5)">N5</div>
      <div class="lp-kana">ã«ã»ã‚“ã”</div>
      <div class="lp-rank">ðŸ¥‹ GENIN</div>
      <div class="lp-desc">Complete Beginner</div>
      <div class="lp-ring">
        <svg viewBox="0 0 50 50" width="50" height="50">
          <circle cx="25" cy="25" r="21" fill="none" stroke="rgba(0,0,0,0.06)" stroke-width="3"/>
          <circle id="lpr-N5" cx="25" cy="25" r="21" fill="none" stroke="var(--n5)" stroke-width="3"
            stroke-dasharray="131.9" stroke-dashoffset="131.9" stroke-linecap="round"
            transform="rotate(-90 25 25)" style="transition:stroke-dashoffset 1s ease .25s"/>
        </svg>
        <div class="lp-ring-txt"><span id="lpn-N5">0</span><small id="lpt-N5">/0</small></div>
      </div>
    </div>

    <div class="lp-tile" style="--tc:var(--n4)" onclick="pickLevel('N4')">
      <div class="lp-glow"></div>
      <div class="lp-lvname" style="color:var(--n4)">N4</div>
      <div class="lp-kana">ã—ã‚‡ãã‚…ã†</div>
      <div class="lp-rank">âš”ï¸ CHUNIN</div>
      <div class="lp-desc">Elementary</div>
      <div class="lp-ring">
        <svg viewBox="0 0 50 50" width="50" height="50">
          <circle cx="25" cy="25" r="21" fill="none" stroke="rgba(0,0,0,0.06)" stroke-width="3"/>
          <circle id="lpr-N4" cx="25" cy="25" r="21" fill="none" stroke="var(--n4)" stroke-width="3"
            stroke-dasharray="131.9" stroke-dashoffset="131.9" stroke-linecap="round"
            transform="rotate(-90 25 25)" style="transition:stroke-dashoffset 1s ease .35s"/>
        </svg>
        <div class="lp-ring-txt"><span id="lpn-N4">0</span><small id="lpt-N4">/0</small></div>
      </div>
    </div>

    <div class="lp-tile" style="--tc:var(--n3)" onclick="pickLevel('N3')">
      <div class="lp-glow"></div>
      <div class="lp-lvname" style="color:var(--n3)">N3</div>
      <div class="lp-kana">ã¡ã‚…ã†ãã‚…ã†</div>
      <div class="lp-rank">ðŸ—¡ï¸ JONIN</div>
      <div class="lp-desc">Intermediate</div>
      <div class="lp-ring">
        <svg viewBox="0 0 50 50" width="50" height="50">
          <circle cx="25" cy="25" r="21" fill="none" stroke="rgba(0,0,0,0.06)" stroke-width="3"/>
          <circle id="lpr-N3" cx="25" cy="25" r="21" fill="none" stroke="var(--n3)" stroke-width="3"
            stroke-dasharray="131.9" stroke-dashoffset="131.9" stroke-linecap="round"
            transform="rotate(-90 25 25)" style="transition:stroke-dashoffset 1s ease .45s"/>
        </svg>
        <div class="lp-ring-txt"><span id="lpn-N3">0</span><small id="lpt-N3">/0</small></div>
      </div>
    </div>

    <div class="lp-tile" style="--tc:var(--n2)" onclick="pickLevel('N2')">
      <div class="lp-glow"></div>
      <div class="lp-lvname" style="color:var(--n2)">N2</div>
      <div class="lp-kana">ã˜ã‚‡ã†ãã‚…ã†</div>
      <div class="lp-rank">ðŸ‘ï¸ ANBU</div>
      <div class="lp-desc">Upper Intermediate</div>
      <div class="lp-ring">
        <svg viewBox="0 0 50 50" width="50" height="50">
          <circle cx="25" cy="25" r="21" fill="none" stroke="rgba(0,0,0,0.06)" stroke-width="3"/>
          <circle id="lpr-N2" cx="25" cy="25" r="21" fill="none" stroke="var(--n2)" stroke-width="3"
            stroke-dasharray="131.9" stroke-dashoffset="131.9" stroke-linecap="round"
            transform="rotate(-90 25 25)" style="transition:stroke-dashoffset 1s ease .55s"/>
        </svg>
        <div class="lp-ring-txt"><span id="lpn-N2">0</span><small id="lpt-N2">/0</small></div>
      </div>
    </div>

    <div class="lp-tile lp-n1" style="--tc:var(--n1)" onclick="pickLevel('N1')">
      <div class="lp-glow"></div>
      <div>
        <div class="lp-lvname" style="color:var(--n1)">N1</div>
        <div class="lp-kana">ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ¬ãƒ™ãƒ«</div>
        <div class="lp-rank">ðŸŒŸ KAGE</div>
        <div class="lp-desc">Advanced Â· Native Level</div>
      </div>
      <div class="lp-ring">
        <svg viewBox="0 0 50 50" width="50" height="50">
          <circle cx="25" cy="25" r="21" fill="none" stroke="rgba(0,0,0,0.06)" stroke-width="3"/>
          <circle id="lpr-N1" cx="25" cy="25" r="21" fill="none" stroke="var(--n1)" stroke-width="3"
            stroke-dasharray="131.9" stroke-dashoffset="131.9" stroke-linecap="round"
            transform="rotate(-90 25 25)" style="transition:stroke-dashoffset 1s ease .65s"/>
        </svg>
        <div class="lp-ring-txt"><span id="lpn-N1">0</span><small id="lpt-N1">/0</small></div>
      </div>
    </div>

  </div><!-- /lp-grid -->

  <!-- Utility buttons -->
  <div class="lp-utils" style="flex-wrap:wrap">
    <button class="lp-util-btn" onclick="openMistakeBank()">âŒ Mistakes</button>
    <button class="lp-util-btn" onclick="openStats()">ðŸ“Š Stats</button>
    <button class="lp-util-btn" onclick="openAchievements()">ðŸ† Badges</button>
    <button class="lp-util-btn" onclick="openWordAcc()">ðŸ”¬ Words</button>
    <button class="lp-util-btn" onclick="openWeekly()">ðŸ“… Weekly</button>
    <button class="lp-util-btn" onclick="continueIfSaved()">â–¶ Resume</button>
  </div>

  <!-- â”€â”€ INTRODUCTION / GUIDE â”€â”€ -->
  <div class="intro-section">
    <button class="intro-toggle-btn" onclick="toggleIntro()" id="introToggleBtn" aria-expanded="false">
      <div class="intro-toggle-left">
        <span class="intro-toggle-icon">ðŸ“–</span>
        <div>
          <div class="intro-toggle-title">What is JLPT? A Beginner's Guide</div>
          <div class="intro-toggle-sub">Kanji Â· Kana Â· Levels explained â€” tap to expand</div>
        </div>
      </div>
      <span class="intro-chevron" id="introChevron">â–¼</span>
    </button>
    <div class="intro-body" id="introBody">
      <div class="intro-inner">

        <!-- JLPT -->
        <div class="intro-block">
          <div class="intro-block-title">ðŸŽŒ What is the JLPT?</div>
          <div class="intro-block-body">
            The <strong>Japanese Language Proficiency Test (JLPT)</strong> â€” æ—¥æœ¬èªžèƒ½åŠ›è©¦é¨“ â€” is the world's most recognised Japanese certification, taken by over 1 million people each year in 90+ countries. It has <strong>five levels: N5 (easiest) â†’ N1 (hardest)</strong>. Passing opens doors to Japanese universities, workplaces, and visa applications.
          </div>
        </div>

        <div class="intro-divider"></div>

        <!-- Writing Systems -->
        <div class="intro-block">
          <div class="intro-block-title">âœï¸ Japan's Three Writing Scripts</div>
          <div class="intro-block-body">Japanese uses three scripts together in the same sentence:</div>
          <div class="intro-script-row">
            <div class="intro-script-chip">
              <div class="isc-title">ã‚ ã‚¢</div>
              <div class="isc-name">Kana</div>
              <div class="isc-desc">Phonetic syllables (hiragana + katakana). Learnt first.</div>
            </div>
            <div class="intro-script-chip">
              <div class="isc-title">æ¼¢</div>
              <div class="isc-name">Kanji</div>
              <div class="isc-desc">Chinese-origin logographs. Each has meaning & reading.</div>
            </div>
            <div class="intro-script-chip">
              <div class="isc-title">ABC</div>
              <div class="isc-name">RÅmaji</div>
              <div class="isc-desc">Latin letters â€” used to transliterate Japanese for learners.</div>
            </div>
          </div>
          <div class="intro-block-body" style="margin-top:10px">
            <strong>Furigana</strong> (small kana above kanji) help you read unfamiliar characters â€” this app shows furigana on every word so you can build reading confidence from day one.
          </div>
        </div>

        <div class="intro-divider"></div>

        <!-- What is Kanji -->
        <div class="intro-block">
          <div class="intro-block-title">ðŸ–Šï¸ What is Kanji?</div>
          <div class="intro-block-body">
            <strong>Kanji</strong> are logographic characters borrowed from Chinese. Each carries a meaning and one or more readings. For example: <strong>æ°´ (mizu / sui)</strong> means "water". The JLPT tests: N5 ~100 kanji Â· N4 ~300 Â· N3 ~650 Â· N2 ~1,000 Â· N1 ~2,000. Recognising kanji is the single biggest key to reading Japanese fluently.
          </div>
        </div>

        <div class="intro-divider"></div>

        <!-- Vocabulary -->
        <div class="intro-block">
          <div class="intro-block-title">ðŸ“š Vocabulary (èªžå½™ â€” Goi)</div>
          <div class="intro-block-body">
            Vocabulary is tested in two ways on the JLPT: choosing the correct <strong>meaning</strong> of a word, and choosing the correct <strong>reading</strong> (furigana). This app trains both. The number of words per level roughly doubles as you advance:
          </div>
          <div class="intro-levels-grid">
            <div class="intro-level-row">
              <div class="ilr-badge" style="color:var(--n5)">N5</div>
              <div class="ilr-info">
                <div class="ilr-name">ðŸ¥‹ Genin â€” Complete Beginner</div>
                <div class="ilr-desc">Daily life, greetings, numbers, basic verbs</div>
              </div>
              <span class="ilr-vocab" style="background:#eafaf1;color:var(--n5)">~800 words</span>
            </div>
            <div class="intro-level-row">
              <div class="ilr-badge" style="color:var(--n4)">N4</div>
              <div class="ilr-info">
                <div class="ilr-name">âš”ï¸ Chunin â€” Elementary</div>
                <div class="ilr-desc">Shopping, travel, simple conversations</div>
              </div>
              <span class="ilr-vocab" style="background:#eaf4fb;color:var(--n4)">~1,500 words</span>
            </div>
            <div class="intro-level-row">
              <div class="ilr-badge" style="color:var(--n3)">N3</div>
              <div class="ilr-info">
                <div class="ilr-name">ðŸ—¡ï¸ Jonin â€” Intermediate</div>
                <div class="ilr-desc">News, opinions, abstract topics begin</div>
              </div>
              <span class="ilr-vocab" style="background:#f5eef8;color:var(--n3)">~3,750 words</span>
            </div>
            <div class="intro-level-row">
              <div class="ilr-badge" style="color:var(--n2)">N2</div>
              <div class="ilr-info">
                <div class="ilr-name">ðŸ‘ï¸ ANBU â€” Upper Intermediate</div>
                <div class="ilr-desc">Newspapers, formal writing, workplace Japanese</div>
              </div>
              <span class="ilr-vocab" style="background:#fef5e7;color:var(--n2)">~6,000 words</span>
            </div>
            <div class="intro-level-row">
              <div class="ilr-badge" style="color:var(--n1)">N1</div>
              <div class="ilr-info">
                <div class="ilr-name">ðŸŒŸ Kage â€” Near Native</div>
                <div class="ilr-desc">Literature, specialist topics, nuanced expression</div>
              </div>
              <span class="ilr-vocab" style="background:var(--crimson-lt);color:var(--crimson)">~10,000 words</span>
            </div>
          </div>
        </div>

        <div class="intro-divider"></div>

        <!-- Tips -->
        <div class="intro-block">
          <div class="intro-block-title">ðŸ’¡ How to Use This App</div>
          <div class="intro-block-body">
            <strong>1. Pick your level</strong> above (start at N5 if you're new).<br>
            <strong>2. Choose a mode</strong> â€” Meaning quiz, Reading quiz, Type It (romaji input), Flashcard flip, or authentic Past Paper questions.<br>
            <strong>3. Set session size</strong> â€” 10 words is great for a quick study break; go All for a full drill.<br>
            <strong>4. Earn XP &amp; track streaks</strong> â€” mistakes are saved to your Mistake Bank for focused review.<br>
            <strong>5. Daily Word</strong> â€” a new word every day keeps you on a study streak ðŸ”¥.
          </div>
        </div>

      </div>
    </div>
  </div>

</div><!-- /#homeScreen -->

<!-- â”€â”€ MODE SCREEN (shown after tapping a level) â”€â”€ -->
<div class="screen" id="modeScreen">
  <div class="ms-screen">

    <!-- top bar -->
    <div class="ms-topbar">
      <button class="gt-back" onclick="goHome()">â† Back</button>
      <div class="ms-topbar-badge" id="msBadge" style="color:var(--n5)">N5</div>
      <div style="width:60px"></div>
    </div>

    <div class="ms-title" id="msTitle">ðŸ¥‹ GENIN â€” Complete Beginner</div>
    <div class="ms-sub"   id="msSub">154 words available</div>

    <!-- anime quote for this level -->
    <div class="ms-quote-box" id="msQuote"></div>

    <!-- mode tiles -->
    <div class="ms-modes-lbl">Choose your study mode</div>
    <div class="ms-mode-grid">
      <div class="ms-mode-card active" data-mode="meaning" onclick="pickMode(this)">
        <div class="ms-mode-icon">ðŸŽ¯</div>
        <div class="ms-mode-name">Meaning</div>
        <div class="ms-mode-hint">Kanji â†’ English</div>
      </div>
      <div class="ms-mode-card" data-mode="reading" onclick="pickMode(this)">
        <div class="ms-mode-icon">ðŸ“–</div>
        <div class="ms-mode-name">Reading</div>
        <div class="ms-mode-hint">Kanji â†’ furigana</div>
      </div>
      <div class="ms-mode-card" data-mode="fill" onclick="pickMode(this)">
        <div class="ms-mode-icon">âœï¸</div>
        <div class="ms-mode-name">Type It</div>
        <div class="ms-mode-hint">Type the reading</div>
      </div>
      <div class="ms-mode-card" data-mode="flash" onclick="pickMode(this)">
        <div class="ms-mode-icon">ðŸƒ</div>
        <div class="ms-mode-name">Flashcard</div>
        <div class="ms-mode-hint">Flip & self-grade</div>
      </div>
      <div class="ms-mode-card pp-card" data-mode="pastpaper" onclick="pickMode(this)">
        <div class="ms-mode-icon">ðŸ“œ</div>
        <div>
          <div class="ms-mode-name">Past Paper</div>
          <div class="ms-mode-hint">Real JLPT exam questions</div>
        </div>
      </div>
    </div>

    <!-- session size (hidden for past paper) -->
    <div class="ms-size-section" id="msSizeSection">
      <div class="ms-size-lbl">Words per session</div>
      <div class="ms-size-pills">
        <button class="ms-size-pill active" data-sz="10"  onclick="pickSize(this,10)">10</button>
        <button class="ms-size-pill"        data-sz="25"  onclick="pickSize(this,25)">25</button>
        <button class="ms-size-pill"        data-sz="50"  onclick="pickSize(this,50)">50</button>
        <button class="ms-size-pill"        data-sz="all" onclick="pickSize(this,'all')">All</button>
      </div>
      <div class="ms-size-hint" id="msSizeHint"></div>
    </div>

    <button class="ms-start-btn" onclick="startGame()">å§‹ã‚ã¾ã—ã‚‡ã† â€” Let's Begin â†’</button>

  </div>
</div><!-- /#modeScreen -->

<!-- â”€â”€ GAME SCREEN â”€â”€ -->
<div class="screen" id="gameScreen">
  <div class="game-top">
    <div class="gt-left">
      <button class="gt-back" onclick="confirmBack()">â† Back</button>
    </div>
    <div style="text-align:center;flex:1">
      <div class="gt-level" id="gtLevel"></div>
      <div class="gt-rank" id="gtRank"></div>
    </div>
    <div class="gt-right">
      <div class="gt-score">â­ <span id="gtScore">0</span></div>
      <div class="gt-lives" id="gtLives"></div>
    </div>
  </div>
  <div class="prog-bar-wrap"><div class="prog-bar-fill" id="progFill" style="width:0%"></div></div>
  <div class="q-counter" id="qCounter">Question <span>1</span> of <span>15</span> Â· <span>15</span> total words in this level</div>

  <!-- XP + Streak HUD -->
  <div class="xp-hud">
    <div class="xp-rank-badge" id="xpRankBadge">ðŸ¥‹</div>
    <div class="xp-bar-wrap">
      <div class="xp-bar-label">
        <span id="xpRankName">Genin</span>
        <span id="xpLabel">0 XP</span>
      </div>
      <div class="xp-bar-track"><div class="xp-bar-fill" id="xpBarFill" style="width:0%"></div></div>
    </div>
    <div class="xp-streak" id="xpStreakDisplay">ðŸ”¥0</div>
  </div>
  <div class="q-card" id="qCard">
    <!-- Daily challenge indicator (shown when in daily challenge mode) -->
    <div id="dcGameHeader" style="display:none" class="dc-game-header">
      <div class="dc-game-title">ðŸ† Daily Challenge</div>
      <div class="dc-game-sub" id="dcGameSub">Question 1 of 10 Â· 2Ã— Bonus XP active</div>
    </div>
    <div class="q-tag" id="qTag"></div>
    <div id="answerArea"></div>
    <!-- Keyboard hints (desktop only) -->
    <div class="kb-hints" id="kbHints" style="display:none">
      <span class="kb-hint"><span class="kb-key">1</span>â€“<span class="kb-key">4</span> select</span>
      <span class="kb-hint"><span class="kb-key">â†µ</span> next</span>
      <span class="kb-hint"><span class="kb-key">O</span> origin</span>
    </div>
    <div class="sensei-quote" id="senseiQuote">
      <div class="sensei-text" id="senseiText"></div>
      <div class="sensei-src" id="senseiSrc"></div>
    </div>
    <div class="feedback" id="feedback"></div>
    <button class="next-btn" id="nextBtn" onclick="nextQ()">Next â†’</button>
  </div>
</div>

<!-- â”€â”€ SCORE SCREEN â”€â”€ -->
<div class="screen" id="scoreScreen">
  <div class="score-wrap">
    <div class="score-jp" id="scoreJP"></div>
    <div class="score-en" id="scoreEN"></div>
    <div class="score-num" id="scoreNum"></div>
    <div class="score-denom" id="scoreDenom"></div>
    <div class="score-sub" id="scoreSub"></div>
    <div class="score-quote" id="scoreQuote">
      <div class="sq-label">ðŸŽŒ Anime Wisdom</div>
      <div class="sq-jp" id="sqJP"></div>
      <div class="sq-en" id="sqEN"></div>
      <div class="sq-src" id="sqSRC"></div>
    </div>
    <div class="dots-row" id="dotsRow"></div>
    <!-- XP Summary -->
    <div class="score-xp-summary" id="scoreXpSummary">
      <div class="sxp-icon">â­</div>
      <div class="sxp-text">
        <div class="sxp-title" id="sxpTitle">XP Earned This Session</div>
        <div class="sxp-sub" id="sxpSub">Total XP: 0</div>
      </div>
      <div class="sxp-total" id="sxpTotal">+0</div>
    </div>
    <div class="score-actions" id="scoreActions" style="flex-wrap:wrap;gap:10px">
      <button class="sc-btn sc-home" onclick="goHome()">ðŸ  Home</button>
      <button class="sc-btn sc-share" onclick="shareScore()">ðŸ“¤ Share Score</button>
      <button class="sc-btn sc-again" onclick="startGame()" style="flex-basis:100%">ã‚‚ã†ä¸€åº¦ â†’</button>
    </div>
  </div>
</div>

<!-- â”€â”€ STORY SCREEN â”€â”€ -->
<div class="screen" id="storyScreen">
  <div class="story-wrap">
    <div class="story-hero">
      <div class="story-badge" id="storyBadge">ðŸ“– Story Time</div>
      <div class="story-hero-title" id="storyTitle">Your Vocabulary Story</div>
      <div class="story-hero-sub" id="storyHeroSub">A story using the words you just studied</div>
    </div>
    <div class="story-body" id="storyBody">
      <div class="story-loading" id="storyLoading">
        <div class="story-loading-bars"><span></span><span></span><span></span><span></span><span></span></div>
        <div class="story-loading-text">âœï¸ Sensei is writing your personalised story using the words you studied...</div>
      </div>
    </div>
    <div class="story-actions" id="storyActions" style="display:none">
      <button class="sc-btn sc-home" style="flex:1" onclick="goHome()">ðŸ  Home</button>
      <button class="sc-btn sc-again" style="flex:2;background:var(--crimson);color:white" onclick="startGame()">ã‚‚ã†ä¸€åº¦ â†’</button>
    </div>
  </div>
</div>

<!-- â”€â”€ PAST PAPER SCREEN â”€â”€ -->
<div class="screen" id="ppScreen">
  <div class="pp-wrap">
    <div class="pp-header">
      <div class="pp-title-row">
        <div>
          <div class="pp-title" id="ppTitle">JLPT Past Paper Quiz</div>
          <div class="pp-meta" id="ppMeta">N5 Â· Vocabulary Â· 2023</div>
        </div>
        <button class="gt-back" style="color:white;border-color:rgba(255,255,255,0.2)" onclick="confirmBack()">â† Back</button>
      </div>
      <div class="pp-prog-track"><div class="pp-prog-fill" id="ppProgFill" style="width:0%"></div></div>
    </div>
    <div id="ppContent"></div>
  </div>
</div>


<!-- â”€â”€ ORIGIN PANEL â”€â”€ -->
<div class="panel-overlay" id="originOverlay" onclick="closeOrigin(event)">
  <div class="origin-panel" id="originPanel" style="position:relative">
    <div class="panel-handle"></div>
    <button class="panel-close" onclick="closeOriginBtn()">âœ•</button>
    <div class="panel-word" id="opWord"></div>
    <div class="panel-reading" id="opReading"></div>

    <div class="origin-section">
      <div class="origin-section-title">ðŸ›ï¸ Kanji Pictograph Origin</div>
      <div class="origin-section-body" id="opPictograph"></div>
    </div>
    <div class="origin-section">
      <div class="origin-section-title">ðŸ§© Radical Breakdown</div>
      <div class="radical-pills" id="opRadicals"></div>
    </div>
    <div class="origin-section">
      <div class="origin-section-title">ðŸŽ­ Literal / Funny Meaning</div>
      <div class="origin-section-body" id="opLiteral"></div>
    </div>
    <div class="origin-section">
      <div class="origin-section-title">ðŸ“– Memory Hook Story</div>
      <div class="origin-section-body" id="opHook"></div>
    </div>
    <div class="origin-section">
      <div class="origin-section-title">ðŸ”— Related Kanji</div>
      <div class="related-row" id="opRelated"></div>
    </div>
  </div>
</div>

<!-- â”€â”€ SHARE MODAL â”€â”€ -->
<div class="modal-overlay" id="shareModal" onclick="closeShareModal(event)">
  <div class="share-modal-box" onclick="event.stopPropagation()">
    <button class="panel-close" onclick="closeShareModal()" style="position:absolute;top:14px;right:16px">âœ•</button>
    <div style="font-size:2rem;margin-bottom:8px" id="shareModalIcon">ðŸ“¤</div>
    <div class="share-title" id="shareModalTitle">Share Your Score</div>
    <div class="share-text-preview" id="shareTextPreview"></div>
    <div class="share-socials" style="grid-template-columns:1fr 1fr 1fr">
      <button class="share-soc-btn soc-twitter" onclick="shareTo('twitter')">ð• Twitter</button>
      <button class="share-soc-btn soc-whatsapp" onclick="shareTo('whatsapp')">ðŸ’¬ WhatsApp</button>
      <button class="share-soc-btn soc-facebook" onclick="shareTo('facebook')">f Facebook</button>
      <button class="share-soc-btn" style="background:#ff4500;color:white" onclick="shareTo('reddit')">ðŸ¤– Reddit</button>
      <button class="share-soc-btn soc-linkedin" onclick="shareTo('linkedin')">in LinkedIn</button>
      <button class="share-soc-btn" style="background:#1da1f2;color:white" onclick="copyLink()">ðŸ”— Copy</button>
    </div>
    <button class="copy-link-btn" id="copyLinkBtn" onclick="copyLink()">ðŸ”— Copy Link</button>
    <span class="modal-dismiss" onclick="closeShareModal()">Close</span>
  </div>
</div>

<!-- â”€â”€ EMAIL MODAL â”€â”€ -->
<div class="modal-overlay" id="emailModal">
  <div class="modal-box">
    <div class="modal-icon">ðŸ“¬</div>
    <div class="modal-title">Get JLPT Study Tips</div>
    <div class="modal-sub">Join free â€” get weekly vocab tips, anime study tricks, and exam strategies straight to your inbox.</div>
    <div class="email-form">
      <input class="email-inp" id="emailInp" type="email" placeholder="your@email.com">
      <a href="https://YOUR-MAILCHIMP-LINK-HERE" target="_blank" class="modal-btn" onclick="handleEmailSignup()">Subscribe Free â†’</a>
    </div>
    <span class="modal-dismiss" onclick="closeEmail()">Maybe later</span>
  </div>
</div>

<script>
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ANIME QUOTES
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const animeQuotes = [
  { jp:'è«¦ã‚ãŸã‚‰ãã“ã§è©¦åˆçµ‚äº†ã ã‚ˆã€‚', en:'"If you give up, that\'s where the game ends."', src:'â€” Coach Anzai, Slam Dunk ðŸ€' },
  { jp:'ä¿ºãŒã‚„ã‚‰ãªãã‚ƒã€èª°ãŒã‚„ã‚‹ã€‚', en:'"If I don\'t do it, who will?"', src:'â€” Eren Yeager, Attack on Titan âš”ï¸' },
  { jp:'åŠªåŠ›ã—ãŸè€…ãŒå…¨ã¦å ±ã‚ã‚Œã‚‹ã¨ã¯é™ã‚‰ãªã„ã€‚ã—ã‹ã—ã€æˆåŠŸã—ãŸè€…ã¯çš†ã™ã¹ã‹ã‚‰ãåŠªåŠ›ã—ã¦ã„ã‚‹ã€‚', en:'"Not all who work hard are rewarded â€” but all who succeed have worked hard."', src:'â€” Rock Lee, Naruto ðŸƒ' },
  { jp:'é™ç•Œã‚’è¶…ãˆã‚ã€‚', en:'"Go beyond your limits."', src:'â€” All Might, My Hero Academia ðŸ’ª' },
  { jp:'è‡ªåˆ†ã‚’ä¿¡ã˜ã‚‹ã“ã¨ã€ãã‚ŒãŒä¸€ç•ªå¤§åˆ‡ãªã“ã¨ã ã€‚', en:'"Believing in yourself â€” that\'s what matters most."', src:'â€” Monkey D. Luffy, One Piece ðŸ´â€â˜ ï¸' },
  { jp:'å¤±æ•—ã¯æˆåŠŸã®æ¯ã€‚', en:'"Failure is the mother of success."', src:'â€” Dr. Stone ðŸ§ª' },
  { jp:'ä»Šã‚’ç”Ÿãã‚ã€‚', en:'"Live in this moment."', src:'â€” Sword Art Online âš”ï¸' },
  { jp:'ä»²é–“ã‚’å®ˆã‚‹ãŸã‚ã«å¼·ããªã‚‹ã€‚', en:'"I get stronger to protect those I care about."', src:'â€” Naruto Uzumaki, Naruto ðŸƒ' },
  { jp:'ã©ã‚“ãªå¤¢ã‚‚è«¦ã‚ãªã‘ã‚Œã°å¶ã†ã€‚', en:'"Any dream can come true if you never give up."', src:'â€” Gol D. Roger, One Piece ðŸ´â€â˜ ï¸' },
  { jp:'ææ€–ã‚’ä¹—ã‚Šè¶ŠãˆãŸå…ˆã«ã€æœ¬å½“ã®å¼·ã•ãŒã‚ã‚‹ã€‚', en:'"True strength lies on the other side of fear."', src:'â€” Demon Slayer ðŸ—¡ï¸' },
];

const senseiQuotes = [
  { text:'"It\'s not about talent â€” it\'s about effort." ', src:'â€” All Might ðŸ’ª' },
  { text:'"Failure is just another step on the path to mastery."', src:'â€” Rock Lee ðŸƒ' },
  { text:'"Even I got answers wrong before I became the best."', src:'â€” L, Death Note ðŸ°' },
  { text:'"A true warrior never stops learning."', src:'â€” Kenshin Himura âš”ï¸' },
  { text:'"The only way is forward. Never look back with regret."', src:'â€” Naruto ðŸƒ' },
  { text:'"Every mistake is a lesson wearing a disguise."', src:'â€” Senku, Dr. Stone ðŸ§ª' },
];

const lvlRanks = { N5:'ðŸ¥‹ GENIN', N4:'âš”ï¸ CHUNIN', N3:'ðŸ—¡ï¸ JONIN', N2:'ðŸ‘ï¸ ANBU', N1:'ðŸŒŸ KAGE' };
const lvlColor = { N5:'#27ae60', N4:'#2980b9', N3:'#8e44ad', N2:'#e67e22', N1:'#c0392b' };

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// VOCAB + ORIGIN DATA
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const vocab = {
  N5: [
    { k:'æ°´', f:'ã¿ãš', r:'mizu', m:'water', pos:'noun',
      origin:{ pictograph:'æ°´ originally depicted flowing water â€” the three wavy lines in the centre represent streams flowing downward. Ancient oracle bone script shows it as a winding river.', radicals:[{k:'æ°´',m:'water'}], literal:'Looks like water dripping between your fingers ðŸ’§', hook:'Imagine pouring WATER (ã¿ãš) â€” the kanji flows like a river!', related:['æµ·','å·','æ³³'] }},
    { k:'ç«', f:'ã²', r:'hi', m:'fire', pos:'noun',
      origin:{ pictograph:'ç« was drawn as dancing flames rising upward. The two strokes at the bottom are the base of the fire, the top strokes are the flames.', radicals:[{k:'ç«',m:'fire'}], literal:'Looks like a flame with sparks flying up ðŸ”¥', hook:'HI! A FIRE says "hi" when it crackles â€” ã² (hi)!', related:['ç‚Ž','ç‡ƒ','ç„¼'] }},
    { k:'å±±', f:'ã‚„ã¾', r:'yama', m:'mountain', pos:'noun',
      origin:{ pictograph:'å±± is one of the most iconic pictographs â€” three peaks of a mountain range. The tallest peak is in the middle, just like Fuji-san! Used since 3,000 BCE in Chinese script.', radicals:[{k:'å±±',m:'mountain'}], literal:'Three mountain peaks side by side â€” you can literally see the mountains! ðŸ”ï¸', hook:'YAMA-ha motorcycles climb mountains â€” ã‚„ã¾ (yama)!', related:['å²©','å²³','å³°'] }},
    { k:'å·', f:'ã‹ã‚', r:'kawa', m:'river', pos:'noun',
      origin:{ pictograph:'å· shows three streams flowing downward â€” the outer two are the riverbanks, the middle is the main current. You can almost see the river flowing!', radicals:[{k:'å·',m:'river'}], literal:'Three vertical lines = three streams of water flowing down ðŸŒŠ', hook:'A RIVER (ã‹ã‚) has banks on each side â€” just like the outer strokes!', related:['æ°´','æµ·','æµ'] }},
    { k:'é£Ÿã¹ã‚‹', f:'ãŸã¹ã‚‹', r:'taberu', m:'to eat', pos:'verb (ru)',
      origin:{ pictograph:'é£Ÿ shows a person (äºº) bending over a bowl (çš¿) of food. The top part (ð †¢) represents a lid or roof over the food.', radicals:[{k:'é£Ÿ',m:'eat/food'},{k:'äºº',m:'person'}], literal:'A person hunching over their dinner plate ðŸ±', hook:'TABle + ERU = you eat at the TABLE (ãŸã¹ã‚‹)!', related:['é£²','å‘³','æ–™'] }},
    { k:'é£²ã‚€', f:'ã®ã‚€', r:'nomu', m:'to drink', pos:'verb (u)',
      origin:{ pictograph:'é£² combines é£Ÿ (food/eat) with a mouth opening wide (æ¬  â€” a person yawning/opening mouth). Together: opening your mouth to drink.', radicals:[{k:'é£Ÿ',m:'food'},{k:'æ¬ ',m:'open mouth/lack'}], literal:'Food radical + open mouth = consuming liquid ðŸ¥¤', hook:'NO MU-g â€” you say NO to an empty MUG, you want to drink! ã®ã‚€!', related:['é£Ÿ','é…’','æ°´'] }},
    { k:'è¡Œã', f:'ã„ã', r:'iku', m:'to go', pos:'verb (u)',
      origin:{ pictograph:'è¡Œ originally showed a crossroads (å½³ left + äº right) â€” a person standing at an intersection, ready to GO somewhere.', radicals:[{k:'å½³',m:'step/road'},{k:'äº',m:'road right'}], literal:'Standing at a crossroads â€” which way will you GO? ðŸš¶', hook:'IKU sounds like "I go" â€” I go (ã„ã)!', related:['æ¥','æ­©','å¸°'] }},
    { k:'å¤§ãã„', f:'ãŠãŠãã„', r:'ookii', m:'big / large', pos:'adj (i)',
      origin:{ pictograph:'å¤§ shows a person (äºº) standing with arms and legs spread wide â€” making themselves as BIG as possible! The greatest human gesture of size.', radicals:[{k:'å¤§',m:'big/large'},{k:'äºº',m:'person'}], literal:'A person doing a star jump â€” arms and legs spread = BIG! â­', hook:'OO-KII â€” say "ooh!" when you see something BIG (ãŠãŠãã„)!', related:['å°','å¤ª','å¤©'] }},
    { k:'æ–°ã—ã„', f:'ã‚ãŸã‚‰ã—ã„', r:'atarashii', m:'new', pos:'adj (i)',
      origin:{ pictograph:'æ–° combines æœ¨ (tree) + æ–¤ (axe) + ç«‹ (stand) â€” the image of freshly CUT timber, brand new wood just chopped from a standing tree.', radicals:[{k:'æœ¨',m:'tree'},{k:'æ–¤',m:'axe'}], literal:'Freshly cut wood = brand new! ðŸªµ', hook:'A-TA-RASHI â€” "Ah, that\'s the new one!" (ã‚ãŸã‚‰ã—ã„)!', related:['å¤','åˆ','è‹¥'] }},
    { k:'ä»Šæ—¥', f:'ãã‚‡ã†', r:'kyou', m:'today', pos:'noun',
      origin:{ pictograph:'ä»Š (now) + æ—¥ (sun/day) = TODAY. ä»Š shows something being held now â€” the present moment. æ—¥ is the sun. Put them together: the sun of right now = today!', radicals:[{k:'ä»Š',m:'now'},{k:'æ—¥',m:'sun/day'}], literal:'NOW + SUN = today\'s sun = TODAY â˜€ï¸', hook:'KYOU sounds like "here you go" â€” TODAY I give you today! ãã‚‡ã†!', related:['æ˜Žæ—¥','æ˜¨æ—¥','æ¯Žæ—¥'] }},
    { k:'å‹é”', f:'ã¨ã‚‚ã ã¡', r:'tomodachi', m:'friend', pos:'noun',
      origin:{ pictograph:'å‹ shows two hands clasped together â€” two people reaching out to each other in friendship. é” means "to reach/arrive" â€” a friend is someone you reach out to!', radicals:[{k:'å‹',m:'friend'},{k:'é”',m:'reach/plural'}], literal:'Two hands clasped = friendship handshake ðŸ¤', hook:'TOMODACHI â€” "TO-MO-DACHI" â€” Together, More, Dachi (Let\'s go)! Friends go together!', related:['ä»²é–“','å®¶æ—','çŸ¥äºº'] }},
    { k:'å­¦æ ¡', f:'ãŒã£ã“ã†', r:'gakkou', m:'school', pos:'noun',
      origin:{ pictograph:'å­¦ shows a child (å­) under a roof with hands above â€” a child being taught under a roof = learning. æ ¡ adds wood (æœ¨) + the idea of a structure = school building!', radicals:[{k:'å­¦',m:'study/learn'},{k:'æ ¡',m:'school building'}], literal:'Child being taught under a roof ðŸ«', hook:'GAKKOU â€” "GACK! School!" â€” that\'s your reaction Monday morning! ãŒã£ã“ã†!', related:['å¤§å­¦','æ•™å®¤','å…ˆç”Ÿ'] }},
    { k:'å¥½ã', f:'ã™ã', r:'suki', m:'like / fond of', pos:'adj (na)',
      origin:{ pictograph:'å¥½ shows a woman (å¥³) next to a child (å­) â€” a mother\'s love for her child was the original image of LIKING or loving something. Pure affection!', radicals:[{k:'å¥³',m:'woman'},{k:'å­',m:'child'}], literal:'Mother + child = love/like â¤ï¸', hook:'SUKI sounds like "Suckey" â€” the opposite of what you LIKE! But you love suki! ã™ã!', related:['å«Œã„','æ„›','æ‹'] }},
    { k:'ä»Šæ—¥', f:'ãã‚‡ã†', r:'kyou', m:'today', pos:'noun',
      origin:{ pictograph:'ä»Š (now) + æ—¥ (day) = TODAY. The kanji for "now" combined with "sun/day."', radicals:[{k:'ä»Š',m:'now'},{k:'æ—¥',m:'day'}], literal:'The sun of right now â˜€ï¸', hook:'KYOU = today is happening right NOW under the sun!', related:['æ˜Žæ—¥','æ˜¨æ—¥','æ¯Žæ—¥'] }},
    { k:'æ˜Žæ—¥', f:'ã‚ã—ãŸ', r:'ashita', m:'tomorrow', pos:'noun',
      origin:{ pictograph:'æ˜Ž combines æ—¥ (sun) + æœˆ (moon) â€” the brightness of BOTH sun and moon = tomorrow\'s bright new day coming! æ—¥ (day) again reinforces "day."', radicals:[{k:'æ—¥',m:'sun'},{k:'æœˆ',m:'moon'}], literal:'Sun + Moon together = a new bright day is coming ðŸŒ…', hook:'A-SHITA = "Ah, see you tomorrow!" ã‚ã—ãŸ!', related:['ä»Šæ—¥','æ˜¨æ—¥','æ¥é€±'] }},
    { k:'äºº', f:'ã²ã¨', r:'hito', m:'person / people', pos:'noun' },
    { k:'æ—¥', f:'ã«ã¡', r:'nichi', m:'sun / day', pos:'noun' },
    { k:'æœˆ', f:'ã¤ã', r:'tsuki', m:'moon / month', pos:'noun' },
    { k:'å¹´', f:'ã¨ã—', r:'toshi', m:'year', pos:'noun' },
    { k:'æ™‚', f:'ã¨ã', r:'toki', m:'time / hour', pos:'noun' },
    { k:'ä½•', f:'ãªã«', r:'nani', m:'what', pos:'pronoun' },
    { k:'ä»Š', f:'ã„ã¾', r:'ima', m:'now', pos:'noun' },
    { k:'å…ˆ', f:'ã•ã', r:'saki', m:'ahead / previous', pos:'noun' },
    { k:'å¾Œ', f:'ã‚ã¨', r:'ato', m:'after / behind', pos:'noun' },
    { k:'å‰', f:'ã¾ãˆ', r:'mae', m:'before / front', pos:'noun' },
    { k:'ä¸Š', f:'ã†ãˆ', r:'ue', m:'above / up', pos:'noun' },
    { k:'ä¸‹', f:'ã—ãŸ', r:'shita', m:'below / down', pos:'noun' },
    { k:'ä¸­', f:'ãªã‹', r:'naka', m:'inside / middle', pos:'noun' },
    { k:'å³', f:'ã¿ãŽ', r:'migi', m:'right direction', pos:'noun' },
    { k:'å·¦', f:'ã²ã ã‚Š', r:'hidari', m:'left direction', pos:'noun' },
    { k:'å¤–', f:'ãã¨', r:'soto', m:'outside', pos:'noun' },
    { k:'å®¶', f:'ã„ãˆ', r:'ie', m:'house / home', pos:'noun' },
    { k:'è»Š', f:'ãã‚‹ã¾', r:'kuruma', m:'car', pos:'noun' },
    { k:'é§…', f:'ãˆã', r:'eki', m:'train station', pos:'noun' },
    { k:'é›»è»Š', f:'ã§ã‚“ã—ã‚ƒ', r:'densha', m:'electric train', pos:'noun' },
    { k:'é“', f:'ã¿ã¡', r:'michi', m:'road / path', pos:'noun' },
    { k:'åº—', f:'ã¿ã›', r:'mise', m:'shop / store', pos:'noun' },
    { k:'æœ¬', f:'ã»ã‚“', r:'hon', m:'book', pos:'noun' },
    { k:'é›‘èªŒ', f:'ã–ã£ã—', r:'zasshi', m:'magazine', pos:'noun' },
    { k:'æ–°èž', f:'ã—ã‚“ã¶ã‚“', r:'shinbun', m:'newspaper', pos:'noun' },
    { k:'æ‰‹ç´™', f:'ã¦ãŒã¿', r:'tegami', m:'letter (mail)', pos:'noun' },
    { k:'è¨€è‘‰', f:'ã“ã¨ã°', r:'kotoba', m:'word / language', pos:'noun' },
    { k:'åå‰', f:'ãªã¾ãˆ', r:'namae', m:'name', pos:'noun' },
    { k:'ä¼šç¤¾', f:'ã‹ã„ã—ã‚ƒ', r:'kaisha', m:'company', pos:'noun' },
    { k:'ä»•äº‹', f:'ã—ã”ã¨', r:'shigoto', m:'work / job', pos:'noun' },
    { k:'å…ˆç”Ÿ', f:'ã›ã‚“ã›ã„', r:'sensei', m:'teacher', pos:'noun' },
    { k:'å­¦ç”Ÿ', f:'ãŒãã›ã„', r:'gakusei', m:'student', pos:'noun' },
    { k:'å­ä¾›', f:'ã“ã©ã‚‚', r:'kodomo', m:'child', pos:'noun' },
    { k:'ç”·', f:'ãŠã¨ã“', r:'otoko', m:'man / male', pos:'noun' },
    { k:'å¥³', f:'ãŠã‚“ãª', r:'onna', m:'woman / female', pos:'noun' },
    { k:'çˆ¶', f:'ã¡ã¡', r:'chichi', m:'father (my)', pos:'noun' },
    { k:'æ¯', f:'ã¯ã¯', r:'haha', m:'mother (my)', pos:'noun' },
    { k:'å…„', f:'ã‚ã«', r:'ani', m:'older brother (my)', pos:'noun' },
    { k:'å§‰', f:'ã‚ã­', r:'ane', m:'older sister (my)', pos:'noun' },
    { k:'å¼Ÿ', f:'ãŠã¨ã†ã¨', r:'otouto', m:'younger brother', pos:'noun' },
    { k:'å¦¹', f:'ã„ã‚‚ã†ã¨', r:'imouto', m:'younger sister', pos:'noun' },
    { k:'çŠ¬', f:'ã„ã¬', r:'inu', m:'dog', pos:'noun' },
    { k:'çŒ«', f:'ã­ã“', r:'neko', m:'cat', pos:'noun' },
    { k:'é­š', f:'ã•ã‹ãª', r:'sakana', m:'fish', pos:'noun' },
    { k:'è‚‰', f:'ã«ã', r:'niku', m:'meat', pos:'noun' },
    { k:'é‡Žèœ', f:'ã‚„ã•ã„', r:'yasai', m:'vegetables', pos:'noun' },
    { k:'æžœç‰©', f:'ãã ã‚‚ã®', r:'kudamono', m:'fruit', pos:'noun' },
    { k:'ã”é£¯', f:'ã”ã¯ã‚“', r:'gohan', m:'rice / meal', pos:'noun' },
    { k:'ãŠèŒ¶', f:'ãŠã¡ã‚ƒ', r:'ocha', m:'tea', pos:'noun' },
    { k:'ç™½ã„', f:'ã—ã‚ã„', r:'shiroi', m:'white', pos:'adj (i)' },
    { k:'é»’ã„', f:'ãã‚ã„', r:'kuroi', m:'black', pos:'adj (i)' },
    { k:'èµ¤ã„', f:'ã‚ã‹ã„', r:'akai', m:'red', pos:'adj (i)' },
    { k:'é’ã„', f:'ã‚ãŠã„', r:'aoi', m:'blue / green', pos:'adj (i)' },
    { k:'é»„è‰²ã„', f:'ãã„ã‚ã„', r:'kiiroi', m:'yellow', pos:'adj (i)' },
    { k:'å°ã•ã„', f:'ã¡ã„ã•ã„', r:'chiisai', m:'small / little', pos:'adj (i)' },
    { k:'é•·ã„', f:'ãªãŒã„', r:'nagai', m:'long', pos:'adj (i)' },
    { k:'çŸ­ã„', f:'ã¿ã˜ã‹ã„', r:'mijikai', m:'short', pos:'adj (i)' },
    { k:'é«˜ã„', f:'ãŸã‹ã„', r:'takai', m:'tall / expensive', pos:'adj (i)' },
    { k:'å®‰ã„', f:'ã‚„ã™ã„', r:'yasui', m:'cheap / inexpensive', pos:'adj (i)' },
    { k:'æ—©ã„', f:'ã¯ã‚„ã„', r:'hayai', m:'early / fast', pos:'adj (i)' },
    { k:'é…ã„', f:'ãŠãã„', r:'osoi', m:'late / slow', pos:'adj (i)' },
    { k:'æš‘ã„', f:'ã‚ã¤ã„', r:'atsui', m:'hot weather', pos:'adj (i)' },
    { k:'å¯’ã„', f:'ã•ã‚€ã„', r:'samui', m:'cold weather', pos:'adj (i)' },
    { k:'æš–ã‹ã„', f:'ã‚ãŸãŸã‹ã„', r:'atatakai', m:'warm', pos:'adj (i)' },
    { k:'æ¶¼ã—ã„', f:'ã™ãšã—ã„', r:'suzushii', m:'cool / refreshing', pos:'adj (i)' },
    { k:'æ¥½ã—ã„', f:'ãŸã®ã—ã„', r:'tanoshii', m:'fun / enjoyable', pos:'adj (i)' },
    { k:'é›£ã—ã„', f:'ã‚€ãšã‹ã—ã„', r:'muzukashii', m:'difficult', pos:'adj (i)' },
    { k:'æ˜“ã—ã„', f:'ã‚„ã•ã—ã„', r:'yasashii', m:'easy / gentle', pos:'adj (i)' },
    { k:'æ¥ã‚‹', f:'ãã‚‹', r:'kuru', m:'to come', pos:'verb (irr)' },
    { k:'è¦‹ã‚‹', f:'ã¿ã‚‹', r:'miru', m:'to see / watch', pos:'verb (ru)' },
    { k:'èžã', f:'ãã', r:'kiku', m:'to listen / hear', pos:'verb (u)' },
    { k:'è©±ã™', f:'ã¯ãªã™', r:'hanasu', m:'to speak', pos:'verb (u)' },
    { k:'èª­ã‚€', f:'ã‚ˆã‚€', r:'yomu', m:'to read', pos:'verb (u)' },
    { k:'æ›¸ã', f:'ã‹ã', r:'kaku', m:'to write', pos:'verb (u)' },
    { k:'è²·ã†', f:'ã‹ã†', r:'kau', m:'to buy', pos:'verb (u)' },
    { k:'å£²ã‚‹', f:'ã†ã‚‹', r:'uru', m:'to sell', pos:'verb (u)' },
    { k:'ä½¿ã†', f:'ã¤ã‹ã†', r:'tsukau', m:'to use', pos:'verb (u)' },
    { k:'æ€ã†', f:'ãŠã‚‚ã†', r:'omou', m:'to think / feel', pos:'verb (u)' },
    { k:'çŸ¥ã‚‹', f:'ã—ã‚‹', r:'shiru', m:'to know', pos:'verb (u)' },
    { k:'ç«‹ã¤', f:'ãŸã¤', r:'tatsu', m:'to stand up', pos:'verb (u)' },
    { k:'åº§ã‚‹', f:'ã™ã‚ã‚‹', r:'suwaru', m:'to sit down', pos:'verb (u)' },
    { k:'èµ·ãã‚‹', f:'ãŠãã‚‹', r:'okiru', m:'to wake up', pos:'verb (ru)' },
    { k:'å¯ã‚‹', f:'ã­ã‚‹', r:'neru', m:'to sleep', pos:'verb (ru)' },
    { k:'å¸°ã‚‹', f:'ã‹ãˆã‚‹', r:'kaeru', m:'to return home', pos:'verb (u)' },
    { k:'å…¥ã‚‹', f:'ã¯ã„ã‚‹', r:'hairu', m:'to enter', pos:'verb (u)' },
    { k:'å‡ºã‚‹', f:'ã§ã‚‹', r:'deru', m:'to exit / come out', pos:'verb (ru)' },
    { k:'å¾…ã¤', f:'ã¾ã¤', r:'matsu', m:'to wait', pos:'verb (u)' },
    { k:'ä¼šã†', f:'ã‚ã†', r:'au', m:'to meet', pos:'verb (u)' },
    { k:'åˆ†ã‹ã‚‹', f:'ã‚ã‹ã‚‹', r:'wakaru', m:'to understand', pos:'verb (u)' },
    { k:'å§‹ã¾ã‚‹', f:'ã¯ã˜ã¾ã‚‹', r:'hajimaru', m:'to begin', pos:'verb (u)' },
    { k:'çµ‚ã‚ã‚‹', f:'ãŠã‚ã‚‹', r:'owaru', m:'to end', pos:'verb (u)' },
    { k:'é–‹ã‘ã‚‹', f:'ã‚ã‘ã‚‹', r:'akeru', m:'to open something', pos:'verb (ru)' },
    { k:'é–‰ã‚ã‚‹', f:'ã—ã‚ã‚‹', r:'shimeru', m:'to close something', pos:'verb (ru)' },
    { k:'è²¸ã™', f:'ã‹ã™', r:'kasu', m:'to lend', pos:'verb (u)' },
    { k:'å€Ÿã‚Šã‚‹', f:'ã‹ã‚Šã‚‹', r:'kariru', m:'to borrow', pos:'verb (ru)' },
    { k:'æ˜Žæ—¥', f:'ã‚ã—ãŸ', r:'ashita', m:'tomorrow', pos:'noun' },
    { k:'æ˜¨æ—¥', f:'ãã®ã†', r:'kinou', m:'yesterday', pos:'noun' },
    { k:'æ¯Žæ—¥', f:'ã¾ã„ã«ã¡', r:'mainichi', m:'every day', pos:'noun' },
    { k:'ä¸€', f:'ã„ã¡', r:'ichi', m:'one', pos:'number' },
    { k:'äºŒ', f:'ã«', r:'ni', m:'two', pos:'number' },
    { k:'ä¸‰', f:'ã•ã‚“', r:'san', m:'three', pos:'number' },
    { k:'å››', f:'ã‚ˆã‚“', r:'yon', m:'four', pos:'number' },
    { k:'äº”', f:'ã”', r:'go', m:'five', pos:'number' },
    { k:'å…­', f:'ã‚ã', r:'roku', m:'six', pos:'number' },
    { k:'ä¸ƒ', f:'ãªãª', r:'nana', m:'seven', pos:'number' },
    { k:'å…«', f:'ã¯ã¡', r:'hachi', m:'eight', pos:'number' },
    { k:'ä¹', f:'ãã‚…ã†', r:'kyuu', m:'nine', pos:'number' },
    { k:'å', f:'ã˜ã‚…ã†', r:'juu', m:'ten', pos:'number' },
    { k:'ç™¾', f:'ã²ã‚ƒã', r:'hyaku', m:'hundred', pos:'number' },
    { k:'åƒ', f:'ã›ã‚“', r:'sen', m:'thousand', pos:'number' },
    { k:'å††', f:'ãˆã‚“', r:'en', m:'yen / circle', pos:'noun' },
    { k:'æ™‚é–“', f:'ã˜ã‹ã‚“', r:'jikan', m:'time / duration', pos:'noun' },
    { k:'åˆ†', f:'ãµã‚“', r:'fun', m:'minute', pos:'noun' },
    { k:'åˆå‰', f:'ã”ãœã‚“', r:'gozen', m:'AM / morning', pos:'noun' },
    { k:'åˆå¾Œ', f:'ã”ã”', r:'gogo', m:'PM / afternoon', pos:'noun' },
    { k:'æ¯Žé€±', f:'ã¾ã„ã—ã‚…ã†', r:'maishuu', m:'every week', pos:'noun' },
    { k:'æ¥å¹´', f:'ã‚‰ã„ã­ã‚“', r:'rainen', m:'next year', pos:'noun' },
    { k:'åŽ»å¹´', f:'ãã‚‡ã­ã‚“', r:'kyonen', m:'last year', pos:'noun' },
    { k:'æ˜¥', f:'ã¯ã‚‹', r:'haru', m:'spring', pos:'noun' },
    { k:'å¤', f:'ãªã¤', r:'natsu', m:'summer', pos:'noun' },
    { k:'ç§‹', f:'ã‚ã', r:'aki', m:'autumn / fall', pos:'noun' },
    { k:'å†¬', f:'ãµã‚†', r:'fuyu', m:'winter', pos:'noun' },
    { k:'æœ', f:'ã‚ã•', r:'asa', m:'morning', pos:'noun' },
    { k:'æ˜¼', f:'ã²ã‚‹', r:'hiru', m:'daytime / noon', pos:'noun' },
    { k:'å¤œ', f:'ã‚ˆã‚‹', r:'yoru', m:'night / evening', pos:'noun' },
    { k:'åŠ', f:'ã¯ã‚“', r:'han', m:'half', pos:'noun' },
    { k:'é›»æ°—', f:'ã§ã‚“ã', r:'denki', m:'electricity / light', pos:'noun' },
    { k:'çª“', f:'ã¾ã©', r:'mado', m:'window', pos:'noun' },
    { k:'æˆ¸', f:'ã¨', r:'to', m:'door / gate', pos:'noun' },
    { k:'æœº', f:'ã¤ããˆ', r:'tsukue', m:'desk', pos:'noun' },
    { k:'æ¤…å­', f:'ã„ã™', r:'isu', m:'chair', pos:'noun' },
    { k:'éƒ¨å±‹', f:'ã¸ã‚„', r:'heya', m:'room', pos:'noun' },
    { k:'å°æ‰€', f:'ã ã„ã©ã“ã‚', r:'daidokoro', m:'kitchen', pos:'noun' },
    { k:'é¢¨å‘‚', f:'ãµã‚', r:'furo', m:'bath', pos:'noun' },
    { k:'åº­', f:'ã«ã‚', r:'niwa', m:'garden', pos:'noun' },
    { k:'åœ°ä¸‹é‰„', f:'ã¡ã‹ã¦ã¤', r:'chikatetsu', m:'subway', pos:'noun' },
    { k:'ãƒã‚¹', f:'ãƒã‚¹', r:'basu', m:'bus', pos:'noun/loanword' },
    { k:'é£›è¡Œæ©Ÿ', f:'ã²ã“ã†ã', r:'hikouki', m:'airplane', pos:'noun' },
    { k:'èˆ¹', f:'ãµã­', r:'fune', m:'ship / boat', pos:'noun' },
    { k:'åœ°å›³', f:'ã¡ãš', r:'chizu', m:'map', pos:'noun' },
    { k:'å†™çœŸ', f:'ã—ã‚ƒã—ã‚“', r:'shashin', m:'photograph', pos:'noun' },
    { k:'éŸ³æ¥½', f:'ãŠã‚“ãŒã', r:'ongaku', m:'music', pos:'noun' },
    { k:'æ˜ ç”»', f:'ãˆã„ãŒ', r:'eiga', m:'movie / film', pos:'noun' },
    { k:'æ—…è¡Œ', f:'ã‚Šã‚‡ã“ã†', r:'ryokou', m:'travel', pos:'noun' },
    { k:'ç—…é™¢', f:'ã³ã‚‡ã†ã„ã‚“', r:'byouin', m:'hospital', pos:'noun' },
    { k:'è–¬', f:'ãã™ã‚Š', r:'kusuri', m:'medicine', pos:'noun' },
    { k:'æ­¯', f:'ã¯', r:'ha', m:'tooth', pos:'noun' },
    { k:'é«ª', f:'ã‹ã¿', r:'kami', m:'hair', pos:'noun' },
    { k:'ç€ã‚‹', f:'ãã‚‹', r:'kiru', m:'to wear (top)', pos:'verb (ru)' },
    { k:'å±¥ã', f:'ã¯ã', r:'haku', m:'to wear (bottom/shoes)', pos:'verb (u)' },
    { k:'æŒã¤', f:'ã‚‚ã¤', r:'motsu', m:'to hold / have', pos:'verb (u)' },
    { k:'å‡ºã™', f:'ã ã™', r:'dasu', m:'to take out / submit', pos:'verb (u)' },
    { k:'å…¥ã‚Œã‚‹', f:'ã„ã‚Œã‚‹', r:'ireru', m:'to put in', pos:'verb (ru)' },
    { k:'åˆ‡ã‚‹', f:'ãã‚‹', r:'kiru', m:'to cut', pos:'verb (u)' },
    { k:'æ´—ã†', f:'ã‚ã‚‰ã†', r:'arau', m:'to wash', pos:'verb (u)' },
    { k:'é€ã‚‹', f:'ãŠãã‚‹', r:'okuru', m:'to send / see off', pos:'verb (u)' },
    { k:'å—ã‘ã‚‹', f:'ã†ã‘ã‚‹', r:'ukeru', m:'to receive / take (exam)', pos:'verb (ru)' },
    { k:'æ³Šã¾ã‚‹', f:'ã¨ã¾ã‚‹', r:'tomaru', m:'to stay overnight', pos:'verb (u)' }
  ],
  N4: [
    { k:'é›»è©±', f:'ã§ã‚“ã‚', r:'denwa', m:'telephone', pos:'noun',
      origin:{ pictograph:'é›» shows rain (é›¨) with lightning bolts (é›») â€” electricity from a storm. è©± shows a tongue (èˆŒ) + words (è¨€) = speaking. Together: speaking with electricity!', radicals:[{k:'é›»',m:'electricity'},{k:'è©±',m:'speak'}], literal:'Electricity + Speech = Electric Talking Machine âš¡ðŸ—£ï¸', hook:'DEN-WA: "DEN" like a dragon\'s den of electricity, "WA" like "wah!" you spoke! ã§ã‚“ã‚!', related:['æºå¸¯','ãƒ¡ãƒ¼ãƒ«','é€£çµ¡'] }},
    { k:'å¤©æ°—', f:'ã¦ã‚“ã', r:'tenki', m:'weather', pos:'noun',
      origin:{ pictograph:'å¤© shows a person (å¤§) with a line above their head â€” the sky ABOVE a person. æ°— originally showed steam/vapour rising â€” energy, atmosphere, spirit. Sky energy = weather!', radicals:[{k:'å¤©',m:'sky/heaven'},{k:'æ°—',m:'energy/atmosphere'}], literal:'The energy of the sky = weather â›…', hook:'TEN-KI: "TEN" like heaven, "KI" like energy â€” heavenly energy = today\'s weather!', related:['é›¨','æ™´ã‚Œ','æ°—æ¸©'] }},
    { k:'æ–™ç†', f:'ã‚Šã‚‡ã†ã‚Š', r:'ryouri', m:'cooking / dish', pos:'noun',
      origin:{ pictograph:'æ–™ shows rice (ç±³) being measured (æ–—) â€” measuring ingredients. ç† shows a jade gem being polished â€” bringing out inner beauty. Together: measuring and perfecting food!', radicals:[{k:'æ–™',m:'ingredients'},{k:'ç†',m:'logic/polish'}], literal:'Measuring + Perfecting = Cooking something beautifully ðŸ³', hook:'RYOU-RI: "RYO" like Rio carnival of flavours, "RI" like "really delicious!" ã‚Šã‚‡ã†ã‚Š!', related:['é£Ÿã¹ç‰©','å‘³','ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³'] }},
    { k:'æ—…è¡Œ', f:'ã‚Šã‚‡ã“ã†', r:'ryokou', m:'travel', pos:'noun',
      origin:{ pictograph:'æ—… shows a person (äºº) under a flag on the move â€” a traveller following a route marker. è¡Œ is a crossroads (going). Together: a person moving from place to place following the road!', radicals:[{k:'æ—…',m:'travel/trip'},{k:'è¡Œ',m:'go/travel'}], literal:'Traveller + Road = Journey! âœˆï¸', hook:'RYO-KOU: "Ryo" like your travel backpack, "kou" like GO â€” pack your bag and GO! ã‚Šã‚‡ã“ã†!', related:['æ—…äºº','è¦³å…‰','å¤–å›½'] }},
    { k:'ç·´ç¿’', f:'ã‚Œã‚“ã—ã‚…ã†', r:'renshuu', m:'practice', pos:'noun',
      origin:{ pictograph:'ç·´ shows thread (ç³¸) being pulled through repeatedly â€” refining silk by repeated action. ç¿’ shows a bird (ç¾½) learning to fly â€” a young bird practising flapping. Together: repeated refinement!', radicals:[{k:'ç³¸',m:'thread'},{k:'ç¾½',m:'wings/feathers'}], literal:'Refining thread + Young bird learning to fly = Practice! ðŸ¦', hook:'REN-SHUU: "REN" like training again and again, "SHUU" like "Shoo! Keep practising!" ã‚Œã‚“ã—ã‚…ã†!', related:['å‹‰å¼·','è¨“ç·´','ä¸Šé”'] }},
    { k:'è¦šãˆã‚‹', f:'ãŠã¼ãˆã‚‹', r:'oboeru', m:'to memorise', pos:'verb (ru)',
      origin:{ pictograph:'è¦š shows a roof (å®€) protecting a crossed pattern (çˆ») above an eye (è¦‹) â€” knowledge being seen and protected under a roof in your mind = to remember!', radicals:[{k:'è¦‹',m:'see'},{k:'å®€',m:'roof'}], literal:'Keeping knowledge safe under a mental roof ðŸ§ ', hook:'O-BOE-RU: "OH BOY, I REMEMBER!" â€” say it when you suddenly recall something! ãŠã¼ãˆã‚‹!', related:['å¿˜ã‚Œã‚‹','æ€ã„å‡ºã™','è¨˜æ†¶'] }},
    { k:'å¿˜ã‚Œã‚‹', f:'ã‚ã™ã‚Œã‚‹', r:'wasureru', m:'to forget', pos:'verb (ru)',
      origin:{ pictograph:'å¿˜ combines äº¡ (death/gone) + å¿ƒ (heart/mind) â€” when something dies from your heart/mind, you forget it. Poetic and a little sad!', radicals:[{k:'äº¡',m:'gone/dead'},{k:'å¿ƒ',m:'heart/mind'}], literal:'Something dying from your heart = forgetting ðŸ’”', hook:'WASU-RERU: "WAS-URE" â€” something WAS here, now it\'s URE-levant... I forgot! ã‚ã™ã‚Œã‚‹!', related:['è¦šãˆã‚‹','è¨˜æ†¶','æ€ã„å‡ºã™'] }},
    { k:'è¦ªåˆ‡', f:'ã—ã‚“ã›ã¤', r:'shinsetsu', m:'kind / kindness', pos:'adj (na)',
      origin:{ pictograph:'è¦ª shows a tree (æœ¨) being stood next to and watched (è¦‹) â€” a parent standing close, watching over. åˆ‡ means to cut â€” cutting through with care. Kindness cuts through barriers!', radicals:[{k:'è¦ª',m:'parent/close'},{k:'åˆ‡',m:'cut/sincere'}], literal:'Close + Sincere = Genuine Kindness ðŸ’›', hook:'SHIN-SETSU: "SHIN" like shining heart, "SETSU" like "let\'s" be kind! ã—ã‚“ã›ã¤!', related:['å„ªã—ã„','ä¸å¯§','æ€ã„ã‚„ã‚Š'] }},
    { k:'æ—…è¡Œ', f:'ã‚Šã‚‡ã“ã†', r:'ryokou', m:'travel / trip', pos:'noun' },
    { k:'è¦šãˆã‚‹', f:'ãŠã¼ãˆã‚‹', r:'oboeru', m:'to memorise / remember', pos:'verb (ru)' },
    { k:'å¿˜ã‚Œã‚‹', f:'ã‚ã™ã‚Œã‚‹', r:'wasureru', m:'to forget', pos:'verb (ru)' },
    { k:'è¦ªåˆ‡', f:'ã—ã‚“ã›ã¤', r:'shinsetsu', m:'kind / kindness', pos:'adj (na)' },
    { k:'ç·´ç¿’', f:'ã‚Œã‚“ã—ã‚…ã†', r:'renshuu', m:'practice', pos:'noun' },
    { k:'æ–‡åŒ–', f:'ã¶ã‚“ã‹', r:'bunka', m:'culture', pos:'noun' },
    { k:'ç¤¾ä¼š', f:'ã—ã‚ƒã‹ã„', r:'shakai', m:'society', pos:'noun' },
    { k:'çµŒæ¸ˆ', f:'ã‘ã„ã–ã„', r:'keizai', m:'economy', pos:'noun' },
    { k:'æ”¿æ²»', f:'ã›ã„ã˜', r:'seiji', m:'politics', pos:'noun' },
    { k:'è‡ªç„¶', f:'ã—ãœã‚“', r:'shizen', m:'nature', pos:'noun' },
    { k:'æŠ€è¡“', f:'ãŽã˜ã‚…ã¤', r:'gijutsu', m:'technology / skill', pos:'noun' },
    { k:'å»ºç‰©', f:'ãŸã¦ã‚‚ã®', r:'tatemono', m:'building', pos:'noun' },
    { k:'æ©‹', f:'ã¯ã—', r:'hashi', m:'bridge', pos:'noun' },
    { k:'æ± ', f:'ã„ã‘', r:'ike', m:'pond', pos:'noun' },
    { k:'æ£®', f:'ã‚‚ã‚Š', r:'mori', m:'forest', pos:'noun' },
    { k:'æµ·', f:'ã†ã¿', r:'umi', m:'sea / ocean', pos:'noun' },
    { k:'ç©º', f:'ãã‚‰', r:'sora', m:'sky', pos:'noun' },
    { k:'æ˜Ÿ', f:'ã»ã—', r:'hoshi', m:'star', pos:'noun' },
    { k:'å¤ªé™½', f:'ãŸã„ã‚ˆã†', r:'taiyou', m:'sun', pos:'noun' },
    { k:'èŠ±', f:'ã¯ãª', r:'hana', m:'flower', pos:'noun' },
    { k:'æœ¨', f:'ã', r:'ki', m:'tree / wood', pos:'noun' },
    { k:'è‘‰', f:'ã¯', r:'ha', m:'leaf', pos:'noun' },
    { k:'è‰', f:'ãã•', r:'kusa', m:'grass', pos:'noun' },
    { k:'çŸ³', f:'ã„ã—', r:'ishi', m:'stone / rock', pos:'noun' },
    { k:'åœŸ', f:'ã¤ã¡', r:'tsuchi', m:'soil / earth', pos:'noun' },
    { k:'ç©ºæ°—', f:'ãã†ã', r:'kuuki', m:'air', pos:'noun' },
    { k:'ä½“', f:'ã‹ã‚‰ã ', r:'karada', m:'body', pos:'noun' },
    { k:'é ­', f:'ã‚ãŸã¾', r:'atama', m:'head', pos:'noun' },
    { k:'é¡”', f:'ã‹ãŠ', r:'kao', m:'face', pos:'noun' },
    { k:'ç›®', f:'ã‚', r:'me', m:'eye', pos:'noun' },
    { k:'è€³', f:'ã¿ã¿', r:'mimi', m:'ear', pos:'noun' },
    { k:'é¼»', f:'ã¯ãª', r:'hana', m:'nose', pos:'noun' },
    { k:'å£', f:'ãã¡', r:'kuchi', m:'mouth', pos:'noun' },
    { k:'æ‰‹', f:'ã¦', r:'te', m:'hand', pos:'noun' },
    { k:'è¶³', f:'ã‚ã—', r:'ashi', m:'foot / leg', pos:'noun' },
    { k:'å¿ƒ', f:'ã“ã“ã‚', r:'kokoro', m:'heart / mind', pos:'noun' },
    { k:'å£°', f:'ã“ãˆ', r:'koe', m:'voice', pos:'noun' },
    { k:'ç¬‘ã†', f:'ã‚ã‚‰ã†', r:'warau', m:'to laugh / smile', pos:'verb (u)' },
    { k:'æ³£ã', f:'ãªã', r:'naku', m:'to cry', pos:'verb (u)' },
    { k:'æ€’ã‚‹', f:'ãŠã“ã‚‹', r:'okoru', m:'to get angry', pos:'verb (u)' },
    { k:'é©šã', f:'ãŠã©ã‚ã', r:'odoroku', m:'to be surprised', pos:'verb (u)' },
    { k:'å¿ƒé…ã™ã‚‹', f:'ã—ã‚“ã±ã„ã™ã‚‹', r:'shinpaisuru', m:'to worry', pos:'verb (suru)' },
    { k:'å–œã¶', f:'ã‚ˆã‚ã“ã¶', r:'yorokobu', m:'to be pleased', pos:'verb (u)' },
    { k:'æ‚²ã—ã„', f:'ã‹ãªã—ã„', r:'kanashii', m:'sad', pos:'adj (i)' },
    { k:'å¬‰ã—ã„', f:'ã†ã‚Œã—ã„', r:'ureshii', m:'happy / glad', pos:'adj (i)' },
    { k:'æ€–ã„', f:'ã“ã‚ã„', r:'kowai', m:'scary / afraid', pos:'adj (i)' },
    { k:'å±ãªã„', f:'ã‚ã¶ãªã„', r:'abunai', m:'dangerous', pos:'adj (i)' },
    { k:'ä¾¿åˆ©', f:'ã¹ã‚“ã‚Š', r:'benri', m:'convenient', pos:'adj (na)' },
    { k:'ä¸ä¾¿', f:'ãµã¹ã‚“', r:'fuben', m:'inconvenient', pos:'adj (na)' },
    { k:'æ­£ç›´', f:'ã—ã‚‡ã†ã˜ã', r:'shoujiki', m:'honest', pos:'adj (na)' },
    { k:'ä¸å¯§', f:'ã¦ã„ã­ã„', r:'teinei', m:'polite / careful', pos:'adj (na)' },
    { k:'çœŸå‰£', f:'ã—ã‚“ã‘ã‚“', r:'shinken', m:'serious / earnest', pos:'adj (na)' },
    { k:'æ€¥ã', f:'ã„ãã', r:'isogu', m:'to hurry', pos:'verb (u)' },
    { k:'èµ°ã‚‹', f:'ã¯ã—ã‚‹', r:'hashiru', m:'to run', pos:'verb (u)' },
    { k:'æ³³ã', f:'ãŠã‚ˆã', r:'oyogu', m:'to swim', pos:'verb (u)' },
    { k:'ç™»ã‚‹', f:'ã®ã¼ã‚‹', r:'noboru', m:'to climb', pos:'verb (u)' },
    { k:'é™ã‚Šã‚‹', f:'ãŠã‚Šã‚‹', r:'oriru', m:'to get off / descend', pos:'verb (ru)' },
    { k:'ä¹—ã‚‹', f:'ã®ã‚‹', r:'noru', m:'to ride / get on', pos:'verb (u)' },
    { k:'æ¸¡ã‚‹', f:'ã‚ãŸã‚‹', r:'wataru', m:'to cross', pos:'verb (u)' },
    { k:'é›†ã‚ã‚‹', f:'ã‚ã¤ã‚ã‚‹', r:'atsumeru', m:'to collect / gather', pos:'verb (ru)' },
    { k:'èª¿ã¹ã‚‹', f:'ã—ã‚‰ã¹ã‚‹', r:'shiraberu', m:'to investigate', pos:'verb (ru)' },
    { k:'æ¯”ã¹ã‚‹', f:'ãã‚‰ã¹ã‚‹', r:'kuraberu', m:'to compare', pos:'verb (ru)' },
    { k:'å¤‰ãˆã‚‹', f:'ã‹ãˆã‚‹', r:'kaeru', m:'to change something', pos:'verb (ru)' },
    { k:'æ±ºã‚ã‚‹', f:'ãã‚ã‚‹', r:'kimeru', m:'to decide', pos:'verb (ru)' },
    { k:'ç¶šã‘ã‚‹', f:'ã¤ã¥ã‘ã‚‹', r:'tsuzukeru', m:'to continue', pos:'verb (ru)' },
    { k:'ä¼ãˆã‚‹', f:'ã¤ãŸãˆã‚‹', r:'tsutaeru', m:'to convey / tell', pos:'verb (ru)' },
    { k:'æ•™ãˆã‚‹', f:'ãŠã—ãˆã‚‹', r:'oshieru', m:'to teach / tell', pos:'verb (ru)' },
    { k:'å°‹ã­ã‚‹', f:'ãŸãšã­ã‚‹', r:'tazuneru', m:'to ask / visit', pos:'verb (ru)' },
    { k:'ç­”ãˆã‚‹', f:'ã“ãŸãˆã‚‹', r:'kotaeru', m:'to answer', pos:'verb (ru)' },
    { k:'è¬ã‚‹', f:'ã‚ã‚„ã¾ã‚‹', r:'ayamaru', m:'to apologise', pos:'verb (u)' },
    { k:'é ¼ã‚€', f:'ãŸã®ã‚€', r:'tanomu', m:'to request / ask favour', pos:'verb (u)' },
    { k:'é¸ã¶', f:'ãˆã‚‰ã¶', r:'erabu', m:'to choose / select', pos:'verb (u)' },
    { k:'æ‹¾ã†', f:'ã²ã‚ã†', r:'hirou', m:'to pick up', pos:'verb (u)' },
    { k:'æ¨ã¦ã‚‹', f:'ã™ã¦ã‚‹', r:'suteru', m:'to throw away', pos:'verb (ru)' },
    { k:'ç‰‡ä»˜ã‘ã‚‹', f:'ã‹ãŸã¥ã‘ã‚‹', r:'katazukeru', m:'to tidy up', pos:'verb (ru)' },
    { k:'æº–å‚™', f:'ã˜ã‚…ã‚“ã³', r:'junbi', m:'preparation', pos:'noun' },
    { k:'æ©Ÿä¼š', f:'ãã‹ã„', r:'kikai', m:'opportunity / chance', pos:'noun' },
    { k:'ç›®çš„', f:'ã‚‚ãã¦ã', r:'mokuteki', m:'purpose / goal', pos:'noun' },
    { k:'ç†ç”±', f:'ã‚Šã‚†ã†', r:'riyuu', m:'reason / cause', pos:'noun' },
    { k:'çµæžœ', f:'ã‘ã£ã‹', r:'kekka', m:'result / outcome', pos:'noun' },
    { k:'æ–¹æ³•', f:'ã»ã†ã»ã†', r:'houhou', m:'method / way', pos:'noun' },
    { k:'å•é¡Œ', f:'ã‚‚ã‚“ã ã„', r:'mondai', m:'problem / question', pos:'noun' },
    { k:'ç­”ãˆ', f:'ã“ãŸãˆ', r:'kotae', m:'answer', pos:'noun' },
    { k:'æ„è¦‹', f:'ã„ã‘ã‚“', r:'iken', m:'opinion', pos:'noun' },
    { k:'è€ƒãˆ', f:'ã‹ã‚“ãŒãˆ', r:'kangae', m:'thought / idea', pos:'noun' },
    { k:'çµŒé¨“', f:'ã‘ã„ã‘ã‚“', r:'keiken', m:'experience', pos:'noun' },
    { k:'èƒ½åŠ›', f:'ã®ã†ã‚Šã‚‡ã', r:'nouryoku', m:'ability / capacity', pos:'noun' },
    { k:'åŠªåŠ›', f:'ã©ã‚Šã‚‡ã', r:'doryoku', m:'effort', pos:'noun' },
    { k:'æˆåŠŸ', f:'ã›ã„ã“ã†', r:'seikou', m:'success', pos:'noun' },
    { k:'å¤±æ•—', f:'ã—ã£ã±ã„', r:'shippai', m:'failure', pos:'noun' },
    { k:'å¤¢', f:'ã‚†ã‚', r:'yume', m:'dream', pos:'noun' },
    { k:'å¸Œæœ›', f:'ãã¼ã†', r:'kibou', m:'hope / wish', pos:'noun' },
    { k:'é–¢ä¿‚', f:'ã‹ã‚“ã‘ã„', r:'kankei', m:'relationship', pos:'noun' },
    { k:'å‹æƒ…', f:'ã‚†ã†ã˜ã‚‡ã†', r:'yuujou', m:'friendship', pos:'noun' },
    { k:'æ„›', f:'ã‚ã„', r:'ai', m:'love', pos:'noun' },
    { k:'è¨€èªž', f:'ã’ã‚“ã”', r:'gengo', m:'language', pos:'noun' },
    { k:'æ–‡ç« ', f:'ã¶ã‚“ã—ã‚‡ã†', r:'bunshou', m:'sentence / text', pos:'noun' },
    { k:'ä½æ‰€', f:'ã˜ã‚…ã†ã—ã‚‡', r:'juusho', m:'address', pos:'noun' },
    { k:'åœ°å›³', f:'ã¡ãš', r:'chizu', m:'map', pos:'noun' },
    { k:'è¨ˆç”»', f:'ã‘ã„ã‹ã', r:'keikaku', m:'plan', pos:'noun' },
    { k:'éƒ½å¸‚', f:'ã¨ã—', r:'toshi', m:'city / urban area', pos:'noun' },
    { k:'ç”°èˆŽ', f:'ã„ãªã‹', r:'inaka', m:'countryside', pos:'noun' },
    { k:'æ™¯è‰²', f:'ã‘ã—ã', r:'keshiki', m:'scenery / view', pos:'noun' },
    { k:'æ¸©åº¦', f:'ãŠã‚“ã©', r:'ondo', m:'temperature', pos:'noun' },
    { k:'æ¹¿åº¦', f:'ã—ã¤ã©', r:'shitsudo', m:'humidity', pos:'noun' },
    { k:'å¤©å€™', f:'ã¦ã‚“ã“ã†', r:'tenkou', m:'weather conditions', pos:'noun' },
    { k:'å°é¢¨', f:'ãŸã„ãµã†', r:'taifuu', m:'typhoon', pos:'noun' },
    { k:'åœ°éœ‡', f:'ã˜ã—ã‚“', r:'jishin', m:'earthquake', pos:'noun' },
    { k:'æ´ªæ°´', f:'ã“ã†ãšã„', r:'kouzui', m:'flood', pos:'noun' },
    { k:'ç½å®³', f:'ã•ã„ãŒã„', r:'saigai', m:'disaster', pos:'noun' },
    { k:'äº‹æ•…', f:'ã˜ã“', r:'jiko', m:'accident', pos:'noun' },
    { k:'å®‰å…¨', f:'ã‚ã‚“ãœã‚“', r:'anzen', m:'safety', pos:'noun/adj(na)' },
    { k:'å±é™º', f:'ãã‘ã‚“', r:'kiken', m:'danger', pos:'noun/adj(na)' },
    { k:'è¦å‰‡', f:'ããã', r:'kisoku', m:'rule / regulation', pos:'noun' },
    { k:'æ³•å¾‹', f:'ã»ã†ã‚Šã¤', r:'houritsu', m:'law', pos:'noun' },
    { k:'ç¨Žé‡‘', f:'ãœã„ãã‚“', r:'zeikin', m:'tax', pos:'noun' },
    { k:'çµ¦æ–™', f:'ãã‚…ã†ã‚Šã‚‡ã†', r:'kyuuryou', m:'salary / wages', pos:'noun' },
    { k:'ç”Ÿæ´»', f:'ã›ã„ã‹ã¤', r:'seikatsu', m:'daily life', pos:'noun' },
    { k:'å®¶æ—', f:'ã‹ãžã', r:'kazoku', m:'family', pos:'noun' },
    { k:'çµå©š', f:'ã‘ã£ã“ã‚“', r:'kekkon', m:'marriage', pos:'noun' },
    { k:'é›¢å©š', f:'ã‚Šã“ã‚“', r:'rikon', m:'divorce', pos:'noun' },
    { k:'è‚²ã¦ã‚‹', f:'ãã ã¦ã‚‹', r:'sodateru', m:'to raise / bring up', pos:'verb (ru)' },
    { k:'ç”Ÿã¾ã‚Œã‚‹', f:'ã†ã¾ã‚Œã‚‹', r:'umareru', m:'to be born', pos:'verb (ru)' },
    { k:'äº¡ããªã‚‹', f:'ãªããªã‚‹', r:'nakunaru', m:'to pass away', pos:'verb (u)' },
    { k:'æˆé•·ã™ã‚‹', f:'ã›ã„ã¡ã‚‡ã†ã™ã‚‹', r:'seichousuru', m:'to grow up', pos:'verb (suru)' },
    { k:'å¥åº·', f:'ã‘ã‚“ã“ã†', r:'kenkou', m:'health', pos:'noun/adj(na)' },
    { k:'ç—…æ°—', f:'ã³ã‚‡ã†ã', r:'byouki', m:'illness / sickness', pos:'noun' },
    { k:'åŒ»è€…', f:'ã„ã—ã‚ƒ', r:'isha', m:'doctor', pos:'noun' },
    { k:'çœ‹è­·å¸«', f:'ã‹ã‚“ã”ã—', r:'kangoshi', m:'nurse', pos:'noun' },
    { k:'æ‰‹è¡“', f:'ã—ã‚…ã˜ã‚…ã¤', r:'shujutsu', m:'surgery / operation', pos:'noun' },
    { k:'å…¥é™¢', f:'ã«ã‚…ã†ã„ã‚“', r:'nyuuin', m:'hospitalisation', pos:'noun' },
    { k:'é€€é™¢', f:'ãŸã„ã„ã‚“', r:'taiin', m:'hospital discharge', pos:'noun' },
    { k:'æ­¯åŒ»è€…', f:'ã¯ã„ã—ã‚ƒ', r:'haisha', m:'dentist', pos:'noun' },
    { k:'çœ¼ç§‘', f:'ãŒã‚“ã‹', r:'ganka', m:'ophthalmology', pos:'noun' },
    { k:'è–¬å±€', f:'ã‚„ã£ãã‚‡ã', r:'yakkyoku', m:'pharmacy', pos:'noun' },
    { k:'ææ–™', f:'ã–ã„ã‚Šã‚‡ã†', r:'zairyou', m:'ingredient / material', pos:'noun' },
    { k:'å‘³', f:'ã‚ã˜', r:'aji', m:'taste / flavour', pos:'noun' },
    { k:'è¾›ã„', f:'ã‹ã‚‰ã„', r:'karai', m:'spicy', pos:'adj (i)' },
    { k:'ç”˜ã„', f:'ã‚ã¾ã„', r:'amai', m:'sweet', pos:'adj (i)' },
    { k:'è‹¦ã„', f:'ã«ãŒã„', r:'nigai', m:'bitter', pos:'adj (i)' },
    { k:'é…¸ã£ã±ã„', f:'ã™ã£ã±ã„', r:'suppai', m:'sour', pos:'adj (i)' },
    { k:'å¡©è¾›ã„', f:'ã—ãŠã‹ã‚‰ã„', r:'shiokarai', m:'salty', pos:'adj (i)' },
    { k:'ç„¼ã', f:'ã‚„ã', r:'yaku', m:'to grill / bake', pos:'verb (u)' },
    { k:'èŒ¹ã§ã‚‹', f:'ã‚†ã§ã‚‹', r:'yuderu', m:'to boil (food)', pos:'verb (ru)' },
    { k:'ç‚’ã‚ã‚‹', f:'ã„ãŸã‚ã‚‹', r:'itameru', m:'to stir-fry', pos:'verb (ru)' },
    { k:'æ··ãœã‚‹', f:'ã¾ãœã‚‹', r:'mazeru', m:'to mix', pos:'verb (ru)' },
    { k:'åˆ‡ã‚Šå–ã‚‹', f:'ãã‚Šã¨ã‚‹', r:'kiritoru', m:'to cut out', pos:'verb (u)' },
    { k:'å®Œæˆã™ã‚‹', f:'ã‹ã‚“ã›ã„ã™ã‚‹', r:'kanseisuru', m:'to complete / finish', pos:'verb (suru)' },
    { k:'ç”³ã—è¾¼ã‚€', f:'ã‚‚ã†ã—ã“ã‚€', r:'moushikomu', m:'to apply / register', pos:'verb (u)' },
    { k:'æ–­ã‚‹', f:'ã“ã¨ã‚ã‚‹', r:'kotowaru', m:'to refuse / decline', pos:'verb (u)' },
    { k:'è¨±ã™', f:'ã‚†ã‚‹ã™', r:'yurusu', m:'to forgive / permit', pos:'verb (u)' }
  ],
  N3: [
    { k:'ç’°å¢ƒ', f:'ã‹ã‚“ãã‚‡ã†', r:'kankyou', m:'environment', pos:'noun',
      origin:{ pictograph:'ç’° shows jade rings (çŽ‰) going around in a circle â€” encircling. å¢ƒ shows earth (åœŸ) with a boundary. Together: the circular boundary of the earth around us = environment!', radicals:[{k:'çŽ‰',m:'jewel/circle'},{k:'åœŸ',m:'earth'},{k:'å¢ƒ',m:'boundary'}], literal:'Circular + Boundary of Earth = The world surrounding us ðŸŒ', hook:'KAN-KYO: "CAN" the environment "GO" (kyou) on? â€” we must protect it! ã‹ã‚“ãã‚‡ã†!', related:['è‡ªç„¶','åœ°çƒ','ç”Ÿæ…‹ç³»'] }},
    { k:'è²¬ä»»', f:'ã›ãã«ã‚“', r:'sekinin', m:'responsibility', pos:'noun',
      origin:{ pictograph:'è²¬ shows a bundle (æœ¿) being piled on a person â€” the burden of obligations piling up. ä»» shows a person (äºº) carrying something â€” bearing a load. Together: bearing the burden you\'re obligated to carry!', radicals:[{k:'æœ¿',m:'thorn/burden'},{k:'äºº',m:'person'}], literal:'A burden being placed on someone who must carry it ðŸ’ª', hook:'SEKI-NIN: "SEEK" your responsibilities, "NIN" like ninja â€” a ninja never avoids duty! ã›ãã«ã‚“!', related:['ç¾©å‹™','å½¹å‰²','è·å‹™'] }},
    { k:'å¯èƒ½æ€§', f:'ã‹ã®ã†ã›ã„', r:'kanousei', m:'possibility', pos:'noun',
      origin:{ pictograph:'å¯ shows a mouth (å£) giving approval â€” possible, permitted. èƒ½ shows a bear (èƒ½) â€” a capable, powerful creature. æ€§ is nature/essence. Together: the capable nature of something being approved = possibility!', radicals:[{k:'å£',m:'mouth'},{k:'èƒ½',m:'ability'},{k:'æ€§',m:'nature'}], literal:'Approval + Capability + Essence = The potential for something to happen âœ¨', hook:'KA-NOU-SEI: "CAN-DO-SAY" â€” if you CAN DO it, SAY yes! It\'s possible! ã‹ã®ã†ã›ã„!', related:['å¯èƒ½','æ©Ÿä¼š','ãƒãƒ£ãƒ³ã‚¹'] }},
    { k:'å½±éŸ¿', f:'ãˆã„ãã‚‡ã†', r:'eikyou', m:'influence / effect', pos:'noun',
      origin:{ pictograph:'å½± shows a shadow (å½¡) cast by the sun through trees (æ™¯) â€” a shadow is the influence of an object on light. éŸ¿ shows a sound wave echoing (éŸ³+é„•) â€” influence echoes out like sound!', radicals:[{k:'æ™¯',m:'scenery/light'},{k:'å½¡',m:'shadow/hair'},{k:'éŸ³',m:'sound'}], literal:'Shadow + Echo = The effect one thing has on another ðŸŒŠ', hook:'EI-KYO: Think of the ripple EFFECT (ãˆã„ãã‚‡ã†) â€” like throwing a stone in water, the influence spreads!', related:['åŠ¹æžœ','ä½œç”¨','çµæžœ'] }},
    { k:'è¤‡é›‘', f:'ãµãã–ã¤', r:'fukuzatsu', m:'complicated / complex', pos:'adj (na)',
      origin:{ pictograph:'è¤‡ shows a garment (è¡£) doubled (ç•) â€” something layered and overlapping. é›‘ shows a bird (éš¹) among trees (æœ¨) with mixed things (ä¹) â€” chaotic and mixed. Layered chaos = complicated!', radicals:[{k:'è¡£',m:'clothing'},{k:'éš¹',m:'bird'},{k:'æœ¨',m:'tree'}], literal:'Layered clothing + Bird in tangled trees = COMPLICATED! ðŸ¦â€â¬›', hook:'FUKU-ZATSU: "Full of ZEST" â€” complicated things are full of tangled energy! ãµãã–ã¤!', related:['ç°¡å˜','é›£ã—ã„','å˜ç´”'] }},
    { k:'ç¾å®Ÿ', f:'ã’ã‚“ã˜ã¤', r:'genjitsu', m:'reality', pos:'noun' },
    { k:'ç†æƒ³', f:'ã‚Šãã†', r:'risou', m:'ideal', pos:'noun' },
    { k:'ç›®æ¨™', f:'ã‚‚ãã²ã‚‡ã†', r:'mokuhyou', m:'goal / target', pos:'noun' },
    { k:'å®Ÿç¾', f:'ã˜ã¤ã’ã‚“', r:'jitsugen', m:'realisation', pos:'noun' },
    { k:'ç™ºå±•', f:'ã¯ã£ã¦ã‚“', r:'hatten', m:'development', pos:'noun' },
    { k:'å¤‰åŒ–', f:'ã¸ã‚“ã‹', r:'henka', m:'change', pos:'noun' },
    { k:'èª²é¡Œ', f:'ã‹ã ã„', r:'kadai', m:'task / issue', pos:'noun' },
    { k:'è§£æ±º', f:'ã‹ã„ã‘ã¤', r:'kaiketsu', m:'solution / resolution', pos:'noun' },
    { k:'çŠ¶æ³', f:'ã˜ã‚‡ã†ãã‚‡ã†', r:'joukyou', m:'situation', pos:'noun' },
    { k:'æ¡ä»¶', f:'ã˜ã‚‡ã†ã‘ã‚“', r:'jouken', m:'condition / requirement', pos:'noun' },
    { k:'åˆ¶åº¦', f:'ã›ã„ã©', r:'seido', m:'system / institution', pos:'noun' },
    { k:'æ–‡æ˜Ž', f:'ã¶ã‚“ã‚ã„', r:'bunmei', m:'civilisation', pos:'noun' },
    { k:'ä¼çµ±', f:'ã§ã‚“ã¨ã†', r:'dentou', m:'tradition', pos:'noun' },
    { k:'ç¿’æ…£', f:'ã—ã‚…ã†ã‹ã‚“', r:'shuukan', m:'habit / custom', pos:'noun' },
    { k:'ä¾¡å€¤', f:'ã‹ã¡', r:'kachi', m:'value / worth', pos:'noun' },
    { k:'åŸºæº–', f:'ãã˜ã‚…ã‚“', r:'kijun', m:'standard / criterion', pos:'noun' },
    { k:'åŽŸå› ', f:'ã’ã‚“ã„ã‚“', r:'genin', m:'cause / origin', pos:'noun' },
    { k:'æ‰‹æ®µ', f:'ã—ã‚…ã ã‚“', r:'shudan', m:'means / method', pos:'noun' },
    { k:'å¯¾è±¡', f:'ãŸã„ã—ã‚‡ã†', r:'taishou', m:'target / subject', pos:'noun' },
    { k:'ç¯„å›²', f:'ã¯ã‚“ã„', r:'han\'i', m:'range / scope', pos:'noun' },
    { k:'å…±é€š', f:'ãã‚‡ã†ã¤ã†', r:'kyoutsuu', m:'common / shared', pos:'adj (na)' },
    { k:'ç‹¬è‡ª', f:'ã©ãã˜', r:'dokuji', m:'unique / original', pos:'adj (na)' },
    { k:'å…·ä½“çš„', f:'ããŸã„ã¦ã', r:'gutaiteki', m:'concrete / specific', pos:'adj (na)' },
    { k:'æŠ½è±¡çš„', f:'ã¡ã‚…ã†ã—ã‚‡ã†ã¦ã', r:'chuushouteki', m:'abstract', pos:'adj (na)' },
    { k:'ä¸€èˆ¬çš„', f:'ã„ã£ã±ã‚“ã¦ã', r:'ippanteki', m:'general / common', pos:'adj (na)' },
    { k:'ç©æ¥µçš„', f:'ã›ã£ãã‚‡ãã¦ã', r:'sekkyokuteki', m:'positive / proactive', pos:'adj (na)' },
    { k:'æ¶ˆæ¥µçš„', f:'ã—ã‚‡ã†ãã‚‡ãã¦ã', r:'shoukyokuteki', m:'passive / negative', pos:'adj (na)' },
    { k:'ä¿è­·ã™ã‚‹', f:'ã»ã”ã™ã‚‹', r:'hogosuru', m:'to protect', pos:'verb (suru)' },
    { k:'ä¿ƒé€²ã™ã‚‹', f:'ããã—ã‚“ã™ã‚‹', r:'sokushinsuru', m:'to promote / accelerate', pos:'verb (suru)' },
    { k:'å”åŠ›ã™ã‚‹', f:'ãã‚‡ã†ã‚Šã‚‡ãã™ã‚‹', r:'kyouryokusuru', m:'to cooperate', pos:'verb (suru)' },
    { k:'åå¯¾ã™ã‚‹', f:'ã¯ã‚“ãŸã„ã™ã‚‹', r:'hantaisuru', m:'to oppose', pos:'verb (suru)' },
    { k:'æ”¯æŒã™ã‚‹', f:'ã—ã˜ã™ã‚‹', r:'shijisuru', m:'to support', pos:'verb (suru)' },
    { k:'è¨¼æ˜Žã™ã‚‹', f:'ã—ã‚‡ã†ã‚ã„ã™ã‚‹', r:'shoumeisuru', m:'to prove', pos:'verb (suru)' },
    { k:'è¡¨ç¾ã™ã‚‹', f:'ã²ã‚‡ã†ã’ã‚“ã™ã‚‹', r:'hyougensuru', m:'to express', pos:'verb (suru)' },
    { k:'åˆ¤æ–­ã™ã‚‹', f:'ã¯ã‚“ã ã‚“ã™ã‚‹', r:'handansuru', m:'to judge / decide', pos:'verb (suru)' },
    { k:'æ¤œè¨Žã™ã‚‹', f:'ã‘ã‚“ã¨ã†ã™ã‚‹', r:'kentousuru', m:'to examine / consider', pos:'verb (suru)' },
    { k:'è©•ä¾¡ã™ã‚‹', f:'ã²ã‚‡ã†ã‹ã™ã‚‹', r:'hyoukasuru', m:'to evaluate', pos:'verb (suru)' },
    { k:'åˆ†æžã™ã‚‹', f:'ã¶ã‚“ã›ãã™ã‚‹', r:'bunsekisuru', m:'to analyse', pos:'verb (suru)' },
    { k:'æˆåŠŸã™ã‚‹', f:'ã›ã„ã“ã†ã™ã‚‹', r:'seikousuru', m:'to succeed', pos:'verb (suru)' },
    { k:'å¤±æ•—ã™ã‚‹', f:'ã—ã£ã±ã„ã™ã‚‹', r:'shippaisuru', m:'to fail', pos:'verb (suru)' },
    { k:'å›žå¾©ã™ã‚‹', f:'ã‹ã„ãµãã™ã‚‹', r:'kaifukusuru', m:'to recover', pos:'verb (suru)' },
    { k:'ç™ºé”ã™ã‚‹', f:'ã¯ã£ãŸã¤ã™ã‚‹', r:'hattatsusuru', m:'to develop / grow', pos:'verb (suru)' },
    { k:'å­˜åœ¨ã™ã‚‹', f:'ãã‚“ã–ã„ã™ã‚‹', r:'sonzaisuru', m:'to exist', pos:'verb (suru)' },
    { k:'ç¢ºèªã™ã‚‹', f:'ã‹ãã«ã‚“ã™ã‚‹', r:'kakuninsuru', m:'to confirm', pos:'verb (suru)' },
    { k:'ææ¡ˆã™ã‚‹', f:'ã¦ã„ã‚ã‚“ã™ã‚‹', r:'teiansuru', m:'to propose', pos:'verb (suru)' },
    { k:'æ¯”è¼ƒã™ã‚‹', f:'ã²ã‹ãã™ã‚‹', r:'hikakusuru', m:'to compare', pos:'verb (suru)' },
    { k:'è¨˜éŒ²ã™ã‚‹', f:'ãã‚ãã™ã‚‹', r:'kirokusuru', m:'to record', pos:'verb (suru)' },
    { k:'å‚åŠ ã™ã‚‹', f:'ã•ã‚“ã‹ã™ã‚‹', r:'sankasuru', m:'to participate', pos:'verb (suru)' },
    { k:'å¯¾å¿œã™ã‚‹', f:'ãŸã„ãŠã†ã™ã‚‹', r:'taiousuru', m:'to respond / cope', pos:'verb (suru)' },
    { k:'æ•´ç†ã™ã‚‹', f:'ã›ã„ã‚Šã™ã‚‹', r:'seirisuru', m:'to organise', pos:'verb (suru)' },
    { k:'ç®¡ç†ã™ã‚‹', f:'ã‹ã‚“ã‚Šã™ã‚‹', r:'kanrisuru', m:'to manage', pos:'verb (suru)' },
    { k:'æ´»å‹•', f:'ã‹ã¤ã©ã†', r:'katsudou', m:'activity', pos:'noun' },
    { k:'é‹å‹•', f:'ã†ã‚“ã©ã†', r:'undou', m:'movement / exercise', pos:'noun' },
    { k:'è­°è«–', f:'ãŽã‚ã‚“', r:'giron', m:'argument / discussion', pos:'noun' },
    { k:'äº¤æµ', f:'ã“ã†ã‚Šã‚…ã†', r:'kouryuu', m:'exchange / interaction', pos:'noun' },
    { k:'ç†è§£', f:'ã‚Šã‹ã„', r:'rikai', m:'understanding', pos:'noun' },
    { k:'æ„Ÿè¬', f:'ã‹ã‚“ã—ã‚ƒ', r:'kansha', m:'gratitude', pos:'noun' },
    { k:'å¾Œæ‚”', f:'ã“ã†ã‹ã„', r:'koukai', m:'regret', pos:'noun' },
    { k:'æ„Ÿæƒ…', f:'ã‹ã‚“ã˜ã‚‡ã†', r:'kanjou', m:'emotion', pos:'noun' },
    { k:'æƒ³åƒ', f:'ãã†ãžã†', r:'souzou', m:'imagination', pos:'noun' },
    { k:'è¨˜æ†¶', f:'ããŠã', r:'kioku', m:'memory', pos:'noun' },
    { k:'æ³¨æ„', f:'ã¡ã‚…ã†ã„', r:'chuui', m:'attention / caution', pos:'noun' },
    { k:'é›†ä¸­', f:'ã—ã‚…ã†ã¡ã‚…ã†', r:'shuuchuu', m:'concentration', pos:'noun' },
    { k:'é™ç•Œ', f:'ã’ã‚“ã‹ã„', r:'genkai', m:'limit / boundary', pos:'noun' },
    { k:'å‹‡æ°—', f:'ã‚†ã†ã', r:'yuuki', m:'courage', pos:'noun' },
    { k:'è‡ªä¿¡', f:'ã˜ã—ã‚“', r:'jishin', m:'confidence', pos:'noun' },
    { k:'ä¸å®‰', f:'ãµã‚ã‚“', r:'fuan', m:'anxiety / unease', pos:'noun' },
    { k:'æœŸå¾…', f:'ããŸã„', r:'kitai', m:'expectation', pos:'noun' },
    { k:'æº€è¶³', f:'ã¾ã‚“ãžã', r:'manzoku', m:'satisfaction', pos:'noun' },
    { k:'å‘ä¸Š', f:'ã“ã†ã˜ã‚‡ã†', r:'koujou', m:'improvement', pos:'noun' },
    { k:'ç ”ç©¶', f:'ã‘ã‚“ãã‚…ã†', r:'kenkyuu', m:'research / study', pos:'noun' },
    { k:'èª¿æŸ»', f:'ã¡ã‚‡ã†ã•', r:'chousa', m:'investigation', pos:'noun' },
    { k:'å ±å‘Š', f:'ã»ã†ã“ã', r:'houkoku', m:'report', pos:'noun' },
    { k:'çµè«–', f:'ã‘ã¤ã‚ã‚“', r:'ketsuron', m:'conclusion', pos:'noun' },
    { k:'ä¸»å¼µ', f:'ã—ã‚…ã¡ã‚‡ã†', r:'shuchou', m:'assertion / claim', pos:'noun' },
    { k:'æ‰¹åˆ¤', f:'ã²ã¯ã‚“', r:'hihan', m:'criticism', pos:'noun' },
    { k:'è¦³ç‚¹', f:'ã‹ã‚“ã¦ã‚“', r:'kanten', m:'viewpoint', pos:'noun' },
    { k:'è«–ç‚¹', f:'ã‚ã‚“ã¦ã‚“', r:'ronten', m:'point of argument', pos:'noun' },
    { k:'ç¤ºã™', f:'ã—ã‚ã™', r:'shimesu', m:'to show / indicate', pos:'verb (u)' },
    { k:'è¡¨ã™', f:'ã‚ã‚‰ã‚ã™', r:'arawasu', m:'to express / represent', pos:'verb (u)' },
    { k:'è¿°ã¹ã‚‹', f:'ã®ã¹ã‚‹', r:'noberu', m:'to state / mention', pos:'verb (ru)' },
    { k:'è«–ã˜ã‚‹', f:'ã‚ã‚“ã˜ã‚‹', r:'ronjiru', m:'to argue / discuss', pos:'verb (ru)' },
    { k:'è€ƒå¯Ÿã™ã‚‹', f:'ã“ã†ã•ã¤ã™ã‚‹', r:'kousatsusuru', m:'to consider / examine', pos:'verb (suru)' },
    { k:'çµŒå–¶', f:'ã‘ã„ãˆã„', r:'keiei', m:'management / business operation', pos:'noun' },
    { k:'ç”£æ¥­', f:'ã•ã‚“ãŽã‚‡ã†', r:'sangyou', m:'industry', pos:'noun' },
    { k:'ä¼æ¥­', f:'ããŽã‚‡ã†', r:'kigyou', m:'company / enterprise', pos:'noun' },
    { k:'çµ„ç¹”', f:'ãã—ã', r:'soshiki', m:'organisation', pos:'noun' },
    { k:'ç«¶äº‰', f:'ãã‚‡ã†ãã†', r:'kyousou', m:'competition', pos:'noun' },
    { k:'å¸‚å ´', f:'ã—ã˜ã‚‡ã†', r:'shijou', m:'market', pos:'noun' },
    { k:'æ¶ˆè²»', f:'ã—ã‚‡ã†ã²', r:'shouhi', m:'consumption', pos:'noun' },
    { k:'ç”Ÿç”£', f:'ã›ã„ã•ã‚“', r:'seisan', m:'production', pos:'noun' },
    { k:'è¼¸å‡º', f:'ã‚†ã—ã‚…ã¤', r:'yushutsu', m:'export', pos:'noun' },
    { k:'è¼¸å…¥', f:'ã‚†ã«ã‚…ã†', r:'yunyuu', m:'import', pos:'noun' },
    { k:'è²¿æ˜“', f:'ã¼ã†ãˆã', r:'boueki', m:'trade', pos:'noun' },
    { k:'æŠ•è³‡', f:'ã¨ã†ã—', r:'toushi', m:'investment', pos:'noun' },
    { k:'åˆ©ç›Š', f:'ã‚Šãˆã', r:'rieki', m:'profit / benefit', pos:'noun' },
    { k:'æå¤±', f:'ãã‚“ã—ã¤', r:'sonshitsu', m:'loss', pos:'noun' },
    { k:'äºˆç®—', f:'ã‚ˆã•ã‚“', r:'yosan', m:'budget', pos:'noun' },
    { k:'è²¡æ”¿', f:'ã–ã„ã›ã„', r:'zaisei', m:'finance / fiscal policy', pos:'noun' },
    { k:'å€Ÿé‡‘', f:'ã—ã‚ƒã£ãã‚“', r:'shakkin', m:'debt', pos:'noun' },
    { k:'ç¯€ç´„', f:'ã›ã¤ã‚„ã', r:'setsuyaku', m:'economy / saving', pos:'noun' },
    { k:'è³‡æº', f:'ã—ã’ã‚“', r:'shigen', m:'resource', pos:'noun' },
    { k:'ã‚¨ãƒãƒ«ã‚®ãƒ¼', f:'ãˆã­ã‚‹ãŽãƒ¼', r:'enerugii', m:'energy', pos:'noun/loanword' },
    { k:'åŽŸå­åŠ›', f:'ã’ã‚“ã—ã‚Šã‚‡ã', r:'genshiryoku', m:'nuclear power', pos:'noun' },
    { k:'å†ç”Ÿå¯èƒ½', f:'ã•ã„ã›ã„ã‹ã®ã†', r:'saiseikanou', m:'renewable', pos:'adj (na)' },
    { k:'æ±šæŸ“', f:'ãŠã›ã‚“', r:'osen', m:'pollution / contamination', pos:'noun' },
    { k:'å»ƒæ£„ç‰©', f:'ã¯ã„ãã¶ã¤', r:'haikibutsu', m:'waste / refuse', pos:'noun' },
    { k:'ãƒªã‚µã‚¤ã‚¯ãƒ«', f:'ã‚Šã•ã„ãã‚‹', r:'risaikuru', m:'recycling', pos:'noun/loanword' },
    { k:'æ¸©æš–åŒ–', f:'ãŠã‚“ã ã‚“ã‹', r:'ondanka', m:'global warming', pos:'noun' },
    { k:'ç”Ÿæ…‹ç³»', f:'ã›ã„ãŸã„ã‘ã„', r:'seitaikei', m:'ecosystem', pos:'noun' },
    { k:'çµ¶æ»…', f:'ãœã¤ã‚ã¤', r:'zetsumetsu', m:'extinction', pos:'noun' },
    { k:'ä¿å­˜', f:'ã»ãžã‚“', r:'hozon', m:'preservation / conservation', pos:'noun' },
    { k:'æŒç¶šå¯èƒ½', f:'ã˜ãžãã‹ã®ã†', r:'jizokukanou', m:'sustainable', pos:'adj (na)' },
    { k:'ç™ºè¡¨ã™ã‚‹', f:'ã¯ã£ã´ã‚‡ã†ã™ã‚‹', r:'happyousuru', m:'to announce / present', pos:'verb (suru)' },
    { k:'å ±å‘Šã™ã‚‹', f:'ã»ã†ã“ãã™ã‚‹', r:'houkokusuru', m:'to report', pos:'verb (suru)' },
    { k:'è­°è«–ã™ã‚‹', f:'ãŽã‚ã‚“ã™ã‚‹', r:'gironsuru', m:'to discuss / debate', pos:'verb (suru)' },
    { k:'èª¿æŸ»ã™ã‚‹', f:'ã¡ã‚‡ã†ã•ã™ã‚‹', r:'chousasuru', m:'to investigate / survey', pos:'verb (suru)' },
    { k:'åŽé›†ã™ã‚‹', f:'ã—ã‚…ã†ã—ã‚…ã†ã™ã‚‹', r:'shuushuusuru', m:'to collect / gather', pos:'verb (suru)' },
    { k:'é…å¸ƒã™ã‚‹', f:'ã¯ã„ãµã™ã‚‹', r:'haifusuru', m:'to distribute', pos:'verb (suru)' },
    { k:'æŽ¨é€²ã™ã‚‹', f:'ã™ã„ã—ã‚“ã™ã‚‹', r:'suishinsuru', m:'to drive forward / promote', pos:'verb (suru)' },
    { k:'ç¶­æŒã™ã‚‹', f:'ã„ã˜ã™ã‚‹', r:'ijisuru', m:'to maintain', pos:'verb (suru)' },
    { k:'å»ƒæ­¢ã™ã‚‹', f:'ã¯ã„ã—ã™ã‚‹', r:'haishisuru', m:'to abolish', pos:'verb (suru)' },
    { k:'å°Žå…¥ã™ã‚‹', f:'ã©ã†ã«ã‚…ã†ã™ã‚‹', r:'dounyuusuru', m:'to introduce / adopt', pos:'verb (suru)' },
    { k:'é©ç”¨ã™ã‚‹', f:'ã¦ãã‚ˆã†ã™ã‚‹', r:'tekiyousuru', m:'to apply / implement', pos:'verb (suru)' },
    { k:'éµå®ˆã™ã‚‹', f:'ã˜ã‚…ã‚“ã—ã‚…ã™ã‚‹', r:'junshusuru', m:'to comply / observe', pos:'verb (suru)' },
    { k:'é•åã™ã‚‹', f:'ã„ã¯ã‚“ã™ã‚‹', r:'ihansuru', m:'to violate / breach', pos:'verb (suru)' },
    { k:'è­¦å‘Šã™ã‚‹', f:'ã‘ã„ã“ãã™ã‚‹', r:'keikokusuru', m:'to warn', pos:'verb (suru)' },
    { k:'è¦æ±‚ã™ã‚‹', f:'ã‚ˆã†ãã‚…ã†ã™ã‚‹', r:'youkyuusuru', m:'to demand / request', pos:'verb (suru)' },
    { k:'æ‹’å¦ã™ã‚‹', f:'ãã‚‡ã²ã™ã‚‹', r:'kyohisuru', m:'to refuse / reject', pos:'verb (suru)' },
    { k:'æ‰¿èªã™ã‚‹', f:'ã—ã‚‡ã†ã«ã‚“ã™ã‚‹', r:'shouninsuru', m:'to approve', pos:'verb (suru)' },
    { k:'å®Ÿæ–½ã™ã‚‹', f:'ã˜ã£ã—ã™ã‚‹', r:'jisshisuru', m:'to carry out / implement', pos:'verb (suru)' },
    { k:'æ™®åŠã™ã‚‹', f:'ãµãã‚…ã†ã™ã‚‹', r:'fukyuusuru', m:'to spread / become widespread', pos:'verb (suru)' },
    { k:'æ”¹å–„ã™ã‚‹', f:'ã‹ã„ãœã‚“ã™ã‚‹', r:'kaizensuru', m:'to improve', pos:'verb (suru)' }
  ],
  N2: [
    { k:'æ¦‚å¿µ', f:'ãŒã„ã­ã‚“', r:'gainen', m:'concept / notion', pos:'noun',
      origin:{ pictograph:'æ¦‚ shows a wooden measure being levelled off (æœ¨+æ—£) â€” an approximate, levelled understanding. å¿µ shows a heart (å¿ƒ) with now (ä»Š) â€” a thought present in the heart RIGHT NOW. A levelled thought in your heart = concept!', radicals:[{k:'æœ¨',m:'wood'},{k:'å¿ƒ',m:'heart'},{k:'ä»Š',m:'now'}], literal:'An approximate measure held in the heart = a concept ðŸ’­', hook:'GAI-NEN: "GUY + NEN" â€” that guy\'s idea, that notion in his head! ãŒã„ã­ã‚“!', related:['è¦³å¿µ','æ€æƒ³','ç†å¿µ'] }},
    { k:'ç¶­æŒ', f:'ã„ã˜', r:'iji', m:'to maintain', pos:'verb (suru)',
      origin:{ pictograph:'ç¶­ shows thread (ç³¸) tied to a bird (éš¹) â€” holding something in place with thread. æŒ shows a hand (æ‰Œ) holding something â€” gripping. Together: holding and gripping to keep something in place!', radicals:[{k:'ç³¸',m:'thread'},{k:'æ‰Œ',m:'hand'}], literal:'Thread + Grip = Holding something together so it doesn\'t fall apart ðŸ§µ', hook:'I-JI: "EEE-GEE" â€” hold on, MAINTAIN your composure! ã„ã˜!', related:['ä¿æŒ','ç¶™ç¶š','æŒç¶š'] }},
    { k:'é¡•è‘—', f:'ã‘ã‚“ã¡ã‚‡', r:'kencho', m:'conspicuous / remarkable', pos:'adj (na)',
      origin:{ pictograph:'é¡• shows a head (é ) being illuminated (æ˜¾) â€” something standing out visibly. è‘— shows grass (è‰¹) and something being written clearly (è€…) â€” remarkably clear like words on a page.', radicals:[{k:'é ',m:'head/page'},{k:'è‰¹',m:'grass/plant'},{k:'è€…',m:'person/thing'}], literal:'An illuminated head + written clearly = standing out remarkably! ðŸ’¡', hook:'KEN-CHO: "KEN saw CHO-mpsky and was REMARKABLY impressed!" ã‘ã‚“ã¡ã‚‡!', related:['æ˜Žç™½','é¡•åœ¨','è‘—å'] }},
    { k:'æŠŠæ¡', f:'ã¯ã‚ã', r:'haaku', m:'to grasp / understand', pos:'verb (suru)',
      origin:{ pictograph:'æŠŠ shows a hand (æ‰Œ) gripping something tightly (å·´ â€” a coiling snake shape). æ¡ shows a hand (æ‰Œ) squeezing (å±‹) â€” the act of tightly gripping. Double hand energy = to truly grasp!', radicals:[{k:'æ‰Œ',m:'hand (x2)'},{k:'å·´',m:'coil/grip'}], literal:'Two hand radicals = gripping tightly with both hands ðŸ¤', hook:'HA-AKU: "HA! I GRASP it now!" â€” that AHA moment of understanding! ã¯ã‚ã!', related:['ç†è§£','èªè­˜','æŽŒæ¡'] }},
    { k:'æ¦‚å¿µ', f:'ãŒã„ã­ã‚“', r:'gainen', m:'concept / notion', pos:'noun' },
    { k:'ç¶­æŒ', f:'ã„ã˜', r:'iji', m:'maintenance / upkeep', pos:'noun' },
    { k:'é¡•è‘—', f:'ã‘ã‚“ã¡ã‚‡', r:'kencho', m:'conspicuous / remarkable', pos:'adj (na)' },
    { k:'æŠŠæ¡', f:'ã¯ã‚ã', r:'haaku', m:'grasp / comprehension', pos:'noun' },
    { k:'ä¸»å¼µ', f:'ã—ã‚…ã¡ã‚‡ã†', r:'shuchou', m:'assertion / claim', pos:'noun' },
    { k:'æ›–æ˜§', f:'ã‚ã„ã¾ã„', r:'aimai', m:'vague / ambiguous', pos:'adj (na)' },
    { k:'æ ¹æ‹ ', f:'ã“ã‚“ãã‚‡', r:'konkyo', m:'basis / grounds', pos:'noun' },
    { k:'æ„è­˜', f:'ã„ã—ã', r:'ishiki', m:'consciousness / awareness', pos:'noun' },
    { k:'å‚¾å‘', f:'ã‘ã„ã“ã†', r:'keikou', m:'tendency / trend', pos:'noun' },
    { k:'å¦¥å”', f:'ã ãã‚‡ã†', r:'dakyou', m:'compromise', pos:'noun' },
    { k:'å…‹æœ', f:'ã“ããµã', r:'kokufuku', m:'overcoming', pos:'noun' },
    { k:'è²¢çŒ®', f:'ã“ã†ã‘ã‚“', r:'kouken', m:'contribution', pos:'noun' },
    { k:'æŠ‘åˆ¶', f:'ã‚ˆãã›ã„', r:'yokusei', m:'suppression / restraint', pos:'noun' },
    { k:'ä¿ƒé€²', f:'ããã—ã‚“', r:'sokushin', m:'promotion / facilitation', pos:'noun' },
    { k:'æ§‹ç¯‰', f:'ã“ã†ã¡ã', r:'kouchiku', m:'construction / building', pos:'noun' },
    { k:'æ•´å‚™', f:'ã›ã„ã³', r:'seibi', m:'maintenance / preparation', pos:'noun' },
    { k:'å¼·åŒ–', f:'ãã‚‡ã†ã‹', r:'kyouka', m:'strengthening', pos:'noun' },
    { k:'ç·©å’Œ', f:'ã‹ã‚“ã‚', r:'kanwa', m:'relaxation / easing', pos:'noun' },
    { k:'è¦åˆ¶', f:'ãã›ã„', r:'kisei', m:'regulation', pos:'noun' },
    { k:'æ¨©é™', f:'ã‘ã‚“ã’ã‚“', r:'kengen', m:'authority / power', pos:'noun' },
    { k:'å€«ç†', f:'ã‚Šã‚“ã‚Š', r:'rinri', m:'ethics / morals', pos:'noun' },
    { k:'é“å¾³', f:'ã©ã†ã¨ã', r:'doutoku', m:'morality', pos:'noun' },
    { k:'åè¦‹', f:'ã¸ã‚“ã‘ã‚“', r:'henken', m:'prejudice / bias', pos:'noun' },
    { k:'å·®åˆ¥', f:'ã•ã¹ã¤', r:'sabetsu', m:'discrimination', pos:'noun' },
    { k:'å¹³ç­‰', f:'ã³ã‚‡ã†ã©ã†', r:'byoudou', m:'equality', pos:'noun' },
    { k:'è‡ªç”±', f:'ã˜ã‚†ã†', r:'jiyuu', m:'freedom', pos:'noun' },
    { k:'æ¨©åˆ©', f:'ã‘ã‚“ã‚Š', r:'kenri', m:'rights', pos:'noun' },
    { k:'ç¾©å‹™', f:'ãŽã‚€', r:'gimu', m:'duty / obligation', pos:'noun' },
    { k:'å¥‘ç´„', f:'ã‘ã„ã‚„ã', r:'keiyaku', m:'contract', pos:'noun' },
    { k:'äº¤æ¸‰', f:'ã“ã†ã—ã‚‡ã†', r:'koushou', m:'negotiation', pos:'noun' },
    { k:'åˆæ„', f:'ã”ã†ã„', r:'goui', m:'agreement / consensus', pos:'noun' },
    { k:'çŸ›ç›¾', f:'ã‚€ã˜ã‚…ã‚“', r:'mujun', m:'contradiction', pos:'noun' },
    { k:'é€†èª¬', f:'ãŽã‚ƒãã›ã¤', r:'gyakusetsu', m:'paradox', pos:'noun' },
    { k:'è«–ç†', f:'ã‚ã‚“ã‚Š', r:'ronri', m:'logic', pos:'noun' },
    { k:'è¨¼æ‹ ', f:'ã—ã‚‡ã†ã“', r:'shouko', m:'evidence / proof', pos:'noun' },
    { k:'äº‹å®Ÿ', f:'ã˜ã˜ã¤', r:'jijitsu', m:'fact', pos:'noun' },
    { k:'ç¾è±¡', f:'ã’ã‚“ã—ã‚‡ã†', r:'genshou', m:'phenomenon', pos:'noun' },
    { k:'éŽç¨‹', f:'ã‹ã¦ã„', r:'katei', m:'process', pos:'noun' },
    { k:'ä»®èª¬', f:'ã‹ã›ã¤', r:'kasetsu', m:'hypothesis', pos:'noun' },
    { k:'å®Ÿé¨“', f:'ã˜ã£ã‘ã‚“', r:'jikken', m:'experiment', pos:'noun' },
    { k:'è¦³å¯Ÿ', f:'ã‹ã‚“ã•ã¤', r:'kansatsu', m:'observation', pos:'noun' },
    { k:'æŽ¨è«–', f:'ã™ã„ã‚ã‚“', r:'suiron', m:'inference', pos:'noun' },
    { k:'ä¾‹å¤–', f:'ã‚Œã„ãŒã„', r:'reigai', m:'exception', pos:'noun' },
    { k:'å‰æ', f:'ãœã‚“ã¦ã„', r:'zentei', m:'premise', pos:'noun' },
    { k:'æœ¬è³ª', f:'ã»ã‚“ã—ã¤', r:'honshitsu', m:'essence / nature', pos:'noun' },
    { k:'å´é¢', f:'ããã‚ã‚“', r:'sokumen', m:'aspect / side', pos:'noun' },
    { k:'è¦‹è§£', f:'ã‘ã‚“ã‹ã„', r:'kenkai', m:'view / opinion', pos:'noun' },
    { k:'æ‰¹è©•', f:'ã²ã²ã‚‡ã†', r:'hihyou', m:'critique / review', pos:'noun' },
    { k:'çš®è‚‰', f:'ã²ã«ã', r:'hiniku', m:'irony / sarcasm', pos:'noun' },
    { k:'æ¯”å–©', f:'ã²ã‚†', r:'hiyu', m:'metaphor', pos:'noun' },
    { k:'æ¦‚æ‹¬', f:'ãŒã„ã‹ã¤', r:'gaikatsu', m:'generalisation', pos:'noun' },
    { k:'ç‰¹ä¾‹', f:'ã¨ãã‚Œã„', r:'tokurei', m:'special case', pos:'noun' },
    { k:'æ–½ç­–', f:'ã—ã•ã', r:'shisaku', m:'policy / measure', pos:'noun' },
    { k:'ç­–å®š', f:'ã•ãã¦ã„', r:'sakutei', m:'formulation of policy', pos:'noun' },
    { k:'å®Ÿæ–½', f:'ã˜ã£ã—', r:'jisshi', m:'implementation', pos:'noun' },
    { k:'è©•ä¾¡', f:'ã²ã‚‡ã†ã‹', r:'hyouka', m:'evaluation', pos:'noun' },
    { k:'åŸºç›¤', f:'ãã°ã‚“', r:'kiban', m:'foundation / base', pos:'noun' },
    { k:'è¦å› ', f:'ã‚ˆã†ã„ã‚“', r:'youin', m:'factor / cause', pos:'noun' },
    { k:'èƒŒæ™¯', f:'ã¯ã„ã‘ã„', r:'haikei', m:'background / context', pos:'noun' },
    { k:'å…¨ä½“', f:'ãœã‚“ãŸã„', r:'zentai', m:'whole / entirety', pos:'noun' },
    { k:'å€‹åˆ¥', f:'ã“ã¹ã¤', r:'kobetsu', m:'individual / particular', pos:'adj (na)' },
    { k:'ç›¸äº’', f:'ãã†ã”', r:'sougo', m:'mutual / reciprocal', pos:'adj (na)' },
    { k:'å®¢è¦³çš„', f:'ãã‚ƒã£ã‹ã‚“ã¦ã', r:'kyakkanteki', m:'objective', pos:'adj (na)' },
    { k:'ä¸»è¦³çš„', f:'ã—ã‚…ã‹ã‚“ã¦ã', r:'shuukanteki', m:'subjective', pos:'adj (na)' },
    { k:'æ™®éçš„', f:'ãµã¸ã‚“ã¦ã', r:'fuhenteki', m:'universal', pos:'adj (na)' },
    { k:'å…·ä½“çš„', f:'ããŸã„ã¦ã', r:'gutaiteki', m:'concrete / specific', pos:'adj (na)' },
    { k:'æŠ½è±¡çš„', f:'ã¡ã‚…ã†ã—ã‚‡ã†ã¦ã', r:'chuushouteki', m:'abstract', pos:'adj (na)' },
    { k:'ä½“ç³»çš„', f:'ãŸã„ã‘ã„ã¦ã', r:'taikeiteki', m:'systematic', pos:'adj (na)' },
    { k:'åŠ¹æžœçš„', f:'ã“ã†ã‹ã¦ã', r:'koukateki', m:'effective', pos:'adj (na)' },
    { k:'åˆç†çš„', f:'ã”ã†ã‚Šã¦ã', r:'gouriteki', m:'rational', pos:'adj (na)' },
    { k:'æ‰¹åˆ¤çš„', f:'ã²ã¯ã‚“ã¦ã', r:'hihanteki', m:'critical', pos:'adj (na)' },
    { k:'å‰µé€ çš„', f:'ãã†ãžã†ã¦ã', r:'souzouteki', m:'creative', pos:'adj (na)' },
    { k:'å¸°ç´', f:'ãã®ã†', r:'kinou', m:'induction (logic)', pos:'noun' },
    { k:'æ¼”ç¹¹', f:'ãˆã‚“ãˆã', r:'en\'eki', m:'deduction (logic)', pos:'noun' },
    { k:'å¼è¨¼æ³•', f:'ã¹ã‚“ã—ã‚‡ã†ã»ã†', r:'benshouhou', m:'dialectics', pos:'noun' },
    { k:'å®Ÿå­˜ä¸»ç¾©', f:'ã˜ã¤ãžã‚“ã—ã‚…ãŽ', r:'jitsuzonnshugi', m:'existentialism', pos:'noun' },
    { k:'åŠŸåˆ©ä¸»ç¾©', f:'ã“ã†ã‚Šã—ã‚…ãŽ', r:'kourishugi', m:'utilitarianism', pos:'noun' },
    { k:'å½¢è€Œä¸Šå­¦', f:'ã‘ã„ã˜ã˜ã‚‡ã†ãŒã', r:'keijijougaku', m:'metaphysics', pos:'noun' },
    { k:'èªè­˜è«–', f:'ã«ã‚“ã—ãã‚ã‚“', r:'ninshikiron', m:'epistemology', pos:'noun' },
    { k:'ç¾è±¡å­¦', f:'ã’ã‚“ã—ã‚‡ã†ãŒã', r:'genshougaku', m:'phenomenology', pos:'noun' },
    { k:'å¼è­·', f:'ã¹ã‚“ã”', r:'benko', m:'defence / advocacy', pos:'noun' },
    { k:'å‘Šè¨´', f:'ã“ãã', r:'kokuso', m:'lawsuit / accusation', pos:'noun' },
    { k:'åˆ¤æ±º', f:'ã¯ã‚“ã‘ã¤', r:'hanketsu', m:'verdict / judgement', pos:'noun' },
    { k:'è£åˆ¤', f:'ã•ã„ã°ã‚“', r:'saiban', m:'trial / court case', pos:'noun' },
    { k:'ç«‹æ³•', f:'ã‚Šã£ã½ã†', r:'rippou', m:'legislation', pos:'noun' },
    { k:'è¡Œæ”¿', f:'ãŽã‚‡ã†ã›ã„', r:'gyousei', m:'administration', pos:'noun' },
    { k:'å¸æ³•', f:'ã—ã»ã†', r:'shihou', m:'judiciary', pos:'noun' },
    { k:'è­°ä¼š', f:'ãŽã‹ã„', r:'gikai', m:'parliament / assembly', pos:'noun' },
    { k:'æ°‘ä¸»ä¸»ç¾©', f:'ã¿ã‚“ã—ã‚…ã—ã‚…ãŽ', r:'minshu shugi', m:'democracy', pos:'noun' },
    { k:'å…¨ä½“ä¸»ç¾©', f:'ãœã‚“ãŸã„ã—ã‚…ãŽ', r:'zentai shugi', m:'totalitarianism', pos:'noun' },
    { k:'è³‡æœ¬ä¸»ç¾©', f:'ã—ã»ã‚“ã—ã‚…ãŽ', r:'shihon shugi', m:'capitalism', pos:'noun' },
    { k:'ç¤¾ä¼šä¸»ç¾©', f:'ã—ã‚ƒã‹ã„ã—ã‚…ãŽ', r:'shakai shugi', m:'socialism', pos:'noun' },
    { k:'å›½å®¶', f:'ã“ã£ã‹', r:'kokka', m:'nation / state', pos:'noun' },
    { k:'ä¸»æ¨©', f:'ã—ã‚…ã‘ã‚“', r:'shuken', m:'sovereignty', pos:'noun' },
    { k:'å¤–äº¤', f:'ãŒã„ã“ã†', r:'gaikou', m:'diplomacy', pos:'noun' },
    { k:'æ¡ç´„', f:'ã˜ã‚‡ã†ã‚„ã', r:'jouyaku', m:'treaty', pos:'noun' },
    { k:'åˆ¶è£', f:'ã›ã„ã•ã„', r:'seisai', m:'sanction', pos:'noun' },
    { k:'è¦‡æ¨©', f:'ã¯ã‘ã‚“', r:'haken', m:'hegemony', pos:'noun' },
    { k:'ç´›äº‰', f:'ãµã‚“ãã†', r:'funsou', m:'conflict / dispute', pos:'noun' },
    { k:'åœæˆ¦', f:'ã¦ã„ã›ã‚“', r:'teisen', m:'ceasefire', pos:'noun' },
    { k:'é›£æ°‘', f:'ãªã‚“ã¿ã‚“', r:'nanmin', m:'refugee', pos:'noun' },
    { k:'ç§»æ°‘', f:'ã„ã¿ã‚“', r:'imin', m:'immigrant', pos:'noun' },
    { k:'æ ¼å·®', f:'ã‹ãã•', r:'kakusa', m:'disparity / gap', pos:'noun' },
    { k:'è²§å›°', f:'ã²ã‚“ã“ã‚“', r:'hinkon', m:'poverty', pos:'noun' },
    { k:'ä¸å¹³ç­‰', f:'ãµã³ã‚‡ã†ã©ã†', r:'fubyoudou', m:'inequality', pos:'noun' },
    { k:'ç–Žå¤–', f:'ããŒã„', r:'sogai', m:'alienation', pos:'noun' },
    { k:'æŠ‘åœ§', f:'ã‚ˆãã‚ã¤', r:'yokuatsu', m:'oppression', pos:'noun' },
    { k:'è§£æ”¾', f:'ã‹ã„ã»ã†', r:'kaihou', m:'liberation / release', pos:'noun' },
    { k:'é€£å¸¯', f:'ã‚Œã‚“ãŸã„', r:'rentai', m:'solidarity', pos:'noun' },
    { k:'å…±æ„Ÿ', f:'ãã‚‡ã†ã‹ã‚“', r:'kyoukan', m:'empathy', pos:'noun' },
    { k:'å¯›å®¹', f:'ã‹ã‚“ã‚ˆã†', r:'kanyou', m:'tolerance', pos:'noun' },
    { k:'å¤šæ§˜æ€§', f:'ãŸã‚ˆã†ã›ã„', r:'tayousei', m:'diversity', pos:'noun' },
    { k:'åŒ…æ‹¬çš„', f:'ã»ã†ã‹ã¤ã¦ã', r:'houkatsu teki', m:'inclusive / comprehensive', pos:'adj (na)' },
    { k:'æŒç¶šçš„', f:'ã˜ãžãã¦ã', r:'jizoku teki', m:'sustainable / lasting', pos:'adj (na)' },
    { k:'é©æ–°çš„', f:'ã‹ãã—ã‚“ã¦ã', r:'kakushin teki', m:'innovative / progressive', pos:'adj (na)' },
    { k:'ä¿å®ˆçš„', f:'ã»ã—ã‚…ã¦ã', r:'hoshu teki', m:'conservative', pos:'adj (na)' },
    { k:'é€²æ­©çš„', f:'ã—ã‚“ã½ã¦ã', r:'shinpo teki', m:'progressive', pos:'adj (na)' },
    { k:'æ‰¹åˆ¤çš„', f:'ã²ã¯ã‚“ã¦ã', r:'hihan teki', m:'critical', pos:'adj (na)' },
    { k:'åˆ†æžçš„', f:'ã¶ã‚“ã›ãã¦ã', r:'bunseki teki', m:'analytical', pos:'adj (na)' },
    { k:'åŒ…æ‹¬ã™ã‚‹', f:'ã»ã†ã‹ã¤ã™ã‚‹', r:'houkatsusuru', m:'to encompass / include', pos:'verb (suru)' },
    { k:'æ´¾ç”Ÿã™ã‚‹', f:'ã¯ã›ã„ã™ã‚‹', r:'haseisuru', m:'to derive / stem from', pos:'verb (suru)' },
    { k:'æŠ½å‡ºã™ã‚‹', f:'ã¡ã‚…ã†ã—ã‚…ã¤ã™ã‚‹', r:'chuushutsusuru', m:'to extract', pos:'verb (suru)' }
  ],
  N1: [
    { k:'é€¡å·¡', f:'ã—ã‚…ã‚“ã˜ã‚…ã‚“', r:'shunjun', m:'hesitation / wavering', pos:'noun',
      origin:{ pictograph:'é€¡ shows movement (è¾¶) combined with retreating (å¤‹) â€” moving but pulling back. å·¡ shows movement going around (è¾¶+å·›) â€” circling without committing. Pure hesitation in kanji form!', radicals:[{k:'è¾¶',m:'movement'},{k:'å¤‹',m:'retreat'}], literal:'Moving forward + retreating + circling = going nowhere from hesitation! ðŸŒ€', hook:'SHUN-JUN: "SHOULD I? NO! SHOULD I?" â€” the eternal internal debate of hesitation! ã—ã‚…ã‚“ã˜ã‚…ã‚“!', related:['èºŠèº‡','è¿·ã„','å„ªæŸ”ä¸æ–­'] }},
    { k:'çŸ›ç›¾', f:'ã‚€ã˜ã‚…ã‚“', r:'mujun', m:'contradiction', pos:'noun',
      origin:{ pictograph:'This comes from a famous Chinese fable! A salesman boasted his çŸ› (spear) could pierce anything, and his ç›¾ (shield) could block anything. Someone asked: "What happens if your spear hits your shield?" â€” CONTRADICTION born!', radicals:[{k:'çŸ›',m:'spear'},{k:'ç›¾',m:'shield'}], literal:'The ultimate spear vs the ultimate shield â€” they cannot both be true âš”ï¸ðŸ›¡ï¸', hook:'MU-JUN: "MOO! JUNE is contradicting herself again!" ã‚€ã˜ã‚…ã‚“! Think of the spear-shield paradox!', related:['é€†èª¬','ã‚¸ãƒ¬ãƒ³ãƒž','ãƒ‘ãƒ©ãƒ‰ãƒƒã‚¯ã‚¹'] }},
    { k:'å¹½çŽ„', f:'ã‚†ã†ã’ã‚“', r:'yuugen', m:'subtle / profound (aesthetic)', pos:'adj (na)',
      origin:{ pictograph:'å¹½ shows a mountain (å±±) with hidden, dimly-lit recesses (å¹ºå¹º) â€” the mysterious dark corners. çŽ„ shows a twisted thread going dark â€” deep, mysterious black. Together: the profound beauty found in mystery and shadow!', radicals:[{k:'å±±',m:'mountain'},{k:'å¹º',m:'small/dim'},{k:'çŽ„',m:'dark/mysterious'}], literal:'Hidden mountain shadows + deep darkness = profound mysterious beauty ðŸŒ™', hook:'YUU-GEN: "YOU" find "GEN"-uine beauty in the unseen â€” that\'s å¹½çŽ„, the Japanese art of finding magic in subtlety! ã‚†ã†ã’ã‚“!', related:['ä¾˜ã³å¯‚ã³','ã‚‚ã®ã®ã‚ã‚ã‚Œ','é›…'] }},
    { k:'å¿–åº¦', f:'ãã‚“ãŸã', r:'sontaku', m:'reading the air / second-guessing superiors', pos:'noun',
      origin:{ pictograph:'å¿– shows the heart (å¿ƒ) + measuring (å¯¸) â€” measuring with your heart, intuiting what someone feels. åº¦ shows a hand measuring under a roof â€” calculating dimensions. Together: carefully measuring what someone feels without them saying it!', radicals:[{k:'å¿ƒ',m:'heart'},{k:'å¯¸',m:'measure'},{k:'åº¦',m:'degree'}], literal:'Heart-measuring + calculating = figuring out what your boss wants before they say it! ðŸŽ¯', hook:'SON-TAKU: "SON, TAKE a guess at what I want!" â€” reading between the lines in Japanese workplace culture! ãã‚“ãŸã!', related:['ç©ºæ°—ã‚’èª­ã‚€','å¿–åº¦ã™ã‚‹','é…æ…®'] }},
    { k:'å¤‰é·', f:'ã¸ã‚“ã›ã‚“', r:'hensen', m:'transition / change over time', pos:'noun',
      origin:{ pictograph:'å¤‰ shows a thread being transformed (å¤‰åŒ–) â€” something changing form. é· shows movement (è¾¶) + a high place (è¥¿+å¤§) â€” moving from one high point to another over time. The journey of transformation!', radicals:[{k:'è¾¶',m:'movement'},{k:'å¤‰',m:'change'}], literal:'Change + Moving from peak to peak over time = historical transition ðŸ“œ', hook:'HEN-SEN: "HEN" like CHANGE (å¤‰) and "SEN" like THOUSAND years â€” change over a thousand years! ã¸ã‚“ã›ã‚“!', related:['å¤‰åŒ–','æŽ¨ç§»','ç§»è¡Œ'] }},
    { k:'é€¡å·¡', f:'ã—ã‚…ã‚“ã˜ã‚…ã‚“', r:'shunjun', m:'hesitation / wavering', pos:'noun' },
    { k:'çŸ›ç›¾', f:'ã‚€ã˜ã‚…ã‚“', r:'mujun', m:'contradiction', pos:'noun' },
    { k:'å¹½çŽ„', f:'ã‚†ã†ã’ã‚“', r:'yuugen', m:'subtle profound beauty', pos:'adj (na)' },
    { k:'å¿–åº¦', f:'ãã‚“ãŸã', r:'sontaku', m:'reading the air', pos:'noun' },
    { k:'å¤‰é·', f:'ã¸ã‚“ã›ã‚“', r:'hensen', m:'transition / historical change', pos:'noun' },
    { k:'åˆ¹é‚£', f:'ã›ã¤ãª', r:'setsuna', m:'a moment / instant', pos:'noun' },
    { k:'è‘›è—¤', f:'ã‹ã£ã¨ã†', r:'kattou', m:'inner conflict', pos:'noun' },
    { k:'è¹‰è·Ž', f:'ã•ãŸ', r:'sata', m:'wasted time / stagnation', pos:'noun' },
    { k:'æ…Ÿå“­', f:'ã©ã†ã“ã', r:'doukoku', m:'wailing grief', pos:'noun' },
    { k:'è¬™è™š', f:'ã‘ã‚“ãã‚‡', r:'kenkyo', m:'humble / modest', pos:'adj (na)' },
    { k:'ç‘£æœ«', f:'ã•ã¾ã¤', r:'samatsu', m:'trivial / trifling', pos:'adj (na)' },
    { k:'é‚‚é€…', f:'ã‹ã„ã“ã†', r:'kaikou', m:'chance encounter', pos:'noun' },
    { k:'æ…§çœ¼', f:'ã‘ã„ãŒã‚“', r:'keigan', m:'discerning eye / insight', pos:'noun' },
    { k:'æžæ†‚', f:'ãã‚†ã†', r:'kiyuu', m:'needless worry', pos:'noun' },
    { k:'ææƒš', f:'ã“ã†ã“ã¤', r:'koukotsu', m:'ecstasy / trance', pos:'noun' },
    { k:'å‰›æ¯…', f:'ã”ã†ã', r:'gouki', m:'fortitude / strong will', pos:'adj (na)' },
    { k:'æ…ˆæ‚²', f:'ã˜ã²', r:'jihi', m:'compassion / mercy', pos:'noun' },
    { k:'æ£æ„', f:'ã—ã„', r:'shii', m:'arbitrariness', pos:'noun' },
    { k:'è·‹æ‰ˆ', f:'ã°ã£ã“', r:'bakko', m:'rampant / domineering', pos:'noun' },
    { k:'ç€Ÿæ´’', f:'ã—ã‚‡ã†ã—ã‚ƒ', r:'shousha', m:'elegant / refined', pos:'adj (na)' },
    { k:'æ–Ÿé…Œ', f:'ã—ã‚“ã—ã‚ƒã', r:'shinshaku', m:'consideration / discretion', pos:'noun' },
    { k:'æ¬£å–œ', f:'ãã‚“ã', r:'kinki', m:'great joy / delight', pos:'noun' },
    { k:'å—šå’½', f:'ãŠãˆã¤', r:'oetsu', m:'sobbing / choking with tears', pos:'noun' },
    { k:'ä¸€çž¥', f:'ã„ã¡ã¹ã¤', r:'ichibetsu', m:'a glance / quick look', pos:'noun' },
    { k:'ä¿¯çž°', f:'ãµã‹ã‚“', r:'fukan', m:'bird\'s eye view', pos:'noun' },
    { k:'æ†‚é¬±', f:'ã‚†ã†ã†ã¤', r:'yuuutsu', m:'melancholy / depression', pos:'adj (na)' },
    { k:'æœ¦æœ§', f:'ã‚‚ã†ã‚ã†', r:'mourou', m:'hazy / dim', pos:'adj (na)' },
    { k:'æ¬æ·¡', f:'ã¦ã‚“ãŸã‚“', r:'tentan', m:'calm / indifferent', pos:'adj (na)' },
    { k:'æ¾„æ¾ˆ', f:'ã¡ã‚‡ã†ã¦ã¤', r:'choutetsu', m:'clear / transparent', pos:'adj (na)' },
    { k:'æ°¾æ¿«', f:'ã¯ã‚“ã‚‰ã‚“', r:'hanran', m:'flood / inundation', pos:'noun' },
    { k:'ç¨€è–„', f:'ãã¯ã', r:'kihaku', m:'thin / dilute / sparse', pos:'adj (na)' },
    { k:'å‡„æƒ¨', f:'ã›ã„ã•ã‚“', r:'seisan', m:'gruesome / horrific', pos:'adj (na)' },
    { k:'é€¸è„±', f:'ã„ã¤ã ã¤', r:'itsudatsu', m:'deviation / departure', pos:'noun' },
    { k:'å¿Œé¿', f:'ãã²', r:'kihi', m:'avoidance / aversion', pos:'noun' },
    { k:'ç¿»å¼„', f:'ã»ã‚“ã‚ã†', r:'honrou', m:'to toss about / play with', pos:'noun' },
    { k:'æ‘©æ“¦', f:'ã¾ã•ã¤', r:'masatsu', m:'friction / conflict', pos:'noun' },
    { k:'è»‹è½¢', f:'ã‚ã¤ã‚Œã', r:'atsuretsu', m:'friction / discord', pos:'noun' },
    { k:'å‡Œé§•', f:'ã‚Šã‚‡ã†ãŒ', r:'ryouga', m:'to surpass / excel', pos:'noun' },
    { k:'è’™æ˜§', f:'ã‚‚ã†ã¾ã„', r:'moumai', m:'ignorant / unenlightened', pos:'adj (na)' },
    { k:'éš˜è·¯', f:'ã‚ã„ã‚', r:'airo', m:'bottleneck / narrow path', pos:'noun' },
    { k:'æš«å®š', f:'ã–ã‚“ã¦ã„', r:'zantei', m:'provisional / temporary', pos:'adj (na)' },
    { k:'é‘‘ã¿ã‚‹', f:'ã‹ã‚“ãŒã¿ã‚‹', r:'kangamiru', m:'to consider / take into account', pos:'verb (ru)' },
    { k:'è¸ã¾ãˆã‚‹', f:'ãµã¾ãˆã‚‹', r:'fumaeru', m:'to be based on / step on', pos:'verb (ru)' },
    { k:'é†¸æˆã™ã‚‹', f:'ã˜ã‚‡ã†ã›ã„ã™ã‚‹', r:'jouseisuru', m:'to foster / cultivate', pos:'verb (suru)' },
    { k:'å¸°çµã™ã‚‹', f:'ãã‘ã¤ã™ã‚‹', r:'kiketsusuru', m:'to result in / conclude', pos:'verb (suru)' },
    { k:'æ•·è¡ã™ã‚‹', f:'ãµãˆã‚“ã™ã‚‹', r:'fuensuru', m:'to elaborate / expand on', pos:'verb (suru)' },
    { k:'æ¨è±¡ã™ã‚‹', f:'ã—ã‚ƒã—ã‚‡ã†ã™ã‚‹', r:'shashousuru', m:'to abstract away / ignore detail', pos:'verb (suru)' },
    { k:'å³»åˆ¥ã™ã‚‹', f:'ã—ã‚…ã‚“ã¹ã¤ã™ã‚‹', r:'shunbetsusuru', m:'to sharply distinguish', pos:'verb (suru)' },
    { k:'æƒ¹èµ·ã™ã‚‹', f:'ã˜ã‚ƒã£ãã™ã‚‹', r:'jakkisuru', m:'to cause / trigger', pos:'verb (suru)' },
    { k:'æŽªå®šã™ã‚‹', f:'ãã¦ã„ã™ã‚‹', r:'soteisuru', m:'to posit / assume', pos:'verb (suru)' },
    { k:'å¯¡é»™', f:'ã‹ã‚‚ã', r:'kamoku', m:'taciturn / reticent', pos:'adj (na)' },
    { k:'æ‡ç–‘', f:'ã‹ã„ãŽ', r:'kaigi', m:'scepticism', pos:'noun' },
    { k:'è«¦è¦³', f:'ã¦ã„ã‹ã‚“', r:'teikan', m:'resigned acceptance', pos:'noun' },
    { k:'ç•æ•¬', f:'ã„ã‘ã„', r:'ikei', m:'awe / reverence', pos:'noun' },
    { k:'æ©æµ', f:'ãŠã‚“ã‘ã„', r:'onkei', m:'benefit / blessing', pos:'noun' },
    { k:'å®¿å‘½', f:'ã—ã‚…ãã‚ã„', r:'shukumei', m:'fate / destiny', pos:'noun' },
    { k:'å› æžœ', f:'ã„ã‚“ãŒ', r:'inga', m:'cause and effect', pos:'noun' },
    { k:'è§£è„±', f:'ã’ã ã¤', r:'gedatsu', m:'liberation / enlightenment', pos:'noun' },
    { k:'ç„¡å¸¸', f:'ã‚€ã˜ã‚‡ã†', r:'mujou', m:'impermanence', pos:'noun' },
    { k:'æ¶…æ§ƒ', f:'ã­ã¯ã‚“', r:'nehan', m:'nirvana', pos:'noun' },
    { k:'å­¤ç‹¬', f:'ã“ã©ã', r:'kodoku', m:'solitude / loneliness', pos:'noun' },
    { k:'éš é', f:'ã„ã‚“ã¨ã‚“', r:'inton', m:'seclusion / hermitage', pos:'noun' },
    { k:'æ¼‚æ³Š', f:'ã²ã‚‡ã†ã¯ã', r:'hyouhaku', m:'wandering / vagrancy', pos:'noun' },
    { k:'éƒ·æ„', f:'ãã‚‡ã†ã—ã‚…ã†', r:'kyoushuu', m:'nostalgia / homesickness', pos:'noun' },
    { k:'å›žæƒ³', f:'ã‹ã„ãã†', r:'kaisou', m:'recollection / reminiscence', pos:'noun' },
    { k:'ä½™éŸ»', f:'ã‚ˆã„ã‚“', r:'yoin', m:'lingering resonance / aftertaste', pos:'noun' },
    { k:'é™°å½±', f:'ã„ã‚“ãˆã„', r:'in\'ei', m:'shadow / nuance', pos:'noun' },
    { k:'å¾®å¦™', f:'ã³ã¿ã‚‡ã†', r:'bimyou', m:'subtle / delicate', pos:'adj (na)' },
    { k:'ç¹Šç´°', f:'ã›ã‚“ã•ã„', r:'sensai', m:'delicate / sensitive', pos:'adj (na)' },
    { k:'å¥¥æ·±ã„', f:'ãŠããµã‹ã„', r:'okufukai', m:'profound / deep', pos:'adj (i)' },
    { k:'ã¯ã‹ãªã„', f:'ã¯ã‹ãªã„', r:'hakanai', m:'fleeting / transient', pos:'adj (i)' },
    { k:'å„šã„', f:'ã¯ã‹ãªã„', r:'hakanai', m:'ephemeral / fragile', pos:'adj (i)' },
    { k:'ä½‡ã‚€', f:'ãŸãŸãšã‚€', r:'tatazumu', m:'to stand still / linger', pos:'verb (u)' },
    { k:'æ¼‚ã†', f:'ãŸã ã‚ˆã†', r:'tadayou', m:'to drift / float', pos:'verb (u)' },
    { k:'æ»²ã‚€', f:'ã«ã˜ã‚€', r:'nijimu', m:'to bleed / seep / blur', pos:'verb (u)' },
    { k:'æºã‚‰ã', f:'ã‚†ã‚‰ã', r:'yuragu', m:'to waver / fluctuate', pos:'verb (u)' },
    { k:'èŒãˆã‚‹', f:'ã‚‚ãˆã‚‹', r:'moeru', m:'to bud / sprout / (anime: to feel moe)', pos:'verb (ru)' },
    { k:'æ‚¼ã‚€', f:'ã„ãŸã‚€', r:'itamu', m:'to mourn / grieve', pos:'verb (u)' },
    { k:'æ…ˆã—ã‚€', f:'ã„ã¤ãã—ã‚€', r:'itsukushimu', m:'to cherish / love tenderly', pos:'verb (u)' },
    { k:'è¦‹åšã™', f:'ã¿ãªã™', r:'minasu', m:'to regard as / consider', pos:'verb (u)' },
    { k:'é‘‘ã¿ã‚‹', f:'ã‹ã‚“ãŒã¿ã‚‹', r:'kangamiru', m:'to consider / take into account', pos:'verb (ru)' },
    { k:'è¸ã¾ãˆã‚‹', f:'ãµã¾ãˆã‚‹', r:'fumaeru', m:'to be based on', pos:'verb (ru)' },
    { k:'é†¸ã—å‡ºã™', f:'ã‹ã‚‚ã—ã ã™', r:'kamoshidasu', m:'to create / engender (atmosphere)', pos:'verb (u)' },
    { k:'å¼•ãèµ·ã“ã™', f:'ã²ããŠã“ã™', r:'hikiokosuru', m:'to cause / trigger', pos:'verb (u)' },
    { k:'ä»˜éšã™ã‚‹', f:'ãµãšã„ã™ã‚‹', r:'fuzuisuru', m:'to accompany / be attendant', pos:'verb (suru)' },
    { k:'å¸°çµã™ã‚‹', f:'ãã‘ã¤ã™ã‚‹', r:'kiketsusuru', m:'to result in', pos:'verb (suru)' },
    { k:'å†…åŒ…ã™ã‚‹', f:'ãªã„ã»ã†ã™ã‚‹', r:'naihousuru', m:'to connote / contain implicitly', pos:'verb (suru)' },
    { k:'æ•·è¡ã™ã‚‹', f:'ãµãˆã‚“ã™ã‚‹', r:'fuensuru', m:'to elaborate / expand on', pos:'verb (suru)' },
    { k:'æ¨è±¡ã™ã‚‹', f:'ã—ã‚ƒã—ã‚‡ã†ã™ã‚‹', r:'shashousuru', m:'to abstract away details', pos:'verb (suru)' },
    { k:'æŽªå®šã™ã‚‹', f:'ãã¦ã„ã™ã‚‹', r:'soteisuru', m:'to posit / stipulate', pos:'verb (suru)' }
  ]
};

// Fill remaining vocab without origin data using a default
const defaultOrigin = (k) => ({
  pictograph: `${k} has roots in ancient Chinese pictographic script, evolving over centuries into its modern form through gradual simplification.`,
  radicals: [{k: k[0], m:'component'}],
  literal: `The character carries meaning through its visual components combined.`,
  hook: `Break it into parts and create your own visual story to remember it!`,
  related: []
});

// Extend all vocab with default origin if missing
Object.values(vocab).forEach(arr => arr.forEach(w => { if (!w.origin) w.origin = defaultOrigin(w.k); }));

// Add more N4 words â€” all with full rich origin data
const extraN4 = [
  { k:'éŸ³æ¥½', f:'ãŠã‚“ãŒã', r:'ongaku', m:'music', pos:'noun',
    origin:{ pictograph:'éŸ³ shows a mouth (å£) with a sound wave line coming out â€” sound itself! æ¥½ shows strings stretched over a frame (æœ¨) â€” a stringed instrument being played. Sound + instrument = music!', radicals:[{k:'éŸ³',m:'sound'},{k:'æ¥½',m:'music/pleasure'}], literal:'Sound waves + a stringed instrument = Music flowing through the air ðŸŽµ', hook:'ON-GA-KU: "Oh! Nice! Cool!" â€” that\'s what you say when you hear great music! ãŠã‚“ãŒã!', related:['æ­Œ','æ¥½å™¨','æ¼”å¥'] }},
  { k:'æ˜ ç”»', f:'ãˆã„ãŒ', r:'eiga', m:'movie', pos:'noun',
    origin:{ pictograph:'æ˜  shows the sun (æ—¥) projecting light (å¤®) outward â€” like a projector beam! ç”» shows a field (ç”°) divided by lines â€” a frame, a picture. Light projected into frames = movie!', radicals:[{k:'æ—¥',m:'sun/light'},{k:'ç”»',m:'picture/frame'}], literal:'Projected light + framed pictures = cinema magic ðŸŽ¬', hook:'EI-GA: "Hey! GAH!" â€” you say "Hey! Gah!" when a plot twist hits in a movie! ãˆã„ãŒ!', related:['æ˜ ç”»é¤¨','ä¿³å„ª','ç›£ç£'] }},
  { k:'ä»•äº‹', f:'ã—ã”ã¨', r:'shigoto', m:'work / job', pos:'noun',
    origin:{ pictograph:'ä»• shows a person (äºº) serving â€” originally "to serve a master." äº‹ shows a hand holding a writing brush (å²) â€” recording things, doing official business. Serving + doing official things = work!', radicals:[{k:'äºº',m:'person'},{k:'äº‹',m:'matter/thing'}], literal:'A servant diligently recording work = your job! ðŸ’¼', hook:'SHI-GO-TO: "She goes to" work every day â€” SHI-GO-TO! ã—ã”ã¨!', related:['åƒã','è·æ¥­','ä¼šç¤¾'] }},
  { k:'æº–å‚™', f:'ã˜ã‚…ã‚“ã³', r:'junbi', m:'preparation', pos:'noun',
    origin:{ pictograph:'æº– shows water (æ°µ) flowing level (éš¼) â€” getting everything level and ready. å‚™ shows a person (äºº) with arrows (å‚™) stored ready to use â€” being armed and prepared!', radicals:[{k:'æ°µ',m:'water'},{k:'äºº',m:'person'},{k:'çŸ¢',m:'arrow'}], literal:'Levelling the water + storing arrows = fully prepared! ðŸ¹', hook:'JUN-BI: "JUNE BE ready!" â€” prepare in June for summer! ã˜ã‚…ã‚“ã³!', related:['ç”¨æ„','æº–å‚™ã™ã‚‹','è¨ˆç”»'] }},
  { k:'éŠã¶', f:'ã‚ãã¶', r:'asobu', m:'to play / hang out', pos:'verb (u)',
    origin:{ pictograph:'éŠ shows movement (è¾¶) with a flag and child (æ–¿) â€” a child wandering freely with a flag, like playing outside! The freedom of movement = to play!', radicals:[{k:'è¾¶',m:'movement'},{k:'å­',m:'child'}], literal:'A child freely roaming and waving a flag = playing! ðŸŽˆ', hook:'A-SO-BU: "Ah! So BOOM!" â€” you shout "AH SO!" when you find someone to play with! ã‚ãã¶!', related:['æ¥½ã—ã‚€','ã‚²ãƒ¼ãƒ ','éŠåœ’åœ°'] }},
  { k:'åƒã', f:'ã¯ãŸã‚‰ã', r:'hataraku', m:'to work', pos:'verb (u)',
    origin:{ pictograph:'åƒ is a Japanese-made kanji (å’Œè£½æ¼¢å­—)! It combines person (äºº) + move (å‹•) â€” a person in motion, actively doing something. A moving person = working!', radicals:[{k:'äºº',m:'person'},{k:'å‹•',m:'move/motion'}], literal:'A person constantly in motion = working hard! âš™ï¸', hook:'HA-TA-RA-KU: "HIT-A-ROCK-OO!" â€” you hit a rock while working hard! ã¯ãŸã‚‰ã!', related:['ä»•äº‹','åŠ´åƒ','å‹¤ã‚ã‚‹'] }},
  { k:'æ•™ãˆã‚‹', f:'ãŠã—ãˆã‚‹', r:'oshieru', m:'to teach / tell', pos:'verb (ru)',
    origin:{ pictograph:'æ•™ shows an elder (å­) with a stick/rod (æ”µ) â€” an elder instructing a child with a teaching stick. The authority of wisdom being passed down = to teach!', radicals:[{k:'å­',m:'filial piety'},{k:'æ”µ',m:'strike/action'}], literal:'An elder with a teaching rod guiding the next generation ðŸ“š', hook:'O-SHI-E-RU: "Oh! She\'s a RU-ler!" â€” the teacher who rules the class! ãŠã—ãˆã‚‹!', related:['å­¦ã¶','å…ˆç”Ÿ','æŽˆæ¥­'] }},
  { k:'æ€¥ã', f:'ã„ãã', r:'isogu', m:'to hurry', pos:'verb (u)',
    origin:{ pictograph:'æ€¥ shows a hand (åˆ) gripping a heart (å¿ƒ) from above â€” urgency gripping your chest! When your heart is grabbed, you move fast. Urgency seizing the heart = to hurry!', radicals:[{k:'å¿ƒ',m:'heart'},{k:'åˆ',m:'hand'}], literal:'A hand grabbing your heart with urgency â€” you\'d hurry too! âš¡', hook:'I-SO-GU: "I\'m SO GU-nna be late!" â€” that panic when you\'re running late! ã„ãã!', related:['é€Ÿã„','èµ°ã‚‹','æ€¥ã„ã§'] }},
  { k:'å›°ã‚‹', f:'ã“ã¾ã‚‹', r:'komaru', m:'to be troubled', pos:'verb (u)',
    origin:{ pictograph:'å›° shows a tree (æœ¨) trapped inside a box (å›—) â€” a tree that can\'t grow, confined and stunted. Feeling trapped like a tree in a box = being troubled or stuck!', radicals:[{k:'æœ¨',m:'tree'},{k:'å›—',m:'enclosure/box'}], literal:'A tree imprisoned in a box â€” stuck, can\'t move = troubled! ðŸ˜°', hook:'KO-MA-RU: "Oh COMMA, RU-ined!" â€” a grammar comma that ruins your sentence = total trouble! ã“ã¾ã‚‹!', related:['æ‚©ã‚€','å•é¡Œ','å¤§å¤‰'] }},
  { k:'æ±ºã‚ã‚‹', f:'ãã‚ã‚‹', r:'kimeru', m:'to decide', pos:'verb (ru)',
    origin:{ pictograph:'æ±º shows water (æ°µ) breaking through (å¤¬) a dam â€” the decisive moment when water bursts free. A burst of decisive action = to decide!', radicals:[{k:'æ°µ',m:'water'},{k:'å¤¬',m:'break through'}], literal:'Water bursting through a dam = making a final decision! ðŸ’¥', hook:'KI-ME-RU: "Key ME RU!" â€” use the KEY to open the door = decide and commit! ãã‚ã‚‹!', related:['é¸ã¶','åˆ¤æ–­','æ±ºæ–­'] }},
  { k:'ä¸å¯§', f:'ã¦ã„ã­ã„', r:'teinei', m:'polite / careful', pos:'adj (na)',
    origin:{ pictograph:'ä¸ shows a nail being hammered in carefully â€” precise, exact. å¯§ shows a heart (å¿ƒ) content under a roof â€” peaceful and calm at home. Careful precision + peaceful heart = polite!', radicals:[{k:'ä¸',m:'exact/nail'},{k:'å¿ƒ',m:'heart'},{k:'å®€',m:'roof'}], literal:'Precise nailing + peaceful heart = refined politeness ðŸŽŽ', hook:'TEI-NEI: "They\'re NEAT" â€” polite people are always neat and careful! ã¦ã„ã­ã„!', related:['ç¤¼å„€','è¦ªåˆ‡','ãƒžãƒŠãƒ¼'] }},
  { k:'å¤§åˆ‡', f:'ãŸã„ã›ã¤', r:'taisetsu', m:'important', pos:'adj (na)',
    origin:{ pictograph:'å¤§ shows a person with arms stretched wide â€” something BIG and grand. åˆ‡ shows a knife (åˆ€) cutting â€” something that cuts to the core. Big + cutting to the core = truly important!', radicals:[{k:'å¤§',m:'big/great'},{k:'åˆ‡',m:'cut/sincere'}], literal:'Great + cutting to the heart = what truly matters â¤ï¸', hook:'TAI-SE-TSU: "TIE it SETS U" â€” tie down what\'s important so it stays! ãŸã„ã›ã¤!', related:['é‡è¦','è²´é‡','å¤§äº‹'] }},
  { k:'é›£ã—ã„', f:'ã‚€ãšã‹ã—ã„', r:'muzukashii', m:'difficult', pos:'adj (i)',
    origin:{ pictograph:'é›£ shows a bird (éš¹) being strangled or caught (ð¦°©) â€” a bird trapped, struggling to escape. é›£ originally meant "calamity" â€” something hard to escape from. Struggling = difficult!', radicals:[{k:'éš¹',m:'bird'},{k:'ð¦°©',m:'catch/strangle'}], literal:'A trapped struggling bird = something hard to deal with ðŸ¦', hook:'MU-ZU-KA-SHII: "Moo! Zoo! Got SHEEP!" â€” herding sheep at a zoo is VERY difficult! ã‚€ãšã‹ã—ã„!', related:['æ˜“ã—ã„','å¤§å¤‰','è¤‡é›‘'] }},
  { k:'çã—ã„', f:'ã‚ãšã‚‰ã—ã„', r:'mezurashii', m:'rare', pos:'adj (i)',
    origin:{ pictograph:'ç shows a jade gem (çŽ‹/çŽ‰) that is special (ã±) â€” a truly rare precious jewel. Rare gems are the model for rarity itself!', radicals:[{k:'çŽ‹',m:'king/gem'},{k:'ã±',m:'strange/special'}], literal:'A rare precious gemstone = something you almost never see ðŸ’Ž', hook:'ME-ZU-RA-SHII: "May-ZOO-RA-SHE" â€” maybe the zoo has a rare she-creature! ã‚ãšã‚‰ã—ã„!', related:['ç‰¹åˆ¥','å¸Œå°‘','è²´é‡'] }},
  { k:'æ‚²ã—ã„', f:'ã‹ãªã—ã„', r:'kanashii', m:'sad', pos:'adj (i)',
    origin:{ pictograph:'æ‚² shows the heart (å¿ƒ) at the bottom and éž (wrong/not) on top â€” a heart full of "wrongness." When your heart feels things are wrong and broken = sadness!', radicals:[{k:'å¿ƒ',m:'heart'},{k:'éž',m:'wrong/not'}], literal:'A heart full of "wrongness" = sadness flooding in ðŸ’§', hook:'KA-NA-SHII: "Can a SHEEP be sad?" â€” even a sheep gets ã‹ãªã—ã„ sometimes! ã‹ãªã—ã„!', related:['æ³£ã','è¾›ã„','å¯‚ã—ã„'] }},
  { k:'é€£çµ¡', f:'ã‚Œã‚“ã‚‰ã', r:'renraku', m:'contact / communication', pos:'noun',
    origin:{ pictograph:'é€£ shows movement (è¾¶) + a cart (è»Š) â€” things following one another in a connected line. çµ¡ shows thread (ç³¸) wrapping around (å„) â€” binding things together. A connected chain of communication = contact!', radicals:[{k:'è¾¶',m:'movement'},{k:'è»Š',m:'cart/vehicle'},{k:'ç³¸',m:'thread'}], literal:'A chain of carts connected by thread = keeping in touch ðŸ“²', hook:'REN-RA-KU: "WHEN? RACK UP" â€” rack up calls to keep in contact! ã‚Œã‚“ã‚‰ã!', related:['é›»è©±','ãƒ¡ãƒ¼ãƒ«','çŸ¥ã‚‰ã›ã‚‹'] }},
];
extraN4.forEach(w => vocab.N4.push(w));

const extraN3 = [
  { k:'ç›®æ¨™', f:'ã‚‚ãã²ã‚‡ã†', r:'mokuhyou', m:'goal / target', pos:'noun',
    origin:{ pictograph:'ç›® is the eye (ç›®) â€” looking and aiming. æ¨™ shows a tree (æœ¨) topped with a marker sign â€” a signpost you\'re aiming for. Your eye fixed on a signpost = your goal!', radicals:[{k:'ç›®',m:'eye'},{k:'æœ¨',m:'tree'},{k:'ç¤º',m:'sign'}], literal:'Eye fixed on a distant signpost = aiming for your goal! ðŸŽ¯', hook:'MOKU-HYOU: "Mock-YOU" â€” your goal mocks you until you achieve it! ã‚‚ãã²ã‚‡ã†!', related:['ç›®çš„','é”æˆ','å¤¢'] }},
  { k:'ç†ç”±', f:'ã‚Šã‚†ã†', r:'riyuu', m:'reason / cause', pos:'noun',
    origin:{ pictograph:'ç† shows a jade gem (çŽ‹) being polished (é‡Œ) â€” bringing out the logical inner structure. ç”± shows a vessel with something coming out from the top â€” the source, the origin. Logical source = reason!', radicals:[{k:'çŽ‹',m:'gem/logic'},{k:'ç”±',m:'origin/source'}], literal:'Polishing out the logic + finding the source = the reason why ðŸ”', hook:'RI-YUU: "REE-YOU" â€” the reason is because of YOU! ã‚Šã‚†ã†!', related:['åŽŸå› ','ç†è§£','ãªãœ'] }},
  { k:'çµæžœ', f:'ã‘ã£ã‹', r:'kekka', m:'result / outcome', pos:'noun',
    origin:{ pictograph:'çµ shows thread (ç³¸) being tied in a knot (å‰) â€” the final binding. æžœ shows a tree (æœ¨) with fruit (ç”°) on top â€” the fruit that results from growth. Tying up + bearing fruit = result!', radicals:[{k:'ç³¸',m:'thread'},{k:'æœ¨',m:'tree'},{k:'ç”°',m:'fruit'}], literal:'Thread tied in a knot + tree bearing fruit = the final outcome ðŸŽ', hook:'KE-KKA: "CHECK! KA-ching!" â€” check the result, and ka-ching! ã‘ã£ã‹!', related:['åŽŸå› ','æˆæžœ','å½±éŸ¿'] }},
  { k:'åˆ¤æ–­', f:'ã¯ã‚“ã ã‚“', r:'handan', m:'judgement / decision', pos:'noun',
    origin:{ pictograph:'åˆ¤ shows a knife (åˆ€) cutting something in half (åŠ) â€” dividing and discriminating. æ–­ shows an axe (æ–¤) cutting threads (ç³¸) â€” cutting off decisively. Cutting + severing = making a judgement!', radicals:[{k:'åˆ€',m:'knife'},{k:'ç³¸',m:'thread'},{k:'æ–¤',m:'axe'}], literal:'A knife splitting things + an axe cutting through = decisive judgement âš–ï¸', hook:'HAN-DAN: "HAN DAN-ces" â€” Han Solo dances when he makes a judgement call! ã¯ã‚“ã ã‚“!', related:['æ±ºã‚ã‚‹','è©•ä¾¡','åˆ¤å®š'] }},
  { k:'è§£æ±ºã™ã‚‹', f:'ã‹ã„ã‘ã¤ã™ã‚‹', r:'kaiketsu suru', m:'to solve', pos:'verb (suru)',
    origin:{ pictograph:'è§£ shows a knife (åˆ€) separating a cow (ç‰›) horn (è§’) â€” cutting apart, loosening a bind. æ±º shows water bursting through a dam. Together: untying the knot and breaking through = to solve!', radicals:[{k:'åˆ€',m:'knife'},{k:'ç‰›',m:'cow'},{k:'æ°µ',m:'water'}], literal:'Cutting apart the tangle + water breaking free = problem solved! ðŸ”“', hook:'KAI-KE-TSU: "KAY! Ke-TCHA!" â€” "Okay! Gotcha!" â€” problem solved! ã‹ã„ã‘ã¤ã™ã‚‹!', related:['å•é¡Œ','å¯¾å‡¦','ç­”ãˆã‚‹'] }},
  { k:'å‚åŠ ã™ã‚‹', f:'ã•ã‚“ã‹ã™ã‚‹', r:'sanka suru', m:'to participate', pos:'verb (suru)',
    origin:{ pictograph:'å‚ shows three stars (å½¡) above a person bowing (å¤§) â€” originally "to visit a shrine or pay respects." åŠ  shows a mouth (å£) adding force (åŠ›) â€” joining in and adding your strength. Visiting + adding force = participating!', radicals:[{k:'å½¡',m:'three stars'},{k:'åŠ›',m:'strength'},{k:'å£',m:'mouth'}], literal:'Bowing to join + adding your strength = getting involved! ðŸ™Œ', hook:'SAN-KA: "SUN-KA-ching!" â€” the sun shines when you join in! ã•ã‚“ã‹ã™ã‚‹!', related:['åŠ ã‚ã‚‹','å‡ºå¸­','å”åŠ›'] }},
  { k:'æ¯”ã¹ã‚‹', f:'ãã‚‰ã¹ã‚‹', r:'kuraberu', m:'to compare', pos:'verb (ru)',
    origin:{ pictograph:'æ¯” shows two people (äºº) standing side by side â€” two things placed next to each other for comparison. The simplest act of measurement: putting things side by side!', radicals:[{k:'äºº',m:'person (x2)'}], literal:'Two people standing next to each other = comparing side by side ðŸ‘¥', hook:'KU-RA-BE-RU: "Kura-BEAR-u" â€” compare two bears, which is bigger? ãã‚‰ã¹ã‚‹!', related:['é•ã„','åŒã˜','å·®'] }},
  { k:'ç¶šã', f:'ã¤ã¥ã', r:'tsuzuku', m:'to continue', pos:'verb (u)',
    origin:{ pictograph:'ç¶š shows thread (ç³¸) being sold/passed on (å£²) â€” thread being continuously extended and passed along. An unbroken thread = continuation!', radicals:[{k:'ç³¸',m:'thread'},{k:'å£²',m:'sell/pass on'}], literal:'Thread that keeps getting passed along = something that goes on and on âž¡ï¸', hook:'TSU-ZU-KU: "Zoo-ZOOKU!" â€” the zoo zoo zoo keeps going on! ã¤ã¥ã!', related:['ç¶™ç¶š','ãšã£ã¨','é€£ç¶š'] }},
  { k:'èªã‚ã‚‹', f:'ã¿ã¨ã‚ã‚‹', r:'mitomeru', m:'to recognise / acknowledge', pos:'verb (ru)',
    origin:{ pictograph:'èª shows a word (è¨€) + endure/persevere (å¿) â€” words that take patience and careful discernment. To recognise something takes careful observation and admitting what you see!', radicals:[{k:'è¨€',m:'words'},{k:'å¿',m:'endure/patience'}], literal:'Patient words + careful observation = recognising and admitting the truth ðŸ‘ï¸', hook:'MI-TO-ME-RU: "ME TOO, ME RU!" â€” "Me too!" â€” acknowledging someone else\'s point! ã¿ã¨ã‚ã‚‹!', related:['èªè­˜','å—ã‘å…¥ã‚Œã‚‹','æ‰¿èª'] }},
  { k:'å…·ä½“çš„', f:'ããŸã„ã¦ã', r:'gutaiteki', m:'concrete / specific', pos:'adj (na)',
    origin:{ pictograph:'å…· shows a container (ç›®) with hands (å»¾) â€” holding real physical things. ä½“ is the body (ä½“) â€” tangible, physical existence. çš„ is a target (ç™½+å‹º) â€” pointing precisely. Physical body + aimed at a target = concrete and specific!', radicals:[{k:'å…·',m:'tool/real'},{k:'ä½“',m:'body'},{k:'çš„',m:'target'}], literal:'Real tools + a body + a bullseye = exactly specific! ðŸŽ¯', hook:'GU-TAI-TEK-I: "GOO-TIE-TECH-ee" â€” GOOD tech is always concrete and specific! ããŸã„ã¦ã!', related:['æŠ½è±¡çš„','æ˜Žç¢º','è©³ã—ã„'] }},
  { k:'è‡ªç”±', f:'ã˜ã‚†ã†', r:'jiyuu', m:'freedom', pos:'noun',
    origin:{ pictograph:'è‡ª shows a nose (nose was "self" in old script) â€” literally "oneself." ç”± shows something flowing freely from a vessel â€” the source and flow. Being from oneself, flowing freely = freedom!', radicals:[{k:'è‡ª',m:'self/nose'},{k:'ç”±',m:'origin/flow'}], literal:'Oneself + flowing freely from the source = liberty! ðŸ•Šï¸', hook:'JI-YUU: "GEE! YOU!" â€” "Gee, you\'re FREE!" ã˜ã‚†ã†!', related:['è‡ªç«‹','è§£æ”¾','ç‹¬ç«‹'] }},
  { k:'åŽ³ã—ã„', f:'ãã³ã—ã„', r:'kibishi', m:'strict / harsh', pos:'adj (i)',
    origin:{ pictograph:'åŽ³ shows a mountain (å±±) that is steep and imposing (æ•¢+å£) â€” nature at its most uncompromising and harsh. A steep, demanding mountain face = strictness!', radicals:[{k:'å±±',m:'mountain'},{k:'æ•¢',m:'bold/dare'}], literal:'A harsh, steep mountain face that demands respect ðŸ”ï¸', hook:'KI-BI-SHI-I: "KEY-BEE-SHE" â€” the key to the beehive is SHE, the strict queen bee! ãã³ã—ã„!', related:['åŽ³æ ¼','æ¿€ã—ã„','é›£ã—ã„'] }},
  { k:'ç´°ã‹ã„', f:'ã“ã¾ã‹ã„', r:'komakai', m:'detailed / fine', pos:'adj (i)',
    origin:{ pictograph:'ç´° shows thread (ç³¸) that is tiny (å›Ÿ â€” a fontanelle, small opening) â€” the thinnest, most delicate thread. ç´°ã„ = thin; ç´°ã‹ã„ = made of fine, tiny details!', radicals:[{k:'ç³¸',m:'thread'},{k:'å›Ÿ',m:'small/delicate'}], literal:'The thinnest possible thread = extremely fine and detailed ðŸ§µ', hook:'KO-MA-KA-I: "COMMA-KAI!" â€” so many commas = so much detail! ã“ã¾ã‹ã„!', related:['è©³ã—ã„','ä¸å¯§','ç²¾å¯†'] }},
  { k:'èª²é¡Œ', f:'ã‹ã ã„', r:'kadai', m:'task / issue', pos:'noun',
    origin:{ pictograph:'èª² shows words (è¨€) being tested or assigned (æžœ) â€” like assignments being given out, word by word. é¡Œ shows the head/top (é ) of something that must be addressed (æ˜¯). Assigned words + addressing the problem = task!', radicals:[{k:'è¨€',m:'words'},{k:'æžœ',m:'result'},{k:'é ',m:'head/top'}], literal:'Words assigned + a problem to address = your task or homework ðŸ“', hook:'KA-DAI: "Car DIE!" â€” the car died = that\'s your problem to solve! ã‹ã ã„!', related:['å•é¡Œ','å®¿é¡Œ','ä»•äº‹'] }},
  { k:'çŠ¶æ³', f:'ã˜ã‚‡ã†ãã‚‡ã†', r:'joukyou', m:'situation / circumstances', pos:'noun',
    origin:{ pictograph:'çŠ¶ shows a dog (çŠ¬) in a specific shape â€” its form, its state. æ³ shows water (æ°µ) going somewhere specific (å…„) â€” the flow and condition of things. The shape of things + how they\'re flowing = situation!', radicals:[{k:'çŠ¬',m:'dog/form'},{k:'æ°µ',m:'water'},{k:'å…„',m:'elder/direction'}], literal:'The shape of things + how they\'re flowing = the current state of affairs ðŸŒŠ', hook:'JO-U-KYO: "SHOW! KYOTO!" â€” show me the situation in Kyoto! ã˜ã‚‡ã†ãã‚‡ã†!', related:['çŠ¶æ…‹','äº‹æƒ…','ç’°å¢ƒ'] }},
];
extraN3.forEach(w => vocab.N3.push(w));

// Extra N2 words â€” full rich origin data
const extraN2 = [
  { k:'æ›–æ˜§', f:'ã‚ã„ã¾ã„', r:'aimai', m:'vague / ambiguous', pos:'adj (na)',
    origin:{ pictograph:'æ›– shows the sun (æ—¥) hidden behind something (æ„›) â€” the sun obscured, giving unclear light. æ˜§ shows the sun (æ—¥) + not yet (æœª) â€” not yet fully bright, still dark. Two "unclear sun" kanji = total ambiguity!', radicals:[{k:'æ—¥',m:'sun'},{k:'æ„›',m:'obscure'},{k:'æœª',m:'not yet'}], literal:'A sun hidden twice over = murky, unclear, impossible to pin down ðŸŒ«ï¸', hook:'AI-MAI: "AY! MY!" â€” "Ay, my answer is... well... kinda... maybe?" Total ambiguity! ã‚ã„ã¾ã„!', related:['æ˜Žç¢º','ä¸æ˜Ž','ã¯ã£ãã‚Š'] }},
  { k:'æ„è­˜', f:'ã„ã—ã', r:'ishiki', m:'consciousness / awareness', pos:'noun',
    origin:{ pictograph:'æ„ shows the heart (å¿ƒ) + sound (éŸ³) â€” your inner voice speaking in the heart. è­˜ shows words (è¨€) + a halberd (æˆ ) â€” knowing something with sharp precision. Inner voice + sharp knowing = consciousness!', radicals:[{k:'å¿ƒ',m:'heart'},{k:'éŸ³',m:'sound'},{k:'è¨€',m:'words'}], literal:'Your inner voice cutting sharply through thought = awareness ðŸ§ ', hook:'I-SHI-KI: "E-SHE-KEY" â€” the KEY to awareness is opening your inner self! ã„ã—ã!', related:['ç„¡æ„è­˜','è‡ªè¦š','èªè­˜'] }},
  { k:'ä¸»å¼µ', f:'ã—ã‚…ã¡ã‚‡ã†', r:'shuchou', m:'assertion / claim', pos:'noun',
    origin:{ pictograph:'ä¸» shows a flame on a lamp stand â€” the central, dominant light. å¼µ shows a bow (å¼“) being stretched taut â€” tension, strength, extension. A dominant force stretching outward = making a strong claim!', radicals:[{k:'ä¸»',m:'master/main'},{k:'å¼“',m:'bow'}], literal:'The main flame stretched like a taut bow = a bold assertion ðŸ’ª', hook:'SHU-CHOU: "SHOE-CHOW" â€” stamp your shoe and CHOW down on your argument! ã—ã‚…ã¡ã‚‡ã†!', related:['æ„è¦‹','è­°è«–','åè«–'] }},
  { k:'å‚¾å‘', f:'ã‘ã„ã“ã†', r:'keikou', m:'tendency / trend', pos:'noun',
    origin:{ pictograph:'å‚¾ shows a person (äºº) tilting sideways â€” leaning in one direction. å‘ shows a window opening one way â€” facing a direction. A person leaning + facing = having a tendency toward something!', radicals:[{k:'äºº',m:'person'},{k:'å‘',m:'direction'}], literal:'A person perpetually leaning the same way = a tendency or trend ðŸ“ˆ', hook:'KEI-KOU: "KAY! GO!" â€” always trending the same direction! ã‘ã„ã“ã†!', related:['å‚¾ã','æµè¡Œ','ãƒ‘ã‚¿ãƒ¼ãƒ³'] }},
  { k:'å¦¥å”', f:'ã ãã‚‡ã†', r:'dakyou', m:'compromise', pos:'noun',
    origin:{ pictograph:'å¦¥ shows a woman (å¥³) + hand from above (çˆª) â€” to pacify, to settle. å” shows three people working together â€” combined effort. Settling peacefully + working together = compromise!', radicals:[{k:'å¥³',m:'woman'},{k:'çˆª',m:'hand'},{k:'åŠ›',m:'strength x3'}], literal:'Peaceful settling + three people cooperating = finding the middle ground ðŸ¤', hook:'DA-KYOU: "DA! KYO!" â€” "DA! Let\'s cooperate TODAY!" â€” meeting in the middle! ã ãã‚‡ã†!', related:['æŠ˜ã‚Šåˆã„','èª¿æ•´','å¦¥å”ç‚¹'] }},
  { k:'å…‹æœ', f:'ã“ããµã', r:'kokufuku', m:'to overcome', pos:'verb (suru)',
    origin:{ pictograph:'å…‹ shows a person carrying a heavy load on their head â€” bearing a burden with effort and eventually overcoming it. æœ shows a person bowing and submitting â€” but here YOU make it submit to you!', radicals:[{k:'å',m:'burden'},{k:'å„¿',m:'person'},{k:'æœ',m:'submit'}], literal:'Bearing a load + making it submit = conquering and overcoming! âš”ï¸', hook:'KO-KU-FU-KU: "CONQUER-FUKU!" â€” conquer your weakness with good fortune! ã“ããµã!', related:['ä¹—ã‚Šè¶Šãˆã‚‹','æ‰“ã¡å‹ã¤','é”æˆ'] }},
  { k:'æ‰¹åˆ¤', f:'ã²ã¯ã‚“', r:'hihan', m:'criticism / critique', pos:'noun',
    origin:{ pictograph:'æ‰¹ shows a hand (æ‰Œ) striking and comparing. åˆ¤ shows a knife (åˆ€) cutting things in half (åŠ) â€” dividing, making a decisive cut. Striking comparison + decisive cut = criticism!', radicals:[{k:'æ‰Œ',m:'hand'},{k:'æ¯”',m:'compare'},{k:'åˆ€',m:'knife'}], literal:'A hand comparing + a knife dividing = sharp, decisive criticism âœ‚ï¸', hook:'HI-HAN: "HEE-HAN!" â€” a donkey braying = a critic who never stops! ã²ã¯ã‚“!', related:['æ‰¹è©•','è©•ä¾¡','éžé›£'] }},
  { k:'æ ¹æ‹ ', f:'ã“ã‚“ãã‚‡', r:'konkyo', m:'basis / grounds / evidence', pos:'noun',
    origin:{ pictograph:'æ ¹ shows a tree (æœ¨) with its roots (è‰®) â€” the foundation of something. æ‹  shows a hand (æ‰Œ) gripping a perch firmly. Deep roots + firm grip = the solid basis of an argument!', radicals:[{k:'æœ¨',m:'tree'},{k:'è‰®',m:'root'},{k:'æ‰Œ',m:'hand'}], literal:'Tree roots gripped firmly = the solid foundation of a claim ðŸŒ³', hook:'KON-KYO: "CON-KYO!" â€” every argument needs its basis! ã“ã‚“ãã‚‡!', related:['æ ¹æœ¬','ç†ç”±','è¨¼æ‹ '] }},
];
extraN2.forEach(w => vocab.N2.push(w));

// Extra N1 words â€” full rich origin data
const extraN1 = [
  { k:'ç‘£æœ«', f:'ã•ã¾ã¤', r:'samatsu', m:'trivial / petty details', pos:'adj (na)',
    origin:{ pictograph:'ç‘£ shows jade (çŽ‹) fragmented into tiny pieces â€” precious stone broken into worthless chips. æœ« shows a tree (æœ¨) with emphasis on the TIP â€” the very end, the least important part. Jade dust + tree tips = the most trivial things imaginable!', radicals:[{k:'çŽ‹',m:'jade'},{k:'æœ¨',m:'tree'},{k:'æœ«',m:'tip/end'}], literal:'Scattered jade dust + tree tips = petty, insignificant trifles ðŸƒ', hook:'SA-MA-TSU: "SAMA-TSU!" â€” even a lord (sama) fusses over tiny (tsu) things! ã•ã¾ã¤!', related:['äº›ç´°','æžè‘‰æœ«ç¯€','é‡è¦'] }},
  { k:'æ…Ÿå“­', f:'ã©ã†ã“ã', r:'doukoku', m:'wailing / loud lamenting', pos:'noun',
    origin:{ pictograph:'æ…Ÿ shows the heart (å¿ƒ) being violently shaken (å‹•) â€” an emotion so strong it physically moves you. å“­ shows a mouth (å£) + a dog (çŠ¬) â€” the raw, animal sound of grief, like a howl. A shaken heart + an animal howl = wailing grief!', radicals:[{k:'å¿ƒ',m:'heart'},{k:'å‹•',m:'move'},{k:'å£',m:'mouth'},{k:'çŠ¬',m:'dog'}], literal:'A violently shaken heart + a howling mouth = the deepest, loudest grief ðŸ˜¢', hook:'DOU-KOKU: "DOH! KOKORO!" â€” "DOH! My heart!" â€” the cry of pure raw grief! ã©ã†ã“ã!', related:['å˜†ã','æ‚²å˜†','å·æ³£'] }},
  { k:'è¹‰è·Ž', f:'ã•ãŸ', r:'sata', m:'letting time slip by / stagnation', pos:'noun',
    origin:{ pictograph:'è¹‰ shows a foot (è¶³) slipping â€” your foot sliding, losing ground. è·Ž shows a foot (è¶³) stumbling â€” tripping without going anywhere. Two slipping, stumbling feet = a life spent stagnating!', radicals:[{k:'è¶³',m:'foot (x2)'}], literal:'Two feet slipping and stumbling = watching time pass while going nowhere â³', hook:'SA-TA: "SAY TA-ta!" â€” keep saying goodbye to your opportunities! ã•ãŸ!', related:['æ™‚é–“ã‚’ç„¡é§„ã«ã™ã‚‹','åœæ»ž','ç©ºç™½'] }},
  { k:'åˆ¹é‚£', f:'ã›ã¤ãª', r:'setsuna', m:'a moment / an instant', pos:'noun',
    origin:{ pictograph:'åˆ¹ shows a knife (åˆ€) next to a tree (æœ¨) â€” cutting something cleanly and instantly. é‚£ is a phonetic Sanskrit import meaning "that." Together the Buddhist term for the smallest unit of time â€” a snap of the fingers!', radicals:[{k:'åˆ€',m:'knife'},{k:'æœ¨',m:'tree'}], literal:'A knife-clean instant = the briefest possible moment âš¡', hook:'SE-TSU-NA: "SET-SU-NA!" â€” set your timer and NA! It\'s already gone! ã›ã¤ãª!', related:['çž¬é–“','ä¸€çž¬','åˆ¹é‚£ä¸»ç¾©'] }},
  { k:'è‘›è—¤', f:'ã‹ã£ã¨ã†', r:'kattou', m:'inner conflict / discord', pos:'noun',
    origin:{ pictograph:'è‘› shows a plant (è‰¹) that creeps and tangles â€” the kudzu vine that wraps around everything. è—¤ shows wisteria, also a climbing vine. Two tangled climbing vines = inner conflict wrapped around your heart!', radicals:[{k:'è‰¹',m:'plant (x2)'}], literal:'Two vines tangled around each other = the inner conflict of two desires ðŸŒ¿', hook:'KA-T-TOU: "CAUGHT-OH!" â€” you\'re CAUGHT between two things! ã‹ã£ã¨ã†!', related:['çŸ›ç›¾','ã‚¸ãƒ¬ãƒ³ãƒž','æ‚©ã¿'] }},
  { k:'è¬™è™š', f:'ã‘ã‚“ãã‚‡', r:'kenkyo', m:'humble / modest', pos:'adj (na)',
    origin:{ pictograph:'è¬™ shows words (è¨€) that are restrained and measured â€” speech that pulls back, does not over-claim. è™š shows a tiger shell with an empty inside â€” an empty vessel, not puffed up. Restrained speech + empty inside = true humility!', radicals:[{k:'è¨€',m:'words'},{k:'è™',m:'tiger'},{k:'ä¸š',m:'empty'}], literal:'Restrained words + an empty vessel = true humble modesty ðŸ™', hook:'KEN-KYO: "KEN is KYO-ol!" â€” Ken is cool because he stays humbly quiet! ã‘ã‚“ãã‚‡!', related:['è¬™éœ','æŽ§ãˆã‚','å‚²æ…¢'] }},
];
extraN1.forEach(w => vocab.N1.push(w));

// â”€â”€ Additional N5 words â”€â”€
const extraN5more = [
  { k:'é›»è©±', f:'ã§ã‚“ã‚', r:'denwa', m:'telephone', pos:'noun' },
  { k:'å¤©æ°—', f:'ã¦ã‚“ã', r:'tenki', m:'weather', pos:'noun' },
  { k:'ä½•æ™‚', f:'ãªã‚“ã˜', r:'nanji', m:'what time', pos:'noun' },
  { k:'ã©ã“', f:'ã©ã“', r:'doko', m:'where', pos:'pronoun' },
  { k:'ã“ã‚Œ', f:'ã“ã‚Œ', r:'kore', m:'this (thing)', pos:'pronoun' },
  { k:'ãã‚Œ', f:'ãã‚Œ', r:'sore', m:'that (thing)', pos:'pronoun' },
  { k:'ã‚ã‚Œ', f:'ã‚ã‚Œ', r:'are', m:'that over there', pos:'pronoun' },
  { k:'å…¨éƒ¨', f:'ãœã‚“ã¶', r:'zenbu', m:'all / everything', pos:'noun' },
  { k:'å°‘ã—', f:'ã™ã“ã—', r:'sukoshi', m:'a little / a few', pos:'adverb' },
  { k:'ãŸãã•ã‚“', f:'ãŸãã•ã‚“', r:'takusan', m:'a lot / many', pos:'adverb' },
  { k:'ä¸€ç·’', f:'ã„ã£ã—ã‚‡', r:'issho', m:'together', pos:'noun/adverb' },
  { k:'ã©ã†ãž', f:'ã©ã†ãž', r:'douzo', m:'please / go ahead', pos:'interjection' },
  { k:'ã‚ã‚ŠãŒã¨ã†', f:'ã‚ã‚ŠãŒã¨ã†', r:'arigatou', m:'thank you', pos:'interjection' },
  { k:'ã™ã¿ã¾ã›ã‚“', f:'ã™ã¿ã¾ã›ã‚“', r:'sumimasen', m:'excuse me / sorry', pos:'interjection' },
  { k:'å¤§ä¸ˆå¤«', f:'ã ã„ã˜ã‚‡ã†ã¶', r:'daijoubu', m:'okay / no problem', pos:'adj (na)' },
  { k:'ã©ã‚“ãª', f:'ã©ã‚“ãª', r:'donna', m:'what kind of', pos:'pronoun' },
  { k:'å¥½ã', f:'ã™ã', r:'suki', m:'like / fond of', pos:'adj (na)' },
  { k:'å«Œã„', f:'ãã‚‰ã„', r:'kirai', m:'dislike', pos:'adj (na)' },
  { k:'ä¸Šæ‰‹', f:'ã˜ã‚‡ã†ãš', r:'jouzu', m:'skillful / good at', pos:'adj (na)' },
  { k:'ä¸‹æ‰‹', f:'ã¸ãŸ', r:'heta', m:'poor at / unskilled', pos:'adj (na)' },
  { k:'æœ‰å', f:'ã‚†ã†ã‚ã„', r:'yuumei', m:'famous', pos:'adj (na)' },
  { k:'å¤§åˆ‡', f:'ãŸã„ã›ã¤', r:'taisetsu', m:'important / precious', pos:'adj (na)' },
  { k:'è‰²', f:'ã„ã‚', r:'iro', m:'colour', pos:'noun' },
  { k:'å½¢', f:'ã‹ãŸã¡', r:'katachi', m:'shape / form', pos:'noun' },
  { k:'å¤§äºº', f:'ãŠã¨ãª', r:'otona', m:'adult', pos:'noun' },
  { k:'å­', f:'ã“', r:'ko', m:'child / young', pos:'noun' },
  { k:'å‹äºº', f:'ã‚†ã†ã˜ã‚“', r:'yuujin', m:'friend (formal)', pos:'noun' },
  { k:'å­¦ã¶', f:'ã¾ãªã¶', r:'manabu', m:'to learn / study', pos:'verb (u)' },
  { k:'éŠã¶', f:'ã‚ãã¶', r:'asobu', m:'to play / have fun', pos:'verb (u)' },
  { k:'åƒã', f:'ã¯ãŸã‚‰ã', r:'hataraku', m:'to work', pos:'verb (u)' },
  { k:'ä½œã‚‹', f:'ã¤ãã‚‹', r:'tsukuru', m:'to make / create', pos:'verb (u)' },
  { k:'è¦‹ã›ã‚‹', f:'ã¿ã›ã‚‹', r:'miseru', m:'to show', pos:'verb (ru)' },
  { k:'èžã“ãˆã‚‹', f:'ãã“ãˆã‚‹', r:'kikoeru', m:'to be audible / hear', pos:'verb (ru)' },
  { k:'è¦‹ãˆã‚‹', f:'ã¿ãˆã‚‹', r:'mieru', m:'to be visible / see', pos:'verb (ru)' },
];
extraN5more.forEach(w => vocab.N5.push(w));

// â”€â”€ Additional N4 words â”€â”€
const extraN4more = [
  { k:'æ–‡åŒ–', f:'ã¶ã‚“ã‹', r:'bunka', m:'culture', pos:'noun' },
  { k:'ç¤¾ä¼š', f:'ã—ã‚ƒã‹ã„', r:'shakai', m:'society', pos:'noun' },
  { k:'çµŒæ¸ˆ', f:'ã‘ã„ã–ã„', r:'keizai', m:'economy', pos:'noun' },
  { k:'æ”¿æ²»', f:'ã›ã„ã˜', r:'seiji', m:'politics', pos:'noun' },
  { k:'è‡ªç„¶', f:'ã—ãœã‚“', r:'shizen', m:'nature', pos:'noun' },
  { k:'æŠ€è¡“', f:'ãŽã˜ã‚…ã¤', r:'gijutsu', m:'technology / skill', pos:'noun' },
  { k:'å»ºç‰©', f:'ãŸã¦ã‚‚ã®', r:'tatemono', m:'building', pos:'noun' },
  { k:'æ©‹', f:'ã¯ã—', r:'hashi', m:'bridge', pos:'noun' },
  { k:'æ± ', f:'ã„ã‘', r:'ike', m:'pond', pos:'noun' },
  { k:'æ£®', f:'ã‚‚ã‚Š', r:'mori', m:'forest', pos:'noun' },
  { k:'æµ·', f:'ã†ã¿', r:'umi', m:'sea / ocean', pos:'noun' },
  { k:'ç©º', f:'ãã‚‰', r:'sora', m:'sky', pos:'noun' },
  { k:'æ˜Ÿ', f:'ã»ã—', r:'hoshi', m:'star', pos:'noun' },
  { k:'èŠ±', f:'ã¯ãª', r:'hana', m:'flower', pos:'noun' },
  { k:'æœ¨', f:'ã', r:'ki', m:'tree / wood', pos:'noun' },
  { k:'è‘‰', f:'ã¯', r:'ha', m:'leaf', pos:'noun' },
  { k:'è‰', f:'ãã•', r:'kusa', m:'grass', pos:'noun' },
  { k:'ä½“', f:'ã‹ã‚‰ã ', r:'karada', m:'body', pos:'noun' },
  { k:'é ­', f:'ã‚ãŸã¾', r:'atama', m:'head', pos:'noun' },
  { k:'é¡”', f:'ã‹ãŠ', r:'kao', m:'face', pos:'noun' },
  { k:'ç›®', f:'ã‚', r:'me', m:'eye', pos:'noun' },
  { k:'è€³', f:'ã¿ã¿', r:'mimi', m:'ear', pos:'noun' },
  { k:'é¼»', f:'ã¯ãª', r:'hana', m:'nose', pos:'noun' },
  { k:'å£', f:'ãã¡', r:'kuchi', m:'mouth', pos:'noun' },
  { k:'æ‰‹', f:'ã¦', r:'te', m:'hand', pos:'noun' },
  { k:'è¶³', f:'ã‚ã—', r:'ashi', m:'foot / leg', pos:'noun' },
  { k:'å¿ƒ', f:'ã“ã“ã‚', r:'kokoro', m:'heart / mind', pos:'noun' },
  { k:'å£°', f:'ã“ãˆ', r:'koe', m:'voice', pos:'noun' },
  { k:'ä¾¿åˆ©', f:'ã¹ã‚“ã‚Š', r:'benri', m:'convenient', pos:'adj (na)' },
  { k:'ä¸ä¾¿', f:'ãµã¹ã‚“', r:'fuben', m:'inconvenient', pos:'adj (na)' },
  { k:'æ­£ç›´', f:'ã—ã‚‡ã†ã˜ã', r:'shoujiki', m:'honest', pos:'adj (na)' },
  { k:'ä¸å¯§', f:'ã¦ã„ã­ã„', r:'teinei', m:'polite / careful', pos:'adj (na)' },
  { k:'çœŸå‰£', f:'ã—ã‚“ã‘ã‚“', r:'shinken', m:'serious / earnest', pos:'adj (na)' },
  { k:'æ€¥ã', f:'ã„ãã', r:'isogu', m:'to hurry', pos:'verb (u)' },
  { k:'èµ°ã‚‹', f:'ã¯ã—ã‚‹', r:'hashiru', m:'to run', pos:'verb (u)' },
  { k:'æ³³ã', f:'ãŠã‚ˆã', r:'oyogu', m:'to swim', pos:'verb (u)' },
  { k:'ç™»ã‚‹', f:'ã®ã¼ã‚‹', r:'noboru', m:'to climb', pos:'verb (u)' },
  { k:'ä¹—ã‚‹', f:'ã®ã‚‹', r:'noru', m:'to ride / get on', pos:'verb (u)' },
  { k:'æ¸¡ã‚‹', f:'ã‚ãŸã‚‹', r:'wataru', m:'to cross', pos:'verb (u)' },
  { k:'é¸ã¶', f:'ãˆã‚‰ã¶', r:'erabu', m:'to choose / select', pos:'verb (u)' },
  { k:'é ¼ã‚€', f:'ãŸã®ã‚€', r:'tanomu', m:'to ask a favour', pos:'verb (u)' },
  { k:'è¬ã‚‹', f:'ã‚ã‚„ã¾ã‚‹', r:'ayamaru', m:'to apologise', pos:'verb (u)' },
  { k:'ç­”ãˆã‚‹', f:'ã“ãŸãˆã‚‹', r:'kotaeru', m:'to answer', pos:'verb (ru)' },
  { k:'æ•™ãˆã‚‹', f:'ãŠã—ãˆã‚‹', r:'oshieru', m:'to teach', pos:'verb (ru)' },
  { k:'æ±ºã‚ã‚‹', f:'ãã‚ã‚‹', r:'kimeru', m:'to decide', pos:'verb (ru)' },
  { k:'ç¶šã‘ã‚‹', f:'ã¤ã¥ã‘ã‚‹', r:'tsuzukeru', m:'to continue', pos:'verb (ru)' },
  { k:'å¤‰ãˆã‚‹', f:'ã‹ãˆã‚‹', r:'kaeru', m:'to change something', pos:'verb (ru)' },
  { k:'ç¬‘ã†', f:'ã‚ã‚‰ã†', r:'warau', m:'to laugh / smile', pos:'verb (u)' },
  { k:'æ³£ã', f:'ãªã', r:'naku', m:'to cry', pos:'verb (u)' },
  { k:'æ€’ã‚‹', f:'ãŠã“ã‚‹', r:'okoru', m:'to get angry', pos:'verb (u)' },
  { k:'é©šã', f:'ãŠã©ã‚ã', r:'odoroku', m:'to be surprised', pos:'verb (u)' },
  { k:'å¿ƒé…ã™ã‚‹', f:'ã—ã‚“ã±ã„ã™ã‚‹', r:'shinpaisuru', m:'to worry', pos:'verb (suru)' },
  { k:'å–œã¶', f:'ã‚ˆã‚ã“ã¶', r:'yorokobu', m:'to be pleased', pos:'verb (u)' },
  { k:'å¤ªé™½', f:'ãŸã„ã‚ˆã†', r:'taiyou', m:'sun', pos:'noun' },
  { k:'å†™çœŸ', f:'ã—ã‚ƒã—ã‚“', r:'shashin', m:'photograph', pos:'noun' },
  { k:'éŸ³æ¥½', f:'ãŠã‚“ãŒã', r:'ongaku', m:'music', pos:'noun' },
  { k:'æ˜ ç”»', f:'ãˆã„ãŒ', r:'eiga', m:'movie / film', pos:'noun' },
  { k:'ç—…é™¢', f:'ã³ã‚‡ã†ã„ã‚“', r:'byouin', m:'hospital', pos:'noun' },
  { k:'è–¬', f:'ãã™ã‚Š', r:'kusuri', m:'medicine', pos:'noun' },
  { k:'ç¬‘é¡”', f:'ãˆãŒãŠ', r:'egao', m:'smiling face', pos:'noun' },
  { k:'æ„Ÿã˜', f:'ã‹ã‚“ã˜', r:'kanji', m:'feeling / impression', pos:'noun' },
  { k:'æ§˜å­', f:'ã‚ˆã†ã™', r:'yousu', m:'appearance / condition', pos:'noun' },
  { k:'äº‹æƒ…', f:'ã˜ã˜ã‚‡ã†', r:'jijou', m:'circumstances', pos:'noun' },
  { k:'å¤«å©¦', f:'ãµã†ãµ', r:'fuufu', m:'husband and wife', pos:'noun' },
  { k:'å­«', f:'ã¾ã”', r:'mago', m:'grandchild', pos:'noun' },
  { k:'ç¥–çˆ¶', f:'ããµ', r:'sofu', m:'grandfather (my)', pos:'noun' },
  { k:'ç¥–æ¯', f:'ãã¼', r:'sobo', m:'grandmother (my)', pos:'noun' },
  { k:'å¾Œè¼©', f:'ã“ã†ã¯ã„', r:'kouhai', m:'junior / younger colleague', pos:'noun' },
  { k:'å…ˆè¼©', f:'ã›ã‚“ã±ã„', r:'senpai', m:'senior / elder colleague', pos:'noun' },
  { k:'ä¸Šå¸', f:'ã˜ã‚‡ã†ã—', r:'joushi', m:'boss / superior', pos:'noun' },
  { k:'éƒ¨ä¸‹', f:'ã¶ã‹', r:'buka', m:'subordinate', pos:'noun' },
  { k:'ç· ã‚åˆ‡ã‚Š', f:'ã—ã‚ãã‚Š', r:'shimekiri', m:'deadline', pos:'noun' },
  { k:'äºˆå®š', f:'ã‚ˆã¦ã„', r:'yotei', m:'plan / schedule', pos:'noun' },
  { k:'é›†ã¾ã‚‹', f:'ã‚ã¤ã¾ã‚‹', r:'atsumaru', m:'to gather', pos:'verb (u)' },
  { k:'é›†ã‚ã‚‹', f:'ã‚ã¤ã‚ã‚‹', r:'atsumeru', m:'to collect', pos:'verb (ru)' },
  { k:'èª¿ã¹ã‚‹', f:'ã—ã‚‰ã¹ã‚‹', r:'shiraberu', m:'to investigate', pos:'verb (ru)' },
  { k:'æ¯”ã¹ã‚‹', f:'ãã‚‰ã¹ã‚‹', r:'kuraberu', m:'to compare', pos:'verb (ru)' },
  { k:'ä¼ãˆã‚‹', f:'ã¤ãŸãˆã‚‹', r:'tsutaeru', m:'to convey', pos:'verb (ru)' },
  { k:'å°‹ã­ã‚‹', f:'ãŸãšã­ã‚‹', r:'tazuneru', m:'to ask / visit', pos:'verb (ru)' },
  { k:'è¿·ã†', f:'ã¾ã‚ˆã†', r:'mayou', m:'to be lost / hesitate', pos:'verb (u)' },
  { k:'å¤¢è¦‹ã‚‹', f:'ã‚†ã‚ã¿ã‚‹', r:'yumemiru', m:'to dream', pos:'verb (ru)' },
];
extraN4more.forEach(w => vocab.N4.push(w));

// â”€â”€ Additional N3 words â”€â”€
const extraN3more = [
  { k:'æ„å›³', f:'ã„ã¨', r:'ito', m:'intention / purpose', pos:'noun' },
  { k:'å§¿å‹¢', f:'ã—ã›ã„', r:'shisei', m:'posture / attitude', pos:'noun' },
  { k:'é›°å›²æ°—', f:'ãµã‚“ã„ã', r:'fun\'iki', m:'atmosphere / mood', pos:'noun' },
  { k:'åˆºæ¿€', f:'ã—ã’ã', r:'shigeki', m:'stimulus / excitement', pos:'noun' },
  { k:'ä½™è£•', f:'ã‚ˆã‚†ã†', r:'yoyuu', m:'margin / composure', pos:'noun' },
  { k:'ç„¦ã‚Š', f:'ã‚ã›ã‚Š', r:'aseri', m:'impatience / anxiety', pos:'noun' },
  { k:'å……å®Ÿ', f:'ã˜ã‚…ã†ã˜ã¤', r:'juujitsu', m:'fulfilment', pos:'noun' },
  { k:'ç·Šå¼µ', f:'ãã‚“ã¡ã‚‡ã†', r:'kinchou', m:'tension / nervousness', pos:'noun' },
  { k:'å†’é™º', f:'ã¼ã†ã‘ã‚“', r:'bouken', m:'adventure', pos:'noun' },
  { k:'æŒ‘æˆ¦', f:'ã¡ã‚‡ã†ã›ã‚“', r:'chousen', m:'challenge', pos:'noun' },
  { k:'æˆé•·', f:'ã›ã„ã¡ã‚‡ã†', r:'seichou', m:'growth', pos:'noun' },
  { k:'ç›®çš„', f:'ã‚‚ãã¦ã', r:'mokuteki', m:'purpose / goal', pos:'noun' },
  { k:'æ‰‹æ®µ', f:'ã—ã‚…ã ã‚“', r:'shudan', m:'means / method', pos:'noun' },
  { k:'è¨¼æ˜Ž', f:'ã—ã‚‡ã†ã‚ã„', r:'shoumei', m:'proof / certificate', pos:'noun' },
  { k:'å°è±¡', f:'ã„ã‚“ã—ã‚‡ã†', r:'inshou', m:'impression', pos:'noun' },
  { k:'æ€§æ ¼', f:'ã›ã„ã‹ã', r:'seikaku', m:'personality / character', pos:'noun' },
  { k:'æ…‹åº¦', f:'ãŸã„ã©', r:'taido', m:'attitude', pos:'noun' },
  { k:'åˆ¤æ–­', f:'ã¯ã‚“ã ã‚“', r:'handan', m:'judgement', pos:'noun' },
  { k:'èƒ½åŠ›', f:'ã®ã†ã‚Šã‚‡ã', r:'nouryoku', m:'ability', pos:'noun' },
  { k:'å€‹æ€§', f:'ã“ã›ã„', r:'kosei', m:'individuality', pos:'noun' },
  { k:'é›†ä¸­åŠ›', f:'ã—ã‚…ã†ã¡ã‚…ã†ã‚Šã‚‡ã', r:'shuuchuulyoku', m:'concentration power', pos:'noun' },
  { k:'ä½“é¨“', f:'ãŸã„ã‘ã‚“', r:'taiken', m:'experience / encounter', pos:'noun' },
  { k:'è‡ªè¦š', f:'ã˜ã‹ã', r:'jikaku', m:'self-awareness', pos:'noun' },
  { k:'å·¥å¤«', f:'ããµã†', r:'kufuu', m:'device / clever idea', pos:'noun' },
  { k:'è¦³å¯Ÿ', f:'ã‹ã‚“ã•ã¤', r:'kansatsu', m:'observation', pos:'noun' },
  { k:'è³‡æ–™', f:'ã—ã‚Šã‚‡ã†', r:'shiryou', m:'materials / data', pos:'noun' },
  { k:'å®Ÿé¨“', f:'ã˜ã£ã‘ã‚“', r:'jikken', m:'experiment', pos:'noun' },
  { k:'å½±', f:'ã‹ã’', r:'kage', m:'shadow', pos:'noun' },
  { k:'å¤¢ä¸­', f:'ã‚€ã¡ã‚…ã†', r:'muchuu', m:'absorbed in / crazy about', pos:'noun/adj(na)' },
  { k:'é©šã', f:'ãŠã©ã‚ã', r:'odoroki', m:'surprise / astonishment', pos:'noun' },
  { k:'æ‚©ã‚€', f:'ãªã‚„ã‚€', r:'nayamu', m:'to worry / be troubled', pos:'verb (u)' },
  { k:'ä¹—ã‚Šè¶Šãˆã‚‹', f:'ã®ã‚Šã“ãˆã‚‹', r:'norikoeru', m:'to overcome', pos:'verb (ru)' },
  { k:'é ‘å¼µã‚‹', f:'ãŒã‚“ã°ã‚‹', r:'ganbaru', m:'to do one\'s best', pos:'verb (u)' },
  { k:'è«¦ã‚ã‚‹', f:'ã‚ãã‚‰ã‚ã‚‹', r:'akirameru', m:'to give up', pos:'verb (ru)' },
  { k:'æ°—ã¥ã', f:'ãã¥ã', r:'kizuku', m:'to notice / realise', pos:'verb (u)' },
  { k:'å‘ãåˆã†', f:'ã‚€ãã‚ã†', r:'mukiau', m:'to face / confront', pos:'verb (u)' },
  { k:'å–ã‚Šçµ„ã‚€', f:'ã¨ã‚Šãã‚€', r:'torikumu', m:'to tackle / work on', pos:'verb (u)' },
  { k:'ç£¨ã', f:'ã¿ãŒã', r:'migaku', m:'to polish / improve', pos:'verb (u)' },
  { k:'è‚²ã‚€', f:'ã¯ããã‚€', r:'hagukumu', m:'to nurture / foster', pos:'verb (u)' },
  { k:'æŽ¢ã™', f:'ã•ãŒã™', r:'sagasu', m:'to search', pos:'verb (u)' },
  { k:'è©¦ã¿ã‚‹', f:'ã“ã“ã‚ã¿ã‚‹', r:'ã“ã“ã‚ã¿ã‚‹', m:'to attempt', pos:'verb (ru)' },
  { k:'ç¹°ã‚Šè¿”ã™', f:'ãã‚Šã‹ãˆã™', r:'kurikaesu', m:'to repeat', pos:'verb (u)' },
  { k:'ç›®æŒ‡ã™', f:'ã‚ã–ã™', r:'mezasu', m:'to aim for', pos:'verb (u)' },
  { k:'å¼•ãè¾¼ã‚€', f:'ã²ãã“ã‚€', r:'hikikomu', m:'to draw in / attract', pos:'verb (u)' },
  { k:'ç©ã¿é‡ã­ã‚‹', f:'ã¤ã¿ã‹ã•ã­ã‚‹', r:'tsumikasaneru', m:'to accumulate', pos:'verb (ru)' },
  { k:'åºƒãŒã‚‹', f:'ã²ã‚ãŒã‚‹', r:'hirogaru', m:'to spread / expand', pos:'verb (u)' },
  { k:'æ·±ã¾ã‚‹', f:'ãµã‹ã¾ã‚‹', r:'fukamaru', m:'to deepen', pos:'verb (u)' },
  { k:'çœŸå‰£', f:'ã—ã‚“ã‘ã‚“', r:'shinken', m:'serious / earnest', pos:'adj (na)' },
  { k:'ç´ ç›´', f:'ã™ãªãŠ', r:'sunao', m:'obedient / honest', pos:'adj (na)' },
  { k:'æŸ”è»Ÿ', f:'ã˜ã‚…ã†ãªã‚“', r:'juunan', m:'flexible', pos:'adj (na)' },
  { k:'æ…Žé‡', f:'ã—ã‚“ã¡ã‚‡ã†', r:'shinchou', m:'careful / cautious', pos:'adj (na)' },
  { k:'å¼·å¼•', f:'ã”ã†ã„ã‚“', r:'gouin', m:'forceful / pushy', pos:'adj (na)' },
  { k:'çš„ç¢º', f:'ã¦ãã‹ã', r:'tekikaku', m:'accurate / precise', pos:'adj (na)' },
  { k:'é®®æ˜Ž', f:'ã›ã‚“ã‚ã„', r:'senmei', m:'clear / vivid', pos:'adj (na)' },
  { k:'å­¤ç‹¬', f:'ã“ã©ã', r:'kodoku', m:'solitude / loneliness', pos:'noun/adj(na)' },
  { k:'èª å®Ÿ', f:'ã›ã„ã˜ã¤', r:'seijitsu', m:'sincere / honest', pos:'adj (na)' },
  { k:'è³¢ã„', f:'ã‹ã—ã“ã„', r:'kashikoi', m:'clever / wise', pos:'adj (i)' },
  { k:'æ„šã‹', f:'ãŠã‚ã‹', r:'oroka', m:'foolish / stupid', pos:'adj (na)' },
  { k:'ã²ãŸã‚€ã', f:'ã²ãŸã‚€ã', r:'hitamuki', m:'single-minded / devoted', pos:'adj (na)' },
  { k:'æ„å¤–', f:'ã„ãŒã„', r:'igai', m:'unexpected / surprising', pos:'adj (na)' },
  { k:'ä¸æ€è­°', f:'ãµã—ãŽ', r:'fushigi', m:'mysterious / strange', pos:'adj (na)' },
  { k:'è²´é‡', f:'ãã¡ã‚‡ã†', r:'kichou', m:'precious / valuable', pos:'adj (na)' },
];
extraN3more.forEach(w => vocab.N3.push(w));

// â”€â”€ Additional N2 words â”€â”€
const extraN2more2 = [
  { k:'é†¸æˆ', f:'ã˜ã‚‡ã†ã›ã„', r:'jousei', m:'fostering / cultivating (atmosphere)', pos:'verb (suru)' },
  { k:'ç”»æœŸçš„', f:'ã‹ã£ãã¦ã', r:'kakkiteki', m:'epoch-making / groundbreaking', pos:'adj (na)' },
  { k:'è«–è¨¼', f:'ã‚ã‚“ã—ã‚‡ã†', r:'ronshou', m:'logical proof', pos:'noun' },
  { k:'æš—ç¤º', f:'ã‚ã‚“ã˜', r:'anji', m:'implication / hint', pos:'noun' },
  { k:'ç«¯çš„', f:'ãŸã‚“ã¦ã', r:'tanteki', m:'concise / direct', pos:'adj (na)' },
  { k:'è“„ç©', f:'ã¡ãã›ã', r:'chikuseki', m:'accumulation', pos:'noun' },
  { k:'æ¦‚ç®—', f:'ãŒã„ã•ã‚“', r:'gaisan', m:'rough estimate', pos:'noun' },
  { k:'å‰å¾Œ', f:'ãœã‚“ã”', r:'zengo', m:'before and after / approximately', pos:'noun' },
  { k:'æ¯”çŽ‡', f:'ã²ã‚Šã¤', r:'hiritsu', m:'ratio / percentage', pos:'noun' },
  { k:'å‰²åˆ', f:'ã‚ã‚Šã‚ã„', r:'wariai', m:'proportion / rate', pos:'noun' },
  { k:'éŽå‰°', f:'ã‹ã˜ã‚‡ã†', r:'kajou', m:'excess / surplus', pos:'noun/adj(na)' },
  { k:'ä¸è¶³', f:'ãµãã', r:'fusoku', m:'shortage / insufficiency', pos:'noun' },
  { k:'å‡è¡¡', f:'ãã‚“ã“ã†', r:'kinkou', m:'balance / equilibrium', pos:'noun' },
  { k:'è£é‡', f:'ã•ã„ã‚Šã‚‡ã†', r:'sairyou', m:'discretion', pos:'noun' },
  { k:'æ–½è¡Œ', f:'ã—ã“ã†', r:'shikou', m:'enforcement / implementation', pos:'noun' },
  { k:'æ‡¸å¿µ', f:'ã‘ã­ã‚“', r:'kenen', m:'concern / worry', pos:'noun' },
  { k:'æ‰“é–‹', f:'ã ã‹ã„', r:'dakai', m:'break through / resolve', pos:'noun' },
  { k:'åŽæŸ', f:'ã—ã‚…ã†ãã', r:'shuusoku', m:'convergence / settling down', pos:'noun' },
  { k:'é¡•åœ¨åŒ–', f:'ã‘ã‚“ã–ã„ã‹', r:'kenzaika', m:'becoming visible / surfacing', pos:'noun' },
  { k:'æ½œåœ¨', f:'ã›ã‚“ã–ã„', r:'senzai', m:'latent / potential', pos:'adj (na)' },
  { k:'å–šèµ·', f:'ã‹ã‚“ã', r:'kanki', m:'arousing / calling attention', pos:'noun' },
  { k:'æ³¢åŠ', f:'ã¯ãã‚…ã†', r:'hakyuu', m:'spreading / ripple effect', pos:'noun' },
  { k:'ç·©è¡', f:'ã‹ã‚“ã—ã‚‡ã†', r:'kanshou', m:'buffer / cushion', pos:'noun' },
  { k:'äºˆé˜²', f:'ã‚ˆã¼ã†', r:'yobou', m:'prevention', pos:'noun' },
  { k:'æŽ’é™¤', f:'ã¯ã„ã˜ã‚‡', r:'haijo', m:'exclusion / removal', pos:'noun' },
  { k:'æŽªç½®', f:'ãã¡', r:'sochi', m:'measure / step (action)', pos:'noun' },
  { k:'åæ˜ ', f:'ã¯ã‚“ãˆã„', r:'hanei', m:'reflection / feedback', pos:'noun' },
  { k:'æ˜¯æ­£', f:'ãœã›ã„', r:'zesei', m:'correction / rectification', pos:'noun' },
  { k:'å…·ç¾åŒ–', f:'ãã’ã‚“ã‹', r:'gugenko', m:'realisation / embodiment', pos:'noun' },
  { k:'å……å½“', f:'ã˜ã‚…ã†ã¨ã†', r:'juutou', m:'allocation / appropriation', pos:'noun' },
];
extraN2more2.forEach(w => vocab.N2.push(w));

// â”€â”€ Additional N1 words â”€â”€
const extraN1more = [
  { k:'é€¡å·¡', f:'ã—ã‚…ã‚“ã˜ã‚…ã‚“', r:'shunjun', m:'hesitation / wavering', pos:'noun' },
  { k:'å¹½çŽ„', f:'ã‚†ã†ã’ã‚“', r:'yuugen', m:'subtle profound beauty', pos:'adj (na)' },
  { k:'å¿–åº¦', f:'ãã‚“ãŸã', r:'sontaku', m:'reading the air / second-guessing', pos:'noun' },
  { k:'å¤‰é·', f:'ã¸ã‚“ã›ã‚“', r:'hensen', m:'transition / change over time', pos:'noun' },
  { k:'æ£æ„çš„', f:'ã—ã„ã¦ã', r:'shiiteki', m:'arbitrary / capricious', pos:'adj (na)' },
  { k:'æ‘©æ“¦', f:'ã¾ã•ã¤', r:'masatsu', m:'friction / conflict', pos:'noun' },
  { k:'æ–Ÿé…Œ', f:'ã—ã‚“ã—ã‚ƒã', r:'shinshaku', m:'consideration / discretion', pos:'noun' },
  { k:'å–§å™ª', f:'ã‘ã‚“ãã†', r:'kensou', m:'noise / clamour', pos:'noun' },
  { k:'éš”çµ¶', f:'ã‹ããœã¤', r:'kakuzetsu', m:'isolation / separation', pos:'noun' },
  { k:'å¥”æ”¾', f:'ã»ã‚“ã½ã†', r:'honpou', m:'uninhibited / free-spirited', pos:'adj (na)' },
  { k:'éŒ¯ç¶œ', f:'ã•ããã†', r:'sakusou', m:'complexity / confusion', pos:'noun' },
  { k:'ä½‡ã‚€', f:'ãŸãŸãšã‚€', r:'tatazumu', m:'to stand still / linger', pos:'verb (u)' },
  { k:'æŽŒæ¡', f:'ã—ã‚‡ã†ã‚ã', r:'shouaku', m:'grasping / controlling', pos:'noun' },
  { k:'å‚‘å‡º', f:'ã‘ã£ã—ã‚…ã¤', r:'kesshutu', m:'outstanding / remarkable', pos:'noun' },
  { k:'çŸœæŒ', f:'ãã‚‡ã†ã˜', r:'kyouji', m:'pride / self-respect', pos:'noun' },
  { k:'é†¸ã—å‡ºã™', f:'ã‹ã‚‚ã—ã ã™', r:'kamoshidasu', m:'to create / exude (atmosphere)', pos:'verb (u)' },
  { k:'æ¼¸é€²', f:'ãœã‚“ã—ã‚“', r:'zenshin', m:'gradual progress', pos:'noun' },
  { k:'ç²›ç„¶', f:'ã—ã‚…ããœã‚“', r:'shukuzen', m:'solemn / grave', pos:'adj (na)' },
  { k:'å—œå¥½', f:'ã—ã“ã†', r:'shikou', m:'taste / preference', pos:'noun' },
  { k:'å‡Œé§•', f:'ã‚Šã‚‡ã†ãŒ', r:'ryouga', m:'surpassing / exceeding', pos:'noun' },
  { k:'æ‡ˆæ€ ', f:'ã‘ãŸã„', r:'ketai', m:'negligence / sloth', pos:'noun' },
  { k:'é€¡å·¡', f:'ã—ã‚…ã‚“ã˜ã‚…ã‚“', r:'shunjun', m:'hesitation / indecision', pos:'noun' },
  { k:'ç«¯ç·’', f:'ãŸã‚“ã—ã‚‡', r:'tansho', m:'beginning / clue', pos:'noun' },
  { k:'ä¿¯çž°', f:'ãµã‹ã‚“', r:'fukan', m:'bird\'s-eye view', pos:'noun' },
  { k:'æ¦‚å˜†', f:'ãŒã„ãŸã‚“', r:'gaitan', m:'lamentation', pos:'noun' },
  { k:'è„ˆçµ¡', f:'ã¿ã‚ƒãã‚‰ã', r:'myakuraku', m:'context / connection', pos:'noun' },
  { k:'ç¤ºå”†', f:'ã—ã•', r:'shisa', m:'suggestion / implication', pos:'noun' },
  { k:'é¡›æœ«', f:'ã¦ã‚“ã¾ã¤', r:'tenmatsu', m:'course of events / outcome', pos:'noun' },
  { k:'ç‹­é‡', f:'ãã‚‡ã†ã‚Šã‚‡ã†', r:'kyouryou', m:'narrow-minded', pos:'noun/adj(na)' },
  { k:'æ…®ã‚‹', f:'ãŠã‚‚ã‚“ã±ã‹ã‚‹', r:'omonpakaru', m:'to consider carefully', pos:'verb (u)' },
  { k:'æºæ›³', f:'ã‚ˆã†ãˆã„', r:'youei', m:'swaying / trailing', pos:'noun' },
  { k:'å¯‚å¯¥', f:'ã›ãã‚Šã‚‡ã†', r:'sekiryou', m:'loneliness / solitude', pos:'noun' },
  { k:'æ‰•æ‹­', f:'ãµã£ã—ã‚‡ã', r:'fusshoku', m:'wiping out / dispelling', pos:'noun' },
  { k:'éŒšã€…', f:'ãã†ãã†', r:'sousou', m:'distinguished / prominent', pos:'adj (na)' },
  { k:'æ¬æ·¡', f:'ã¦ã‚“ãŸã‚“', r:'tentan', m:'indifferent / calm', pos:'adj (na)' },
  { k:'æ˜Žå“²', f:'ã‚ã„ã¦ã¤', r:'meitetsu', m:'wisdom / sagacity', pos:'noun' },
  { k:'é¼“èˆž', f:'ã“ã¶', r:'kobu', m:'encouragement / inspiration', pos:'noun' },
  { k:'ç…©æ‚¶', f:'ã¯ã‚“ã‚‚ã‚“', r:'hanmon', m:'anguish / distress', pos:'noun' },
  { k:'å¥”èµ°', f:'ã»ã‚“ãã†', r:'honsou', m:'running about / busy efforts', pos:'noun' },
  { k:'æ¸¾èº«', f:'ã“ã‚“ã—ã‚“', r:'konshin', m:'with all one\'s might', pos:'noun' },
];
extraN1more.forEach(w => vocab.N1.push(w));


Object.keys(vocab).forEach(lv => {
  const seen = new Set();
  vocab[lv] = vocab[lv].filter(w => { if (seen.has(w.k)) return false; seen.add(w.k); return true; });
});

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// STATE
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const SESSION_SIZE = 15;
let currentLevel = 'N5', currentMode = 'meaning';
let pool = [], qIdx = 0, score = 0, lives = 3, results = [];
let answered = false;
let currentEntry = null;
let sessionSize = 10; // Words per session: 10, 25, or 'all'

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// HOME UI
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function loadHomeQuote() {
  const q = animeQuotes[Math.floor(Math.random() * animeQuotes.length)];
  document.getElementById('homeQuoteJP').textContent = q.jp;
  document.getElementById('homeQuoteEN').textContent = q.en;
  document.getElementById('homeQuoteSRC').textContent = q.src;
}

// â”€â”€ LEVEL PICKER â”€â”€
function pickLevel(lv) {
  soundClick();
  currentLevel = lv;
  const lvMeta = {
    N5:{ title:'ðŸ¥‹ GENIN â€” Complete Beginner', color:'var(--n5)' },
    N4:{ title:'âš”ï¸ CHUNIN â€” Elementary',        color:'var(--n4)' },
    N3:{ title:'ðŸ—¡ï¸ JONIN â€” Intermediate',        color:'var(--n3)' },
    N2:{ title:'ðŸ‘ï¸ ANBU â€” Upper Intermediate',   color:'var(--n2)' },
    N1:{ title:'ðŸŒŸ KAGE â€” Advanced Â· Native',    color:'var(--n1)' },
  };
  const total = vocab[lv]?.length || 0;
  const m = lvMeta[lv];

  document.getElementById('msBadge').textContent = lv;
  document.getElementById('msBadge').style.color = m.color;
  document.getElementById('msTitle').textContent = m.title;
  document.getElementById('msSub').textContent   = `${total} words available in ${lv}`;

  // random anime quote
  const q = animeQuotes[Math.floor(Math.random()*animeQuotes.length)];
  document.getElementById('msQuote').innerHTML =
    `<span style="font-family:'Noto Serif JP',serif;color:var(--ink)">${q.jp}</span><br>` +
    `<em style="font-size:0.76rem">${q.en}</em> <span style="font-size:0.66rem">${q.src}</span>`;

  // reset to Meaning mode
  document.querySelectorAll('.ms-mode-card').forEach(c=>c.classList.remove('active'));
  document.querySelector('.ms-mode-card[data-mode="meaning"]').classList.add('active');
  currentMode = 'meaning';
  document.getElementById('msSizeSection').style.display = '';
  updateMsSizeHint();

  showScreen('modeScreen');
}

// â”€â”€ MODE TILE CLICK â”€â”€
function pickMode(el) {
  soundClick();
  document.querySelectorAll('.ms-mode-card').forEach(c=>c.classList.remove('active'));
  el.classList.add('active');
  currentMode = el.dataset.mode;
  document.getElementById('msSizeSection').style.display =
    currentMode === 'pastpaper' ? 'none' : '';
}

// â”€â”€ SESSION SIZE â”€â”€
function pickSize(el, sz) {
  sessionSize = sz;
  document.querySelectorAll('.ms-size-pill').forEach(p=>p.classList.remove('active'));
  el.classList.add('active');
  updateMsSizeHint();
}

function updateMsSizeHint() {
  const total = vocab[currentLevel]?.length || 0;
  const el = document.getElementById('msSizeHint');
  if (!el) return;
  el.textContent = sessionSize === 'all'
    ? `All ${total} words â€” full deck, no repeats`
    : `${sessionSize} random words from ${total} available`;
}

// â”€â”€ COMPATIBILITY SHIMS (old function names still work) â”€â”€
function selectLevel(el) { pickLevel(el.dataset?.level || el); }
function selectMode(el)   { pickMode(el); }
function setSessionSize(el,sz) { pickSize(el,sz); }
function updateStudyAllSub() { updateMsSizeHint(); }

// â”€â”€ GO HOME â”€â”€
function goHome() {
  clearInterval(ppTimer);
  isDailyChallengeMode = false;
  _streakCount = 0;
  const dcHeader = document.getElementById('dcGameHeader');
  if (dcHeader) dcHeader.style.display = 'none';
  showScreen('homeScreen');
  initHomeUI();
  initDailyChallenge();
}

// â”€â”€ CONTINUE SAVED SESSION â”€â”€
function continueIfSaved() {
  const p = getProgress();
  if (p.savedSession) { continueSession(); }
  else { alert('No saved session found. Pick a level to start!'); }
}

function confirmBack() {
  const o = document.getElementById('backConfirmOverlay');
  if(o) o.style.display='flex';
}
function closeBackConfirm() {
  const o = document.getElementById('backConfirmOverlay');
  if(o) o.style.display='none';
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// GAME FLOW
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

function startGame() {
  // Past paper mode gets its own flow
  if (currentMode === 'pastpaper') { startPastPaper(); return; }

  isDailyChallengeMode = false;
  _currentSensei = SENSEIS[Math.floor(Math.random() * SENSEIS.length)];
  _streakCount = 0;
  qIdx = 0; score = 0; lives = 3; results = []; answered = false; _sessionXP = 0;

  const dcHeader = document.getElementById('dcGameHeader');
  if (dcHeader) dcHeader.style.display = 'none';

  const allWords = [...vocab[currentLevel]];
  // Build pool based on sessionSize
  if (sessionSize === 'all') {
    const p = getProgress();
    const seen = new Set(p.seenWords[currentLevel] || []);
    const unseen = allWords.filter(w => !seen.has(w.k));
    const seenArr = allWords.filter(w => seen.has(w.k));
    pool = [...shuffle(unseen), ...shuffle(seenArr)];
  } else {
    pool = shuffle(allWords).slice(0, sessionSize);
  }

  const lv = currentLevel;
  document.getElementById('progFill').style.background = `linear-gradient(90deg, ${lvlColor[lv]}, #f39c12)`;
  document.getElementById('gtLevel').textContent = `JLPT ${lv}`;
  document.getElementById('gtLevel').style.color = lvlColor[lv];
  document.getElementById('gtRank').textContent = lvlRanks[lv];

  showScreen('gameScreen');
  updateXpHUD();
  updateQCounter();
  renderQ();
}

function updateQCounter() {
  const total = vocab[currentLevel]?.length || pool.length;
  const el = document.getElementById('qCounter');
  if (el) el.innerHTML = `Question <span>${qIdx + 1}</span> of <span>${pool.length}</span> Â· <span>${total}</span> total words in ${currentLevel}`;
}

function nextQ() {
  saveInProgressSession(currentLevel, currentMode, pool, qIdx+1, score, lives, results);
  qIdx++;

  // Daily challenge completion check
  if (isDailyChallengeMode && qIdx >= DC_SIZE) {
    endDailyChallenge();
    return;
  }

  if (qIdx >= pool.length || lives <= 0) { endGame(); return; }
  answered = false;
  const card = document.getElementById('qCard');
  card.style.animation = 'none'; void card.offsetWidth;
  card.style.animation = 'fadeUp .4s ease both';

  // Update daily challenge game header
  if (isDailyChallengeMode) {
    const sub = document.getElementById('dcGameSub');
    if (sub) sub.textContent = `Question ${qIdx+1} of ${DC_SIZE} Â· 2Ã— Bonus XP active`;
  }

  updateQCounter();
  renderQ();
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// QUESTION RENDERING
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderQ() {
  answered = false;
  currentEntry = pool[qIdx];
  const total = pool.length;
  document.getElementById('gtProg') && (document.getElementById('gtProg') ? null : null);
  document.getElementById('gtScore').textContent = score;
  document.getElementById('gtLives').textContent = 'â¤ï¸'.repeat(Math.max(0,lives)) + 'ðŸ–¤'.repeat(3-Math.max(0,lives));
  document.getElementById('feedback').className = 'feedback';
  document.getElementById('nextBtn').className = 'next-btn';
  document.getElementById('senseiQuote').className = 'sensei-quote';
  document.getElementById('answerArea').innerHTML = '';
  document.getElementById('progFill').style.width = `${(qIdx/total)*100}%`;

  if (currentMode === 'meaning') renderMeaning(currentEntry);
  else if (currentMode === 'reading') renderReading(currentEntry);
  else if (currentMode === 'fill') renderFill(currentEntry);
  else renderFlash(currentEntry);
}

function wordHeader(entry) {
  return `
    <div class="word-header">
      <div class="kanji-display">${entry.k}</div>
      <div class="furigana-display">${entry.f}</div>
      <div class="romaji-display">${entry.r} Â· ${entry.pos}</div>
      <button class="origin-btn" onclick="openOrigin()" title="Kanji Origin">â›©ï¸</button>
    </div>`;
}

function renderMeaning(entry) {
  document.getElementById('qTag').textContent = 'ðŸ“˜ What does this mean?';
  document.getElementById('answerArea').innerHTML = wordHeader(entry) + `<div class="opts-grid" id="optGrid"></div>`;
  const distractors = shuffle(pool.filter(e=>e!==entry)).slice(0,3);
  let optIdx = 0;
  shuffle([entry,...distractors]).forEach(opt => {
    const btn = document.createElement('button');
    btn.className='opt-btn';
    const num = ++optIdx;
    btn.innerHTML = `<span style="position:absolute;left:10px;top:50%;transform:translateY(-50%);font-size:0.62rem;font-weight:700;color:var(--stone);opacity:.6">${num}</span>${opt.m}`;
    btn.style.position = 'relative';
    btn.onclick=()=>handleMCQ(btn, opt===entry, entry, document.getElementById('optGrid'));
    document.getElementById('optGrid').appendChild(btn);
  });
}

function renderReading(entry) {
  document.getElementById('qTag').textContent = 'ðŸ“– Choose the correct reading';
  document.getElementById('answerArea').innerHTML = wordHeader(entry).replace(entry.f,'???').replace(entry.r,'???') +
    `<div style="font-size:.82rem;font-weight:600;text-align:center;margin-bottom:16px;color:var(--stone)">Which reading is correct?</div>
    <div class="opts-grid" id="optGrid"></div>`;
  const distractors = shuffle(pool.filter(e=>e!==entry)).slice(0,3);
  let optIdx = 0;
  shuffle([entry,...distractors]).forEach(opt => {
    const btn = document.createElement('button');
    btn.className='opt-btn';
    const num = ++optIdx;
    btn.style.position = 'relative';
    btn.innerHTML=`<span style="position:absolute;left:10px;top:50%;transform:translateY(-50%);font-size:0.62rem;font-weight:700;color:var(--stone);opacity:.6">${num}</span>${opt.f}<br><small style="font-weight:500;color:#aaa">${opt.r}</small>`;
    btn.onclick=()=>handleMCQ(btn, opt===entry, entry, document.getElementById('optGrid'));
    document.getElementById('optGrid').appendChild(btn);
  });
}

function handleMCQ(btn, correct, entry, grid) {
  if (answered) return;
  answered = true;
  Array.from(grid.querySelectorAll('.opt-btn')).forEach(b=>b.disabled=true);

  // Track per-word accuracy
  recordWordAnswer(entry.k, correct);

  if (correct) {
    btn.classList.add('correct');
    const pts = getPoints();
    score += pts; results.push(true);
    soundCorrect();
    showXpPop(pts * 0.5, btn);
    showFeedback(true, `âœ… Correct! <b>${entry.k}</b> = "${entry.m}"`);
    // Show streak sensei on 3+ in a row
    _streakCount = (_streakCount || 0) + 1;
    if (_streakCount >= 3) {
      showSenseiCharacter('streak');
    } else {
      showSenseiCharacter('correct');
    }
  } else {
    btn.classList.add('wrong'); lives--;
    results.push(false);
    soundWrong();
    _streakCount = 0;
    Array.from(grid.querySelectorAll('.opt-btn')).forEach(b => {
      if (b.textContent===entry.m || b.innerHTML.includes(entry.f)) b.classList.add('correct');
    });
    showFeedback(false, `âŒ Answer: <b>${entry.k}</b> = "${entry.m}"`);
    showSenseiQuote();
  }
  updateHUD();
  updateXpHUD();
  document.getElementById('nextBtn').className = 'next-btn show';
}

function renderFill(entry) {
  document.getElementById('qTag').textContent = 'âœï¸ Type the English meaning';
  document.getElementById('answerArea').innerHTML = wordHeader(entry) + `
    <div class="fill-wrap">
      <input class="fill-inp" id="fillInp" placeholder="Type the meaning in Englishâ€¦" autocomplete="off">
      <button class="fill-sub" onclick="checkFill()">Check âœ“</button>
    </div>`;
  window._fillEntry = entry;
  document.getElementById('fillInp').addEventListener('keydown', e=>{ if(e.key==='Enter') checkFill(); });
  setTimeout(()=>document.getElementById('fillInp').focus(), 100);
}

function checkFill() {
  if (answered) return;
  const entry = window._fillEntry;
  const val = document.getElementById('fillInp').value.trim().toLowerCase();
  const keywords = entry.m.toLowerCase().split(/[\s\/]+/).filter(w=>w.length>2);
  const correct = keywords.some(kw=>val.includes(kw));
  answered = true;
  document.getElementById('fillInp').disabled = true;
  document.querySelector('.fill-sub').disabled = true;
  if (correct) {
    document.getElementById('fillInp').classList.add('correct');
    const pts = getPoints();
    score += pts; results.push(true);
    soundCorrect();
    showXpPop(pts * 0.5);
    showFeedback(true, `âœ… Correct! Full meaning: "${entry.m}"`);
  } else {
    document.getElementById('fillInp').classList.add('wrong');
    lives--; results.push(false);
    soundWrong();
    showFeedback(false, `âŒ The meaning is: <b>"${entry.m}"</b>`);
    showSenseiQuote();
  }
  updateHUD();
  updateXpHUD();
  document.getElementById('nextBtn').className = 'next-btn show';
}

function renderFlash(entry) {
  document.getElementById('qTag').textContent = 'ðŸƒ Tap the card to flip';
  document.getElementById('answerArea').innerHTML = `
    <div class="flashcard-scene" onclick="flipCard()">
      <div class="flashcard" id="flashCard">
        <div class="card-face">
          <div class="kanji-display">${entry.k}</div>
          <div class="furigana-display">${entry.f}</div>
          <div class="romaji-display">${entry.r}</div>
          <div class="flip-hint">Tap to reveal meaning â†“</div>
          <button class="origin-btn" style="position:relative;margin-top:10px" onclick="event.stopPropagation();openOrigin()">â›©ï¸ Origin</button>
        </div>
        <div class="card-face card-back">
          <div style="font-family:'Noto Serif JP',serif;font-size:1rem;color:#99f6e4;margin-bottom:8px">${entry.k}</div>
          <div style="font-size:1.4rem;font-weight:700;margin-bottom:8px">${entry.m}</div>
          <div style="font-size:0.78rem;color:#94a3b8">${entry.pos}</div>
        </div>
      </div>
    </div>
    <div class="flashcard-btns" id="fcBtns" style="display:none">
      <button class="fc-btn fc-miss" onclick="flashAnswer(false)">âœ— Didn't know</button>
      <button class="fc-btn fc-got" onclick="flashAnswer(true)">âœ“ Got it!</button>
    </div>`;
  window._flashEntry = entry;
}

function flipCard() {
  const card = document.getElementById('flashCard');
  card.classList.toggle('flipped');
  if (card.classList.contains('flipped')) document.getElementById('fcBtns').style.display='flex';
}

function flashAnswer(correct) {
  if (answered) return;
  answered = true;
  const entry = window._flashEntry;
  document.querySelectorAll('.fc-btn').forEach(b=>b.disabled=true);
  if (correct) {
    const pts = getPoints();
    score += pts; results.push(true);
    soundCorrect();
    showXpPop(pts * 0.5);
    showFeedback(true, `âœ… ${entry.k} = "${entry.m}"`);
  } else {
    lives--; results.push(false);
    soundWrong();
    showFeedback(false, `ðŸ“– ${entry.k} (${entry.f}) = "${entry.m}"`);
    showSenseiQuote();
  }
  updateHUD();
  updateXpHUD();
  document.getElementById('nextBtn').className = 'next-btn show';
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// SENSEI WRONG-ANSWER QUOTES
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showSenseiQuote() {
  showSenseiCharacter('wrong');
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ORIGIN PANEL
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function openOrigin() {
  const entry = currentEntry;
  if (!entry) return;
  const o = entry.origin;

  document.getElementById('opWord').textContent = entry.k;
  document.getElementById('opReading').textContent = `${entry.f} (${entry.r}) Â· ${entry.pos}`;
  document.getElementById('opPictograph').innerHTML = o.pictograph;
  document.getElementById('opLiteral').innerHTML = o.literal;
  document.getElementById('opHook').innerHTML = o.hook;

  const radEl = document.getElementById('opRadicals');
  radEl.innerHTML = '';
  (o.radicals || []).forEach(r => {
    const pill = document.createElement('div');
    pill.className = 'radical-pill';
    pill.innerHTML = `<span class="rp-kanji">${r.k}</span><span class="rp-mean">${r.m}</span>`;
    radEl.appendChild(pill);
  });

  const relEl = document.getElementById('opRelated');
  relEl.innerHTML = '';
  (o.related || []).forEach(r => {
    const chip = document.createElement('div');
    chip.className = 'related-chip';
    chip.textContent = r;
    relEl.appendChild(chip);
  });

  document.getElementById('originOverlay').classList.add('show');
}

function closeOrigin(e) {
  if (e.target === document.getElementById('originOverlay')) closeOriginBtn();
}
function closeOriginBtn() {
  document.getElementById('originOverlay').classList.remove('show');
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// EMAIL MODAL
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let emailShown = false;
function maybeShowEmail() {
  if (!emailShown && !localStorage.getItem('jlpt_email_shown')) {
    emailShown = true;
    setTimeout(() => document.getElementById('emailModal').classList.add('show'), 800);
  }
}
function handleEmailSignup() {
  localStorage.setItem('jlpt_email_shown', 'true');
  document.getElementById('emailModal').classList.remove('show');
}
function closeEmail() {
  localStorage.setItem('jlpt_email_shown', 'true');
  document.getElementById('emailModal').classList.remove('show');
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// SCORE SCREEN
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function endGame() {
  const earned = recordSession(currentLevel, pool, results);
  const correct = results.filter(Boolean).length;
  const total = results.length;

  // Record weekly data
  recordWeeklySession(earned, correct, total);

  // Check if player has now seen ALL words in this level
  const p = getProgress();
  const seenCount = p.seenWords[currentLevel]?.length || 0;
  const totalCount = vocab[currentLevel]?.length || 0;
  const justCompletedLevel = seenCount >= totalCount;

  showScreen('scoreScreen');
  maybeShowEmail();
  const pct = total > 0 ? correct/total : 0;

  // Check flawless achievement
  if (pct === 1 && total > 0) setTimeout(() => checkFlawless(), 1500);

  let jp, en, sub;
  if (pct===1)     {jp='å®Œç’§ï¼'; en='Perfect Score!';   sub='Flawless. You\'re ready for the real exam!';}
  else if(pct>=.8) {jp='ç´ æ™´ã‚‰ã—ã„ï¼'; en='Excellent!'; sub='Outstanding! Keep this pace and you\'ll pass.';}
  else if(pct>=.6) {jp='è‰¯ã„ï¼'; en='Good Work!';       sub='Solid effort â€” review the ones you missed.';}
  else if(pct>=.4) {jp='é ‘å¼µã‚Œï¼'; en='Keep Going!';    sub='Don\'t stop â€” every attempt makes you stronger.';}
  else             {jp='å¾©ç¿’ï¼'; en='Review Time!';      sub='Start with the basics and build your way up!';}

  document.getElementById('scoreJP').textContent = jp;
  document.getElementById('scoreEN').textContent = en;
  document.getElementById('scoreNum').textContent = correct;
  document.getElementById('scoreDenom').textContent = `/ ${total} correct`;
  document.getElementById('scoreSub').textContent = sub;
  document.getElementById('dotsRow').innerHTML = results.map(r=>`<div class="dot ${r?'hit':'miss'}">${r?'âœ…':'âŒ'}</div>`).join('');

  // XP Summary
  const prog = getXpProgress(p.totalXP || 0);
  const isPerfect = correct === total && total > 0;
  document.getElementById('sxpTitle').textContent = isPerfect
    ? `ðŸ† Perfect Bonus included!`
    : `${prog.current.badge} ${prog.current.name} â€” ${prog.inRank} / ${prog.next ? prog.rankTotal : 'âˆž'} XP to next rank`;
  document.getElementById('sxpSub').textContent = `Total XP: ${p.totalXP || 0} Â· Streak: ðŸ”¥${p.streak || 0}`;
  document.getElementById('sxpTotal').textContent = `+${earned}`;

  const q = animeQuotes[Math.floor(Math.random() * animeQuotes.length)];
  document.getElementById('sqJP').textContent = q.jp;
  document.getElementById('sqEN').textContent = q.en;
  document.getElementById('sqSRC').textContent = q.src;

  // Show "Read Story" button + Certificate if level was just completed
  const actionsEl = document.getElementById('scoreActions');
  if (actionsEl) {
    const existing = actionsEl.querySelector('.story-trigger-btn');
    if (existing) existing.remove();
    if (justCompletedLevel) {
      const storyBtn = document.createElement('button');
      storyBtn.className = 'sc-btn story-trigger-btn';
      storyBtn.style.cssText = 'background:linear-gradient(135deg,var(--crimson),#e74c3c);color:white;flex-basis:100%;font-size:1rem';
      storyBtn.innerHTML = `ðŸŽ‰ ${currentLevel} Complete! Read Your Story â†’`;
      storyBtn.onclick = () => showStoryScreen(pool);
      actionsEl.insertBefore(storyBtn, actionsEl.firstChild);
      // Show certificate after brief delay
      setTimeout(() => showCertificate(currentLevel), 1200);
    }
  }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// HELPERS
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function getPoints() { return {N5:10,N4:15,N3:20,N2:30,N1:50}[currentLevel]||10; }
function updateHUD() {
  document.getElementById('gtScore').textContent = score;
  document.getElementById('gtLives').textContent = 'â¤ï¸'.repeat(Math.max(0,lives)) + 'ðŸ–¤'.repeat(3-Math.max(0,lives));
}
function showFeedback(good, msg) {
  const fb = document.getElementById('feedback');
  fb.className = `feedback show ${good?'good':'bad'}`;
  fb.innerHTML = msg;
  // Add share word button on correct answers
  if (good && currentEntry) {
    const shareBtn = document.createElement('button');
    shareBtn.className = 'share-word-btn';
    shareBtn.innerHTML = 'ðŸ”— Share This Word';
    const entry = currentEntry;
    shareBtn.onclick = () => shareWord(entry.k, entry.f, entry.m);
    fb.appendChild(document.createElement('br'));
    fb.appendChild(shareBtn);
  }
}
function shuffle(arr) {
  const a=[...arr];
  for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}
  return a;
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// FLOATING KANJI CANVAS BACKGROUND
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const kanjiChars = ['æ°´','ç«','å±±','å·','æœ¨','æ—¥','æœˆ','é¢¨','é›¨','æµ·','ç©º','èŠ±','æ˜Ÿ','å¿ƒ','å¤¢','åŠ›','é“','å…‰','å½±','å‰£','é­‚','æ„›','å‹‡','æ™º','æ­¦','å¿','ä¾','é¬¼','é¾','ç¥ž','æ¼¢','èªž','å­—','æœ¬','å­¦','èª­','æ›¸','è©±','è´','è¦‹'];

function initCanvas() {
  const canvas = document.getElementById('kanjiCanvas');
  const ctx = canvas.getContext('2d');
  let W, H, particles = [];

  function resize() {
    W = canvas.width = window.innerWidth;
    H = canvas.height = window.innerHeight;
  }

  function Particle() {
    this.reset = function() {
      this.x = Math.random() * W;
      this.y = Math.random() * H + H;
      this.size = Math.random() * 28 + 14;
      this.speed = Math.random() * 0.4 + 0.15;
      this.drift = (Math.random() - 0.5) * 0.3;
      this.opacity = Math.random() * 0.6 + 0.2;
      this.char = kanjiChars[Math.floor(Math.random() * kanjiChars.length)];
      this.rotation = (Math.random() - 0.5) * 0.4;
      this.rotSpeed = (Math.random() - 0.5) * 0.003;
    };
    this.reset();
    this.y = Math.random() * H; // start spread across screen
  }

  resize();
  for (let i = 0; i < 28; i++) particles.push(new Particle());

  function draw() {
    ctx.clearRect(0, 0, W, H);
    ctx.font = `bold ${particles[0]?.size || 20}px 'Noto Serif JP', serif`;
    particles.forEach(p => {
      ctx.save();
      ctx.translate(p.x, p.y);
      ctx.rotate(p.rotation);
      ctx.globalAlpha = p.opacity;
      ctx.fillStyle = '#c0392b';
      ctx.font = `bold ${p.size}px 'Noto Serif JP', serif`;
      ctx.fillText(p.char, 0, 0);
      ctx.restore();
      p.y -= p.speed;
      p.x += p.drift;
      p.rotation += p.rotSpeed;
      if (p.y < -60) p.reset();
    });
    requestAnimationFrame(draw);
  }

  window.addEventListener('resize', resize);
  draw();
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// SOUND ENGINE (Web Audio API â€” no files needed)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let audioCtx = null;
function getAudio() {
  if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  return audioCtx;
}
function playTone(freq, type, duration, volume = 0.18, delay = 0) {
  try {
    const ctx = getAudio();
    const osc = ctx.createOscillator();
    const gain = ctx.createGain();
    osc.connect(gain); gain.connect(ctx.destination);
    osc.type = type; osc.frequency.value = freq;
    const t = ctx.currentTime + delay;
    gain.gain.setValueAtTime(volume, t);
    gain.gain.exponentialRampToValueAtTime(0.001, t + duration);
    osc.start(t); osc.stop(t + duration);
  } catch(e) {}
}
function soundCorrect() {
  playTone(523, 'sine', 0.12, 0.15);       // C5
  playTone(659, 'sine', 0.12, 0.15, 0.09); // E5
  playTone(784, 'sine', 0.18, 0.2, 0.17);  // G5
}
function soundWrong() {
  playTone(220, 'sawtooth', 0.15, 0.12);
  playTone(180, 'sawtooth', 0.15, 0.12, 0.12);
}
function soundLevelUp() {
  [523,587,659,698,784].forEach((f,i) => playTone(f,'sine',0.25,0.18,i*0.1));
}
function soundClick() {
  playTone(440, 'sine', 0.06, 0.07);
}
function soundXP() {
  playTone(880, 'sine', 0.08, 0.1);
  playTone(1047,'sine', 0.08, 0.1, 0.06);
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// XP SYSTEM
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const XP_RANKS = [
  { name:'Genin',       badge:'ðŸ¥‹', min:0    },
  { name:'Chunin',      badge:'âš”ï¸', min:200  },
  { name:'Jonin',       badge:'ðŸ—¡ï¸', min:500  },
  { name:'ANBU',        badge:'ðŸ‘ï¸', min:1000 },
  { name:'Kage',        badge:'ðŸŒŸ', min:2000 },
  { name:'Hokage',      badge:'ðŸ¯', min:4000 },
  { name:'Legendary',   badge:'ðŸ‰', min:7000 },
];
const XP_PER_LEVEL = [200, 300, 500, 1000, 2000, 3000, 3000];

function getXpRank(totalXp) {
  let rank = XP_RANKS[0];
  for (const r of XP_RANKS) { if (totalXp >= r.min) rank = r; else break; }
  return rank;
}
function getXpProgress(totalXp) {
  let rankIdx = 0;
  for (let i = 0; i < XP_RANKS.length; i++) { if (totalXp >= XP_RANKS[i].min) rankIdx = i; else break; }
  const current = XP_RANKS[rankIdx];
  const next = XP_RANKS[rankIdx + 1];
  if (!next) return { pct: 100, current, next: null, inRank: totalXp - current.min, rankTotal: 999999 };
  const inRank = totalXp - current.min;
  const rankTotal = next.min - current.min;
  return { pct: Math.round((inRank / rankTotal) * 100), current, next, inRank, rankTotal };
}

function calcSessionXP(results, level) {
  const lvlBonus = { N5:1, N4:1.2, N3:1.5, N2:2, N1:3 };
  const mult = lvlBonus[level] || 1;
  let xp = 0;
  const correct = results.filter(Boolean).length;
  xp += correct * 10 * mult;
  if (correct === results.length && results.length > 0) xp += 50 * mult; // perfect bonus
  return Math.round(xp);
}

let _sessionXP = 0; // XP earned this session

function updateXpHUD() {
  const p = getProgress();
  const totalXp = p.totalXP || 0;
  const prog = getXpProgress(totalXp);
  document.getElementById('xpRankBadge').textContent = prog.current.badge;
  document.getElementById('xpRankName').textContent = prog.current.name;
  document.getElementById('xpLabel').textContent = prog.next
    ? `${prog.inRank} / ${prog.rankTotal} XP`
    : `${totalXp} XP MAX`;
  document.getElementById('xpBarFill').style.width = prog.pct + '%';
  const streak = p.streak || 0;
  document.getElementById('xpStreakDisplay').textContent = streak > 0 ? `ðŸ”¥${streak}` : 'ðŸ”¥0';
}

function showXpPop(amount, el) {
  const pop = document.createElement('div');
  pop.className = 'xp-pop';
  pop.textContent = `+${Math.round(amount)} XP`;
  const rect = (el || document.getElementById('qCard')).getBoundingClientRect();
  pop.style.left = (rect.left + rect.width/2 - 30) + 'px';
  pop.style.top = (rect.top + 60) + 'px';
  document.body.appendChild(pop);
  setTimeout(() => pop.remove(), 1300);
}

function checkRankUp(oldXp, newXp) {
  const oldRank = getXpRank(oldXp);
  const newRank = getXpRank(newXp);
  if (newRank.name !== oldRank.name) {
    soundLevelUp();
    const toast = document.createElement('div');
    toast.className = 'levelup-toast';
    toast.textContent = `${newRank.badge} Rank Up! You are now ${newRank.name}!`;
    document.body.appendChild(toast);
    setTimeout(() => toast.remove(), 2700);
  }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// PERSISTENCE â€” localStorage helpers (UPDATED with XP)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function getProgress() {
  const raw = localStorage.getItem('jlpt_progress');
  const defaults = {
    seenWords: { N5:[], N4:[], N3:[], N2:[], N1:[] },
    streak: 0,
    lastVisit: null,
    totalSessions: 0,
    totalXP: 0,
    savedSession: null
  };
  return raw ? Object.assign(defaults, JSON.parse(raw)) : defaults;
}

function saveProgress(p) {
  localStorage.setItem('jlpt_progress', JSON.stringify(p));
}

function recordSession(lv, wordsStudied, sessionResults) {
  const p = getProgress();
  const today = new Date().toISOString().slice(0,10);
  const yesterday = new Date(Date.now()-86400000).toISOString().slice(0,10);

  // Update streak
  if (p.lastVisit === yesterday) p.streak = (p.streak||0) + 1;
  else if (p.lastVisit !== today) p.streak = 1;
  p.lastVisit = today;
  p.totalSessions = (p.totalSessions||0) + 1;

  // Mark words as seen
  wordsStudied.forEach(w => {
    if (!p.seenWords[lv].includes(w.k)) p.seenWords[lv].push(w.k);
  });

  // Award XP
  const earned = calcSessionXP(sessionResults || [], lv);
  const oldXp = p.totalXP || 0;
  p.totalXP = oldXp + earned;
  _sessionXP = earned;

  p.savedSession = null;
  saveProgress(p);

  // Check rank up after save
  setTimeout(() => checkRankUp(oldXp, p.totalXP), 800);
  return earned;
}

function saveInProgressSession(lv, mode, poolWords, qIdx, score, lives, results) {
  const p = getProgress();
  p.savedSession = { lv, mode, poolKeys: poolWords.map(w=>w.k), qIdx, score, lives, results };
  saveProgress(p);
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// HOME UI â€” welcome back + progress bars
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function initHomeUI() {
  const p   = getProgress();
  const rank = getXpRank(p.totalXP || 0);
  const totalWords = Object.values(p.seenWords).reduce((a,b)=>a+b.length,0);

  // stats pill
  if (p.totalSessions > 0) {
    const pill = document.getElementById('homePill');
    if (pill) {
      pill.style.display = 'flex';
      document.getElementById('hpXp').textContent     = `â­ ${p.totalXP||0} XP`;
      document.getElementById('hpStreak').textContent  = `ðŸ”¥ ${p.streak||0} day${(p.streak||0)!==1?'s':''}`;
      document.getElementById('hpRank').textContent    = `${rank.badge} ${rank.name}`;
    }
  }

  // progress rings (new IDs: lpr-N5, lpn-N5, lpt-N5)
  const CIRC = 131.9; // 2 * PI * 21
  ['N5','N4','N3','N2','N1'].forEach(lv => {
    const seen  = p.seenWords[lv]?.length || 0;
    const total = vocab[lv]?.length || 1;
    const pct   = Math.min(1, seen / total);
    const ringEl = document.getElementById(`lpr-${lv}`);
    const numEl  = document.getElementById(`lpn-${lv}`);
    const totEl  = document.getElementById(`lpt-${lv}`);
    if (ringEl) setTimeout(()=>{ ringEl.style.strokeDashoffset=(CIRC*(1-pct)).toFixed(2); }, 300);
    if (numEl)  numEl.textContent = seen;
    if (totEl)  totEl.textContent = `/${total}`;
  });
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// CONTINUE SESSION
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function continueSession() {
  const p = getProgress();
  const s = p.savedSession;
  if (!s) return;

  currentLevel = s.lv;
  currentMode = s.mode;
  qIdx = s.qIdx;
  score = s.score;
  lives = s.lives;
  results = s.results;
  answered = false;

  // Rebuild pool from keys
  const allWords = vocab[currentLevel];
  pool = s.poolKeys.map(k => allWords.find(w=>w.k===k)).filter(Boolean);
  if (pool.length === 0) { startGame(); return; }

  // Update header
  document.getElementById('progFill').style.background = `linear-gradient(90deg, ${lvlColor[currentLevel]}, #f39c12)`;
  document.getElementById('gtLevel').textContent = `JLPT ${currentLevel}`;
  document.getElementById('gtLevel').style.color = lvlColor[currentLevel];
  document.getElementById('gtRank').textContent = lvlRanks[currentLevel];

  showScreen('gameScreen');
  renderQ();
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// SHARE SYSTEM
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const SITE_URL = 'https://jlptvocabmaster.github.io/jlpt-vocab-master/';
let _shareText = '';
let _fanOpen = false;

function toggleShareFan() {
  _fanOpen = !_fanOpen;
  const fan = document.getElementById('shareFan');
  const fab = document.getElementById('shareFab');
  fan.classList.toggle('open', _fanOpen);
  fab.classList.toggle('open', _fanOpen);
  // Set default share text for the fan buttons
  _shareText = `ðŸ‡¯ðŸ‡µ Learn Japanese the anime way â€” JLPT Vocabulary Master covers N5 to N1 with kanji origin stories, memory hooks, and anime wisdom! Try it: ${SITE_URL}`;
}

// Close fan if clicking elsewhere
document.addEventListener('click', (e) => {
  if (_fanOpen && !document.getElementById('shareFabWrap').contains(e.target)) {
    _fanOpen = false;
    document.getElementById('shareFan').classList.remove('open');
    document.getElementById('shareFab').classList.remove('open');
  }
});

function openShareModal(text, icon = 'ðŸ“¤', title = 'Share') {
  _shareText = text;
  document.getElementById('shareModalIcon').textContent = icon;
  document.getElementById('shareModalTitle').textContent = title;
  document.getElementById('shareTextPreview').textContent = text;
  document.getElementById('copyLinkBtn').textContent = 'ðŸ”— Copy Link';
  document.getElementById('copyLinkBtn').classList.remove('copied');
  document.getElementById('shareModal').classList.add('show');
}

function closeShareModal(e) {
  if (!e || e.target === document.getElementById('shareModal')) {
    document.getElementById('shareModal').classList.remove('show');
  }
}

function shareApp() {
  const text = `ðŸ‡¯ðŸ‡µ Learn Japanese the anime way â€” JLPT Vocabulary Master is free forever! Quiz, flashcards, and kanji memory hooks for N5 to N1. Try it: ${SITE_URL}`;
  if (navigator.share) {
    navigator.share({ title: 'JLPT Vocabulary Master', text: text, url: SITE_URL }).catch(() => {});
    return;
  }
  openShareModal(text, 'ðŸ”—', 'Share This App');
}

function shareScore() {
  const correct = results.filter(Boolean).length;
  const total = results.length;
  const pct = Math.round((correct / total) * 100);
  const emoji = pct >= 90 ? 'ðŸ†' : pct >= 70 ? 'ðŸŽŒ' : pct >= 50 ? 'âœ¨' : 'ðŸ“–';
  const text = `${emoji} I scored ${correct}/${total} (${pct}%) on JLPT ${currentLevel} in Vocabulary Master ðŸ‡¯ðŸ‡µðŸ”¥\nCan you beat me? Try it free: ${SITE_URL}`;
  if (navigator.share) {
    navigator.share({ title: 'My JLPT Score', text: text, url: SITE_URL }).catch(() => {});
    return;
  }
  openShareModal(text, emoji, 'Share Your Score');
}

function shareWord(kanji, furigana, meaning) {
  const text = `ðŸ‡¯ðŸ‡µ Just learned ${kanji} (${furigana}) = "${meaning}" on JLPT Vocabulary Master!\nLearn Japanese the anime way ðŸ‘‰ ${SITE_URL}`;
  if (navigator.share) {
    navigator.share({ title: `Japanese Word: ${kanji}`, text: text, url: SITE_URL }).catch(() => {});
    return;
  }
  openShareModal(text, 'ðŸƒ', `Share: ${kanji}`);
}

function shareTo(platform) {
  const encoded = encodeURIComponent(_shareText);
  const urls = {
    twitter:  `https://twitter.com/intent/tweet?text=${encoded}`,
    whatsapp: `https://wa.me/?text=${encoded}`,
    facebook: `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(SITE_URL)}&quote=${encoded}`,
    linkedin: `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(SITE_URL)}`,
    reddit:   `https://www.reddit.com/submit?url=${encodeURIComponent(SITE_URL)}&title=${encodeURIComponent('ðŸ‡¯ðŸ‡µ JLPT Vocabulary Master â€” learn Japanese the anime way!')}`
  };
  if (urls[platform]) window.open(urls[platform], '_blank', 'width=620,height=520,noopener');
}

function copyLink() {
  const btn = document.getElementById('copyLinkBtn');
  navigator.clipboard.writeText(SITE_URL).then(() => {
    btn.textContent = 'âœ… Copied!';
    btn.classList.add('copied');
    setTimeout(() => {
      btn.textContent = 'ðŸ”— Copy Link';
      btn.classList.remove('copied');
    }, 2500);
  });
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// STORY SCREEN â€” pre-written per level (Option A)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const levelStories = {
  N5: {
    title:'æ°´ã¨ç«ã®å±±', title_en:'The Mountain of Water and Fire',
    story_jp:`<ruby>ä»Šæ—¥<rt>ãã‚‡ã†</rt></ruby>ã€<ruby>ç”°ä¸­<rt>ãŸãªã‹</rt></ruby>ã•ã‚“ã¯<ruby>å‹é”<rt>ã¨ã‚‚ã ã¡</rt></ruby>ã¨<ruby>å¤§ãã„<rt>ãŠãŠãã„</rt></ruby><ruby>å±±<rt>ã‚„ã¾</rt></ruby>ã¸<ruby>è¡Œãã¾ã™<rt>ã„ãã¾ã™</rt></ruby>ã€‚<ruby>å±±<rt>ã‚„ã¾</rt></ruby>ã®<ruby>å·<rt>ã‹ã‚</rt></ruby>ã®<ruby>æ°´<rt>ã¿ãš</rt></ruby>ã¯ã¨ã¦ã‚‚ãã‚Œã„ã§ã™ã€‚ãµãŸã‚Šã¯<ruby>æ°´<rt>ã¿ãš</rt></ruby>ã‚’<ruby>é£²ã¿ã¾ã™<rt>ã®ã¿ã¾ã™</rt></ruby>ã€‚ã€Œ<ruby>æ–°ã—ã„<rt>ã‚ãŸã‚‰ã—ã„</rt></ruby>ã¨ã“ã‚ãŒ<ruby>å¥½ã<rt>ã™ã</rt></ruby>ï¼ã€ã¨<ruby>ç”°ä¸­<rt>ãŸãªã‹</rt></ruby>ã•ã‚“ã¯<ruby>è¨€ã„ã¾ã™<rt>ã„ã„ã¾ã™</rt></ruby>ã€‚<ruby>å¤œ<rt>ã‚ˆã‚‹</rt></ruby>ã€<ruby>ç«<rt>ã²</rt></ruby>ã‚’ã¤ã‘ã¦ã€ãµãŸã‚Šã¯<ruby>é£Ÿã¹ã¾ã™<rt>ãŸã¹ã¾ã™</rt></ruby>ã€‚<ruby>å­¦æ ¡<rt>ãŒã£ã“ã†</rt></ruby>ã§ãªã‚‰ã£ãŸã“ã¨ã°ãŒã€ã“ã“ã§ãœã‚“ã¶<ruby>ç”Ÿãã¦ã„ã¾ã™<rt>ã„ãã¦ã„ã¾ã™</rt></ruby>ï¼`,
    story_en:`Today Tanaka goes to a big mountain with a friend. The river water is very clear. They both drink the water. "I love new places!" says Tanaka. At night they light a fire and eat together. Every word learned at school comes alive right here!`,
    moral:`The words you study aren't just for tests â€” they come alive in every adventure you take.`,
    words:[{k:'ä»Šæ—¥',f:'ãã‚‡ã†',m:'today'},{k:'å‹é”',f:'ã¨ã‚‚ã ã¡',m:'friend'},{k:'å¤§ãã„',f:'ãŠãŠãã„',m:'big'},{k:'å±±',f:'ã‚„ã¾',m:'mountain'},{k:'æ°´',f:'ã¿ãš',m:'water'},{k:'ç«',f:'ã²',m:'fire'},{k:'é£Ÿã¹ã‚‹',f:'ãŸã¹ã‚‹',m:'to eat'},{k:'å­¦æ ¡',f:'ãŒã£ã“ã†',m:'school'}]
  },
  N4: {
    title:'æ—…è¡Œã®é›»è©±', title_en:'The Forgotten Phone',
    story_jp:`<ruby>éˆ´æœ¨<rt>ã™ãšã</rt></ruby>ã•ã‚“ã¯<ruby>æ—…è¡Œ<rt>ã‚Šã‚‡ã“ã†</rt></ruby>ãŒ<ruby>å¾—æ„<rt>ã¨ãã„</rt></ruby>ã§ã™ã€‚ã‚ã‚‹<ruby>æ—¥<rt>ã²</rt></ruby>ã€<ruby>å¤©æ°—<rt>ã¦ã‚“ã</rt></ruby>ãŒã„ã„ã®ã§<ruby>æ—…è¡Œ<rt>ã‚Šã‚‡ã“ã†</rt></ruby>ã«<ruby>è¡Œãã¾ã™<rt>ã„ãã¾ã™</rt></ruby>ãŒã€<ruby>é›»è©±<rt>ã§ã‚“ã‚</rt></ruby>ã‚’<ruby>å¿˜ã‚Œã¾ã—ãŸ<rt>ã‚ã™ã‚Œã¾ã—ãŸ</rt></ruby>ï¼ã€Œ<ruby>è¦ªåˆ‡<rt>ã—ã‚“ã›ã¤</rt></ruby>ãª<ruby>äºº<rt>ã²ã¨</rt></ruby>ãŒ<ruby>åŠ©ã‘ã¦<rt>ãŸã™ã‘ã¦</rt></ruby>ãã‚Œã‚‹ã‹ãªã€ã¨<ruby>æ€ã„ã¾ã™<rt>ãŠã‚‚ã„ã¾ã™</rt></ruby>ã€‚<ruby>æ¯Žæ—¥<rt>ã¾ã„ã«ã¡</rt></ruby><ruby>æ–™ç†<rt>ã‚Šã‚‡ã†ã‚Š</rt></ruby>ã‚’<ruby>è¦šãˆãŸã‚Š<rt>ãŠã¼ãˆãŸã‚Š</rt></ruby>ã€<ruby>ç·´ç¿’<rt>ã‚Œã‚“ã—ã‚…ã†</rt></ruby>ã—ãŸã‚Šã—ãŸ<ruby>éˆ´æœ¨<rt>ã™ãšã</rt></ruby>ã•ã‚“ã¯ã€<ruby>æ—…å…ˆ<rt>ãŸã³ã•ã</rt></ruby>ã§ã‚‚<ruby>æ¥½ã—ã¿ã¾ã™<rt>ãŸã®ã—ã¿ã¾ã™</rt></ruby>ã€‚`,
    story_en:`Suzuki is great at travelling. One fine day she goes on a trip â€” but she forgot her phone! "I wonder if a kind person will help," she thinks. Having practised cooking and Japanese every day, Suzuki enjoys herself even far from home.`,
    moral:`Preparation and kindness are better travel companions than any smartphone.`,
    words:[{k:'æ—…è¡Œ',f:'ã‚Šã‚‡ã“ã†',m:'travel'},{k:'å¤©æ°—',f:'ã¦ã‚“ã',m:'weather'},{k:'é›»è©±',f:'ã§ã‚“ã‚',m:'phone'},{k:'å¿˜ã‚Œã‚‹',f:'ã‚ã™ã‚Œã‚‹',m:'to forget'},{k:'è¦ªåˆ‡',f:'ã—ã‚“ã›ã¤',m:'kind'},{k:'æ–™ç†',f:'ã‚Šã‚‡ã†ã‚Š',m:'cooking'},{k:'è¦šãˆã‚‹',f:'ãŠã¼ãˆã‚‹',m:'memorise'},{k:'ç·´ç¿’',f:'ã‚Œã‚“ã—ã‚…ã†',m:'practice'}]
  },
  N3: {
    title:'è²¬ä»»ã¨å¯èƒ½æ€§', title_en:'Responsibility and Possibility',
    story_jp:`<ruby>æ£®<rt>ã‚‚ã‚Š</rt></ruby>ã•ã‚“ã¯<ruby>ç’°å¢ƒ<rt>ã‹ã‚“ãã‚‡ã†</rt></ruby>ã®<ruby>ç ”ç©¶è€…<rt>ã‘ã‚“ãã‚…ã†ã—ã‚ƒ</rt></ruby>ã§ã™ã€‚<ruby>å½¼å¥³<rt>ã‹ã®ã˜ã‚‡</rt></ruby>ã¯<ruby>è¤‡é›‘<rt>ãµãã–ã¤</rt></ruby>ãª<ruby>å•é¡Œ<rt>ã‚‚ã‚“ã ã„</rt></ruby>ãŒ<ruby>å¥½ã<rt>ã™ã</rt></ruby>ã§ã™ã€‚ã€Œ<ruby>ç’°å¢ƒ<rt>ã‹ã‚“ãã‚‡ã†</rt></ruby>ã‚’<ruby>å®ˆã‚‹<rt>ã¾ã‚‚ã‚‹</rt></ruby>ã®ã¯<ruby>ç§ãŸã¡<rt>ã‚ãŸã—ãŸã¡</rt></ruby>ã®<ruby>è²¬ä»»<rt>ã›ãã«ã‚“</rt></ruby>ã§ã™ã€ã¨<ruby>è¨€ã„ã¾ã™<rt>ã„ã„ã¾ã™</rt></ruby>ã€‚ãã®<ruby>å½±éŸ¿<rt>ãˆã„ãã‚‡ã†</rt></ruby>ã¯<ruby>å¤§ãã„<rt>ãŠãŠãã„</rt></ruby>ã§ã™ã€‚ã—ã‹ã—<ruby>å¯èƒ½æ€§<rt>ã‹ã®ã†ã›ã„</rt></ruby>ã‚‚ã‚ã‚Šã¾ã™ã€‚<ruby>ä¸€äºº<rt>ã²ã¨ã‚Š</rt></ruby>ã²ã¨ã‚Šã®<ruby>åŠªåŠ›<rt>ã©ã‚Šã‚‡ã</rt></ruby>ãŒ<ruby>ä¸–ç•Œ<rt>ã›ã‹ã„</rt></ruby>ã‚’<ruby>å¤‰ãˆã‚‹<rt>ã‹ãˆã‚‹</rt></ruby><ruby>å¯èƒ½æ€§<rt>ã‹ã®ã†ã›ã„</rt></ruby>ã‚’<ruby>æŒã£ã¦ã„ã¾ã™<rt>ã‚‚ã£ã¦ã„ã¾ã™</rt></ruby>ã€‚`,
    story_en:`Mori is an environmental researcher who loves complex problems. "Protecting the environment is our responsibility," she says. The influence is great â€” but possibility exists. Each individual's effort holds the power to change the world.`,
    moral:`Complexity doesn't mean hopelessness â€” responsibility and possibility always walk together.`,
    words:[{k:'ç’°å¢ƒ',f:'ã‹ã‚“ãã‚‡ã†',m:'environment'},{k:'è¤‡é›‘',f:'ãµãã–ã¤',m:'complex'},{k:'è²¬ä»»',f:'ã›ãã«ã‚“',m:'responsibility'},{k:'å½±éŸ¿',f:'ãˆã„ãã‚‡ã†',m:'influence'},{k:'å¯èƒ½æ€§',f:'ã‹ã®ã†ã›ã„',m:'possibility'}]
  },
  N2: {
    title:'æ‰¹åˆ¤ã¨æ ¹æ‹ ', title_en:'Criticism and Evidence',
    story_jp:`<ruby>ä¼šè­°<rt>ã‹ã„ãŽ</rt></ruby>ã§<ruby>ç”°æ‘<rt>ãŸã‚€ã‚‰</rt></ruby>ã•ã‚“ã¯<ruby>ä¸»å¼µ<rt>ã—ã‚…ã¡ã‚‡ã†</rt></ruby>ã—ã¾ã—ãŸã€‚ã€Œã“ã®<ruby>è¨ˆç”»<rt>ã‘ã„ã‹ã</rt></ruby>ã¯<ruby>æ›–æ˜§<rt>ã‚ã„ã¾ã„</rt></ruby>ã§ã™ã€‚<ruby>æ ¹æ‹ <rt>ã“ã‚“ãã‚‡</rt></ruby>ãŒ<ruby>å¿…è¦<rt>ã²ã¤ã‚ˆã†</rt></ruby>ã§ã™ã€‚ã€<ruby>æ‰¹åˆ¤<rt>ã²ã¯ã‚“</rt></ruby>ã‚’<ruby>å—ã‘ãŸ<rt>ã†ã‘ãŸ</rt></ruby><ruby>ä¸Šå¸<rt>ã˜ã‚‡ã†ã—</rt></ruby>ã¯<ruby>æ„è­˜<rt>ã„ã—ã</rt></ruby>ã‚’<ruby>å¤‰ãˆã¾ã—ãŸ<rt>ã‹ãˆã¾ã—ãŸ</rt></ruby>ã€‚<ruby>å‚å‘<rt>ã‘ã„ã“ã†</rt></ruby>ã¨ã—ã¦<ruby>å¦–å”<rt>ã ãã‚‡ã†</rt></ruby>ãŒ<ruby>å¤šã„<rt>ãŠãŠã„</rt></ruby>è·å ´ã§ã™ãŒã€<ruby>ç”°æ‘<rt>ãŸã‚€ã‚‰</rt></ruby>ã•ã‚“ã¯<ruby>å…‹æœ<rt>ã“ããµã</rt></ruby>ã—ã¾ã—ãŸã€‚`,
    story_en:`At a meeting, Tamura made an assertion. "This plan is vague â€” we need evidence." The boss who received the criticism changed his awareness. Compromise is a common tendency at work, but Tamura overcame it.`,
    moral:`An assertion backed by solid evidence isn't aggression â€” it's the highest form of respect for your team.`,
    words:[{k:'ä¸»å¼µ',f:'ã—ã‚…ã¡ã‚‡ã†',m:'assertion'},{k:'æ›–æ˜§',f:'ã‚ã„ã¾ã„',m:'vague'},{k:'æ ¹æ‹ ',f:'ã“ã‚“ãã‚‡',m:'evidence'},{k:'æ‰¹åˆ¤',f:'ã²ã¯ã‚“',m:'criticism'},{k:'æ„è­˜',f:'ã„ã—ã',m:'awareness'},{k:'å‚å‘',f:'ã‘ã„ã“ã†',m:'tendency'},{k:'å¦–å”',f:'ã ãã‚‡ã†',m:'compromise'},{k:'å…‹æœ',f:'ã“ããµã',m:'overcome'}]
  },
  N1: {
    title:'å‰Žé‚£ã®è‘›è—¤', title_en:'The Inner Conflict of a Moment',
    story_jp:`<ruby>æ­¦å£«<rt>ã¶ã—</rt></ruby>ã¯<ruby>å‰Žé‚£<rt>ã›ã¤ãª</rt></ruby>ã®<ruby>è¿·ã„<rt>ã¾ã‚ˆã„</rt></ruby>ã®<ruby>ä¸­<rt>ãªã‹</rt></ruby>ã§<ruby>è‘›è—¤<rt>ã‹ã£ã¨ã†</rt></ruby>ã‚’<ruby>æŠ±ãˆã¦ã„ãŸ<rt>ã‹ã‹ãˆã¦ã„ãŸ</rt></ruby>ã€‚<ruby>è¹‰è·¤<rt>ã•ãŸ</rt></ruby>ã¨ã—ã¦<ruby>éŽã”ã—ãŸ<rt>ã™ã”ã—ãŸ</rt></ruby><ruby>æ­³æœˆ<rt>ã•ã„ã’ã¤</rt></ruby>ã‚’<ruby>æ€ã„<rt>ãŠã‚‚ã„</rt></ruby>ã€<ruby>æ„•å“­<rt>ã©ã†ã“ã</rt></ruby>ã—ãã†ã«ãªã‚‹ã€‚ã—ã‹ã—<ruby>è¬™è™š<rt>ã‘ã‚“ãã‚‡</rt></ruby>ã«<ruby>å·±<rt>ãŠã®ã‚Œ</rt></ruby>ã‚’<ruby>è¦‹ã¤ã‚<rt>ã¿ã¤ã‚</rt></ruby>ã€<ruby>ç¸¹æœ«<rt>ã•ã¾ã¤</rt></ruby>ãªã“ã¨ã«ã“ã ã‚‹ã®ã‚’ã‚„ã‚ãŸã€‚<ruby>ä»Š<rt>ã„ã¾</rt></ruby>ã“ã®<ruby>å‰Žé‚£<rt>ã›ã¤ãª</rt></ruby>ã“ããŒã€ã™ã¹ã¦ã®<ruby>ç­”ãˆ<rt>ã“ãŸãˆ</rt></ruby>ã ã£ãŸã€‚`,
    story_en:`The warrior bore inner conflict in a moment of hesitation. Recalling the years he had let slip by, he was nearly moved to wailing grief. But humbly gazing within himself, he stopped clinging to trivial things. This very instant was the answer to everything.`,
    moral:`The deepest conflicts dissolve not through action, but through humble recognition of what truly matters right now.`,
    words:[{k:'å‰Žé‚£',f:'ã›ã¤ãª',m:'a moment'},{k:'è‘›è—¤',f:'ã‹ã£ã¨ã†',m:'inner conflict'},{k:'è¹‰è·¤',f:'ã•ãŸ',m:'time slipping by'},{k:'æ„•å“­',f:'ã©ã†ã“ã',m:'wailing grief'},{k:'è¬™è™š',f:'ã‘ã‚“ãã‚‡',m:'humble'},{k:'ç¸¹æœ«',f:'ã•ã¾ã¤',m:'trivial'}]
  }
};

function showStoryScreen() {
  showScreen('storyScreen');
  const lv = currentLevel;
  const s  = levelStories[lv] || levelStories.N5;

  document.getElementById('storyBadge').textContent   = `ðŸŽ‰ ${lv} Complete!`;
  document.getElementById('storyTitle').textContent   = s.title;
  document.getElementById('storyHeroSub').textContent = `${s.title_en} â€” a story from ${lv}`;

  const chips = s.words.map(v => `
    <div class="story-vocab-chip">
      <div class="svc-kanji">${v.k}</div>
      <div class="svc-reading">${v.f}</div>
      <div class="svc-meaning">${v.m}</div>
    </div>`).join('');

  document.getElementById('storyBody').innerHTML = `
    <div class="story-section">
      <div class="story-section-label">ðŸ“– ${s.title_en.toUpperCase()}</div>
      <div class="story-jp">${s.story_jp}</div>
      <div class="story-en">${s.story_en}</div>
    </div>
    <div class="story-section">
      <div class="story-section-label">ðŸ’¡ LESSON</div>
      <div class="story-en" style="border-left-color:var(--crimson)">${s.moral}</div>
    </div>
    <div class="story-section">
      <div class="story-section-label">ðŸ“š KEY WORDS IN THIS STORY</div>
      <div class="story-vocab-grid">${chips}</div>
    </div>`;

  document.getElementById('storyActions').style.display = 'flex';
}
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// PAST PAPER QUIZ SYSTEM
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

const pastPapers = {
  N5: [
    { type:'vocab', year:'2023', q:'ï¼ˆã€€ï¼‰ã«ã€€ä½•ã‚’ã€€ã„ã‚Œã¾ã™ã‹ã€‚\nã€Œæ¯Žæœã€ï¼ˆã€€ï¼‰ã‚’ã€€é£²ã¿ã¾ã™ã€‚ã€', blank:'ã€€ã€€ã€€', opts:['ã¿ãš','ã‚„ã¾','ã‹ã‚','ãã‚‰'], ans:0, exp:'<strong>æ°´ï¼ˆã¿ãšï¼‰</strong> means "water". æ¯Žæœï¼ˆã¾ã„ã‚ã•ï¼‰= every morning. é£²ã‚€ï¼ˆã®ã‚€ï¼‰= to drink. "Every morning I drink water."' },
    { type:'vocab', year:'2023', q:'ä¸‹ã®ã€€ã“ã¨ã°ã®ã€€ã‚ˆã¿ã‹ãŸã‚’ã€€ãˆã‚‰ã³ãªã•ã„ã€‚\nã€Œå­¦æ ¡ã€', opts:['ãŒãã“ã†','ãŒã£ã“ã†','ãŒããã‚‡ã†','ãŒã£ãã‚‡ã†'], ans:1, exp:'<strong>å­¦æ ¡ï¼ˆãŒã£ã“ã†ï¼‰</strong> = school. The ã£ (small tsu) doubles the k sound: gak-kou. Common N5 word.' },
    { type:'grammar', year:'2022', q:'ï¼ˆã€€ï¼‰ã«ã€€æ­£ã—ã„ã€€ã“ã¨ã°ã‚’ã€€ã„ã‚Œã¦ãã ã•ã„ã€‚\nã€Œã‚ã—ãŸã€å‹é”ï¼ˆã€€ï¼‰ã€€ä¼šã„ã¾ã™ã€‚ã€', opts:['ã‚’','ã«','ã¯','ãŒ'], ans:1, exp:'<strong>ã«</strong> marks the target of movement/meeting verbs. å‹é”ã«ä¼šã† = meet a friend. ã« = "with/at" for meeting.' },
    { type:'vocab', year:'2022', q:'ã€Œå¤§ãã„ã€ã®ã€€ã¯ã‚“ãŸã„ã®ã€€ã“ã¨ã°ã¯ã€€ã©ã‚Œã§ã™ã‹ã€‚', opts:['æ–°ã—ã„','å°ã•ã„','å¥½ã','å¤šã„'], ans:1, exp:'<strong>å°ã•ã„ï¼ˆã¡ã„ã•ã„ï¼‰</strong> = small, is the opposite of å¤§ãã„ï¼ˆãŠãŠãã„ï¼‰= big/large.' },
    { type:'reading', year:'2023', q:'ã¤ãŽã®ã€€ã¶ã‚“ã‚’ã€€ã‚ˆã‚“ã§ã€ã“ãŸãˆãªã•ã„ã€‚\nã€Œç”°ä¸­ã•ã‚“ã¯ã€€æ¯Žæ—¥ã€€å­¦æ ¡ã¸ã€€è¡Œãã¾ã™ã€‚ä»Šæ—¥ã¯ã€€å‹é”ã¨ã€€é£Ÿã¹ã¾ã™ã€‚ã€\nç”°ä¸­ã•ã‚“ã¯ã€€ä»Šæ—¥ã€ãªã«ã‚’ã€€ã—ã¾ã™ã‹ã€‚', opts:['å­¦æ ¡ã¸ã€€è¡Œã','å‹é”ã¨ã€€é£Ÿã¹ã‚‹','æ°´ã‚’ã€€é£²ã‚€','å±±ã¸ã€€è¡Œã'], ans:1, exp:'The text says ç”°ä¸­ã•ã‚“ã¯å‹é”ã¨é£Ÿã¹ã¾ã™ = Tanaka eats with a friend today. Reading comprehension.' },
    { type:'vocab', year:'2022', q:'ã€Œä»Šæ—¥ã€ã®ã€€ã‚ˆã¿ã‹ãŸã¯ã€€ã©ã‚Œã§ã™ã‹ã€‚', opts:['ã“ã‚“ã«ã¡','ãã‚‡ã†','ã“ã‚“ã³','ã„ã¾ã«ã¡'], ans:1, exp:'<strong>ä»Šæ—¥ï¼ˆãã‚‡ã†ï¼‰</strong> = today. Irregular reading â€” not "imanichi" or "konbi". One of the most important N5 words.' },
    { type:'grammar', year:'2023', q:'ã€Œï¼ˆã€€ï¼‰ã„ãã¾ã™ã€\nã©ã‚ŒãŒã€€ãŸã ã—ã„ã§ã™ã‹ã€‚', opts:['å­¦æ ¡ã¸','å­¦æ ¡ã«','å­¦æ ¡ã‚’','å­¦æ ¡ãŒ'], ans:0, exp:'Both <strong>ã¸</strong> and ã« can mark destination, but ã¸ emphasises direction/movement toward a place. å­¦æ ¡ã¸è¡Œãã¾ã™ is the classic textbook form.' },
    { type:'vocab', year:'2021', q:'ã€Œç«ã€ã®ã€€ã‚ˆã¿ã‹ãŸã¯ã€€ã©ã‚Œã§ã™ã‹ã€‚', opts:['ã¿ãš','ã‹ã‚','ã²','ã'], ans:2, exp:'<strong>ç«ï¼ˆã²ï¼‰</strong> = fire. æ°´ï¼ˆã¿ãšï¼‰= water, å·ï¼ˆã‹ã‚ï¼‰= river, æœ¨ï¼ˆãï¼‰= tree. All N5 kanji you must know!' },
    { type:'reading', year:'2021', q:'ã€Œå±±ç”°ã•ã‚“ã¯ã€€æ–°ã—ã„ã€€å­¦æ ¡ãŒã€€å¥½ãã§ã™ã€‚å‹é”ã‚‚ã€€å¤šã„ã§ã™ã€‚ã€\nå±±ç”°ã•ã‚“ã«ã€€ã¤ã„ã¦ã€€ãŸã ã—ã„ã€€ã‚‚ã®ã¯ã€€ã©ã‚Œã§ã™ã‹ã€‚', opts:['å¤ã„ã€€å­¦æ ¡ãŒã€€å¥½ãã ','æ–°ã—ã„ã€€å­¦æ ¡ãŒã€€ãã‚‰ã„ã ','æ–°ã—ã„ã€€å­¦æ ¡ãŒã€€å¥½ãã ','å‹é”ãŒã€€å°‘ãªã„'], ans:2, exp:'<strong>æ–°ã—ã„å­¦æ ¡ãŒå¥½ã</strong> = likes the new school. å¤šã„ï¼ˆãŠãŠã„ï¼‰= many, so friends are many, not few.' },
    { type:'grammar', year:'2020', q:'ã€Œã‚Šã‚“ã”ã‚’ã€€ä¸‰ã¤ï¼ˆã€€ï¼‰ãã ã•ã„ã€‚ã€', opts:['ã¯','ã‚‚','ã‚’','âˆ…ï¼ˆãªã—ï¼‰'], ans:3, exp:'The particle after a counter is usually dropped or omitted in natural Japanese. ä¸‰ã¤ãã ã•ã„ is correct â€” no particle needed after the counter.' },
  ],
  N4: [
    { type:'vocab', year:'2023', q:'ã€Œé›»è©±ã€ã®ã€€ã‚ˆã¿ã‹ãŸã¯ã€€ã©ã‚Œã§ã™ã‹ã€‚', opts:['ã§ã‚“ã‚','ã¦ã‚“ã','ã‚Šã‚‡ã“ã†','ã‚Œã‚“ã—ã‚…ã†'], ans:0, exp:'<strong>é›»è©±ï¼ˆã§ã‚“ã‚ï¼‰</strong> = telephone. é›»ï¼ˆã§ã‚“ï¼‰= electricity, è©±ï¼ˆã‚ï¼‰= speaking. Electric speech = telephone!' },
    { type:'grammar', year:'2023', q:'ï¼ˆã€€ï¼‰ã«ã€€ãŸã ã—ã„ã€€ã“ã¨ã°ã‚’ã€€ã„ã‚Œã¦ãã ã•ã„ã€‚\nã€Œã‚‚ã£ã¨ã€€ç·´ç¿’ï¼ˆã€€ï¼‰ã€ä¸Šæ‰‹ã«ã€€ãªã‚Šã¾ã™ã€‚ã€', opts:['ã™ã‚Œã°','ã™ã‚‹ã¨','ã—ãŸã‚‰','ã—ã¦ã‚‚'], ans:0, exp:'<strong>ã™ã‚Œã°</strong> is the conditional ã°-form. "If you practise more, you will improve." ã°-form expresses conditions.' },
    { type:'vocab', year:'2022', q:'ã€Œè¦šãˆã‚‹ã€ã®ã€€ã¯ã‚“ãŸã„ã¯ã€€ã©ã‚Œã§ã™ã‹ã€‚', opts:['å¿˜ã‚Œã‚‹','è¦ªåˆ‡','å¤©æ°—','æ–™ç†'], ans:0, exp:'<strong>å¿˜ã‚Œã‚‹ï¼ˆã‚ã™ã‚Œã‚‹ï¼‰</strong> = to forget, is the opposite of è¦šãˆã‚‹ï¼ˆãŠã¼ãˆã‚‹ï¼‰= to memorise/remember.' },
    { type:'reading', year:'2022', q:'ã€Œç”°ä¸­ã•ã‚“ã¯ã€€æ–™ç†ãŒã€€å¾—æ„ã§ã™ã€‚æ¯Žæ—¥ã€å®¶æ—ã®ã€€ãŸã‚ã«ã€€æ–™ç†ã‚’ã€€ã—ã¾ã™ã€‚ã€\nç”°ä¸­ã•ã‚“ã¯ã€€ãªãœã€€æ¯Žæ—¥ã€€æ–™ç†ã‚’ã€€ã—ã¾ã™ã‹ã€‚', opts:['æ–™ç†ãŒã€€ãã‚‰ã„ã ã‹ã‚‰','å®¶æ—ã®ã€€ãŸã‚ã«','æ—…è¡Œã®ã€€ãŸã‚ã«','ç·´ç¿’ã®ã€€ãŸã‚ã«'], ans:1, exp:'<strong>å®¶æ—ã®ãŸã‚ã«</strong> = for the sake of family. ãŸã‚ã« = for the purpose of / for the sake of.' },
    { type:'vocab', year:'2021', q:'ã€Œæ—…è¡Œã€ã‚’ã€€ã¤ã‹ã£ãŸã€€ãŸã ã—ã„ã€€ã¶ã‚“ã¯ã€€ã©ã‚Œã§ã™ã‹ã€‚', opts:['æ—…è¡Œã‚’ã€€é£Ÿã¹ã¾ã™','æ—…è¡Œã«ã€€è¡Œãã¾ã™','æ—…è¡ŒãŒã€€é£²ã¿ã¾ã™','æ—…è¡Œã‚’ã€€è¦šãˆã¾ã™'], ans:1, exp:'<strong>æ—…è¡Œã«è¡Œã</strong> = to go on a trip. Travel takes the destination particle ã« + movement verb è¡Œã.' },
    { type:'grammar', year:'2023', q:'ã€Œæ˜ ç”»ã‚’ã€€è¦‹ï¼ˆã€€ï¼‰ã€€è¡Œãã¾ã›ã‚“ã‹ã€‚ã€', opts:['ã¦','ã«','ãŒ','ã‚’'], ans:1, exp:'Verb stem + <strong>ã«è¡Œã</strong> expresses going somewhere for a purpose. è¦‹ã«è¡Œã = go to see (a movie). This is a core N4 grammar point.' },
    { type:'vocab', year:'2020', q:'ã€Œè¦ªåˆ‡ã€ã®ã€€ã„ã¿ã¯ã€€ã©ã‚Œã§ã™ã‹ã€‚', opts:['ãã³ã—ã„','ã‚„ã•ã—ã„','ãŠã‚‚ã„','ã¯ã‚„ã„'], ans:1, exp:'<strong>è¦ªåˆ‡ï¼ˆã—ã‚“ã›ã¤ï¼‰</strong> = kind/kindness. The closest synonym is å„ªã—ã„ï¼ˆã‚„ã•ã—ã„ï¼‰= gentle/kind.' },
  ],
  N3: [
    { type:'grammar', year:'2023', q:'ã€Œå½¼å¥³ã¯ã€€æ­ŒãŒã€€ã†ã¾ã„ï¼ˆã€€ï¼‰ã‹ã€ãƒ†ãƒ¬ãƒ“ã«ã€€ã§ã¦ã„ã‚‹ã€‚', opts:['ã‹ã‚‰','ã®ã§','ã ã‘ã‚ã£ã¦','ãã›ã«'], ans:2, exp:'<strong>ã ã‘ã‚ã£ã¦</strong> = "as expected from / no wonder that". "No wonder she\'s on TV â€” she sings so well." Expresses that a result matches an expected quality.' },
    { type:'vocab', year:'2022', q:'ï¼ˆã€€ï¼‰ã«ã€€ãŸã ã—ã„ã€€ã“ã¨ã°ã‚’ã€€ã„ã‚Œã¦ãã ã•ã„ã€‚\nã€Œã“ã®ã€€å•é¡Œã®ã€€ï¼ˆã€€ï¼‰ãŒã€€ã‚ã‹ã‚Šã¾ã›ã‚“ã€‚ã€', opts:['è²¬ä»»','å¯èƒ½æ€§','å½±éŸ¿','è¤‡é›‘ã•'], ans:1, exp:'<strong>å¯èƒ½æ€§ï¼ˆã‹ã®ã†ã›ã„ï¼‰</strong> = possibility. "I don\'t understand the possibility of this problem." å¯èƒ½ = possible, æ€§ = nature/essence.' },
    { type:'reading', year:'2023', q:'ã€Œç’°å¢ƒå•é¡Œã¯ã€€ç§ãŸã¡ã®ã€€è²¬ä»»ã§ã™ã€‚ä¸€äººã²ã¨ã‚ŠãŒã€€åŠªåŠ›ã™ã‚‹ã“ã¨ã§ã€å½±éŸ¿ã‚’ã€€å°ã•ãã§ãã¾ã™ã€‚ã€\nã“ã®ã€€ã¶ã‚“ã®ã€€ã„ã¿ã¯ã€€ã©ã‚Œã§ã™ã‹ã€‚', opts:['ç’°å¢ƒå•é¡Œã¯ã€€é›£ã—ã„','å€‹äººã®ã€€åŠªåŠ›ãŒã€€ç’°å¢ƒã«ã€€å½±éŸ¿ã§ãã‚‹','æ”¿åºœã ã‘ãŒã€€è²¬ä»»ãŒã‚ã‚‹','å•é¡Œã¯ã€€ã‚‚ã†ã€€ã‹ã„ã‘ã¤ã—ãŸ'], ans:1, exp:'The text says ä¸€äººã²ã¨ã‚ŠãŒåŠªåŠ›ã™ã‚‹ã“ã¨ã§å½±éŸ¿ã‚’å°ã•ãã§ãã‚‹ = each individual\'s effort can reduce the impact. Individual effort matters.' },
    { type:'grammar', year:'2022', q:'ã€Œè©¦é¨“ã«ã€€åˆæ ¼ã—ãŸï¼ˆã€€ï¼‰ã€ã‚‚ã£ã¨ã€€å‹‰å¼·ã—ã‚ˆã†ã€‚ã€', opts:['ãŸã‚ã«','ã‚ˆã†ã«','ãã›ã«','ã°ã‹ã‚Šã«'], ans:1, exp:'<strong>ã‚ˆã†ã«</strong> = "so that / in order that". "Let\'s study more so that I pass the exam." Expresses a goal or desired outcome.' },
    { type:'vocab', year:'2021', q:'ã€Œè¤‡é›‘ã€ã®ã€€ã„ã¿ã«ã€€ã„ã¡ã°ã‚“ã€€ã¡ã‹ã„ã€€ã“ã¨ã°ã¯ã€€ã©ã‚Œã§ã™ã‹ã€‚', opts:['ç°¡å˜','ã‚€ãšã‹ã—ãã¦ã€€ã„ã‚Šãã‚“ã§ã„ã‚‹','ã‚ãŸã‚‰ã—ã„','ãŠã‚‚ã„'], ans:1, exp:'<strong>è¤‡é›‘ï¼ˆãµãã–ã¤ï¼‰</strong> = complicated/complex. The closest description is é›£ã—ãã¦å…¥ã‚Šçµ„ã‚“ã§ã„ã‚‹ = difficult and tangled/intricate.' },
  ],
  N2: [
    { type:'grammar', year:'2023', q:'ã€Œå½¼ã¯ã€€æ¦‚å¿µã‚’ã€€èª¬æ˜Žã™ã‚‹ï¼ˆã€€ï¼‰ã€å…·ä½“ä¾‹ã‚’ã€€ã¤ã‹ã£ãŸã€‚ã€', opts:['ã«ã‚ãŸã‚Š','ã«ã•ã„ã—ã¦','ã«ã‚ãŸã£ã¦','ã«ã¨ã‚‚ãªã£ã¦'], ans:2, exp:'<strong>ã«ã‚ãŸã£ã¦</strong> = "on the occasion of / when doing". "When explaining the concept, he used concrete examples." Used for significant moments or actions.' },
    { type:'vocab', year:'2022', q:'ã€Œæ›–æ˜§ãªã€€æ…‹åº¦ã‚’ï¼ˆã€€ï¼‰ã€€ã»ã—ããªã„ã€‚ã€', opts:['ã¨ã£ã¦','ã‚„ã‚ã¦','ã™ã™ã‚ã¦','ã‹ã‚“ãŒãˆã¦'], ans:1, exp:'<strong>ã‚„ã‚ã¦</strong> = stop/quit. "I don\'t want you to take an ambiguous attitude." æ›–æ˜§ï¼ˆã‚ã„ã¾ã„ï¼‰= vague/ambiguous.' },
    { type:'reading', year:'2023', q:'ã€Œæ„è­˜çš„ã«ã€€åŠªåŠ›ã™ã‚‹ã“ã¨ã§ã€å‚¾å‘ã‚’ã€€å…‹æœã§ãã‚‹ã€‚æ‰¹åˆ¤ã‚’ã€€æã‚Œãšã€æ ¹æ‹ ã®ã‚ã‚‹ã€€ä¸»å¼µã‚’ã€€ã™ã¹ãã ã€‚ã€\nã“ã®ã€€ã¶ã‚“ãŒã€€ã„ã„ãŸã„ã€€ã“ã¨ã¯ã€€ãªã‚“ã§ã™ã‹ã€‚', opts:['æ‰¹åˆ¤ã¯ã€€ã¤ã­ã«ã€€ã¾ã¡ãŒã„ã ','æ„è­˜çš„ãªã€€åŠªåŠ›ã¨ã€€è¨¼æ‹ ã«ã€€ã‚‚ã¨ã¥ãã€€ä¸»å¼µãŒã€€ãŸã„ã›ã¤ã ','æ ¹æ‹ ã¯ã€€ã„ã‚‰ãªã„','å‚¾å‘ã¯ã€€ã‹ãˆã‚‰ã‚Œãªã„'], ans:1, exp:'The passage argues for conscious effort (æ„è­˜çš„åŠªåŠ›) and evidence-based claims (æ ¹æ‹ ã®ã‚ã‚‹ä¸»å¼µ). Both elements are needed.' },
    { type:'grammar', year:'2021', q:'ã€Œå¦¥å”ï¼ˆã€€ï¼‰ã€å•é¡Œã‚’ã€€è§£æ±ºã™ã‚‹ã“ã¨ãŒã€€ã§ããŸã€‚ã€', opts:['ã™ã‚‹ã«ã‚ãŸã‚Š','ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦','ã™ã‚‹ã‚ã‚Šã«','ã™ã‚‹ã«ã—ã¦ã¯'], ans:1, exp:'<strong>ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦</strong> = "by doing / through doing". "By compromising, they were able to solve the problem." ã«ã‚ˆã£ã¦ marks means/method.' },
  ],
  N1: [
    { type:'vocab', year:'2023', q:'ã€Œåˆ¹é‚£ã€ã®ã€€ã„ã¿ã«ã€€ã„ã¡ã°ã‚“ã€€ã¡ã‹ã„ã€€ã“ã¨ã°ã¯ã€€ã©ã‚Œã§ã™ã‹ã€‚', opts:['ãªãŒã„ã˜ã‹ã‚“','ã„ã£ã—ã‚…ã‚“','ã¾ã„ã«ã¡','ã‚†ã£ãã‚Š'], ans:1, exp:'<strong>åˆ¹é‚£ï¼ˆã›ã¤ãªï¼‰</strong> = a moment/instant. From Sanskrit, the smallest unit of time in Buddhist thought. ä¸€çž¬ï¼ˆã„ã£ã—ã‚…ã‚“ï¼‰= an instant, is the closest synonym.' },
    { type:'grammar', year:'2023', q:'ã€Œè‘›è—¤ã‚’ï¼ˆã€€ï¼‰ã€å½¼ã¯ã€€æ±ºæ–­ã—ãŸã€‚ã€', opts:['ãŠã¼ãˆãªãŒã‚‰','ã‹ã‹ãˆã¤ã¤','ã‚ã™ã‚ŒãªãŒã‚‰','ãªãã—ãŸã†ãˆã§'], ans:1, exp:'<strong>ã‹ã‹ãˆã¤ã¤</strong> = "while bearing/carrying (a burden)". ã¤ã¤ is a literary simultaneous action form. "Bearing inner conflict, he made a decision."' },
    { type:'vocab', year:'2022', q:'ã€Œè¬™è™šãªã€€äººã¯ï¼ˆã€€ï¼‰ã€€ã¨ãŠã‚Šã ã€‚ã€', opts:['ãŠã”ã‚ŠãŸã‹ã¶ã£ã¦ã„ã‚‹','ã²ã‹ãˆã‚ã§ã€€ã˜ã¶ã‚“ã‚’ã€€ã§ã—ã‚ƒã°ã‚‰ãªã„','ã„ã¤ã‚‚ã€€ã˜ã¶ã‚“ã®ã€€ã„ã‘ã‚“ã‚’ã€€ãŠã—ã¤ã‘ã‚‹','ãŸã‹ã³ã—ã‚ƒãªã€€ãŸã„ã©ã‚’ã€€ã¨ã‚‹'], ans:1, exp:'<strong>è¬™è™šï¼ˆã‘ã‚“ãã‚‡ï¼‰</strong> = humble/modest. æŽ§ãˆã‚ã§è‡ªåˆ†ã‚’å‡ºã—ã‚ƒã°ã‚‰ãªã„ = restrained and not pushy about oneself. This perfectly describes humility.' },
    { type:'reading', year:'2022', q:'ã€Œè¹‰è·Žã¨ã—ã¦ã€€ã™ã”ã—ãŸã€€æ­³æœˆã¯ã€€ã¨ã‚Šã‚‚ã©ã›ãªã„ã€‚æ…Ÿå“­ã—ã¦ã‚‚ã€éŽåŽ»ã¯ã€€ã‹ã‚ã‚‰ãªã„ã€‚ã ã‹ã‚‰ã“ãã€ä»Šã“ã®ã€€åˆ¹é‚£ã‚’ã€€å¤§åˆ‡ã«ã€€ã™ã¹ãã ã€‚ã€\nã“ã®ã€€ã¶ã‚“ã®ã€€ä¸»é¡Œã¯ã€€ãªã‚“ã§ã™ã‹ã€‚', opts:['éŽåŽ»ã‚’ã€€ãã‚„ã‚€ã€€ã“ã¨','æ™‚é–“ã‚’ã€€ã‚€ã ã«ã€€ã—ãŸã€€å¾Œæ‚”','ç¾åœ¨ã®ã€€çž¬é–“ã‚’ã€€å¤§åˆ‡ã«ã€€ã™ã‚‹ã“ã¨','æ…Ÿå“­ã®ã€€ã„ã¿'], ans:2, exp:'The passage moves from regret about wasted time (è¹‰è·Ž) and grief (æ…Ÿå“­) to the conclusion: treasure this present moment (ä»Šã“ã®åˆ¹é‚£ã‚’å¤§åˆ‡ã«). The theme is living in the now.' },
    { type:'vocab', year:'2021', q:'ã€Œç‘£æœ«ãªã€€ã“ã¨ã«ï¼ˆã€€ï¼‰ã€€ã¹ãã§ã¯ã€€ãªã„ã€‚ã€', opts:['ã“ã ã‚ã‚‹','ãŠã¼ãˆã‚‹','ã‚ã™ã‚Œã‚‹','ã‹ãˆã‚‹'], ans:0, exp:'<strong>ã“ã ã‚ã‚‹</strong> = to be fixated on / obsessed with. ç‘£æœ«ãªã“ã¨ã«ã“ã ã‚ã‚‹ = being hung up on trivial matters. A common N1 colocation.' },
  ]
};

let ppIdx = 0, ppResults = [], ppPool = [], ppAnswered = false, ppTimer = null, ppTimeLeft = 0;

function startPastPaper() {
  ppIdx = 0; ppResults = []; ppAnswered = false;
  clearInterval(ppTimer);
  ppPool = shuffle([...(pastPapers[currentLevel] || pastPapers.N5)]);
  document.getElementById('ppTitle').textContent = `JLPT ${currentLevel} â€” Past Paper`;
  document.getElementById('ppMeta').textContent  = `${ppPool.length} questions Â· Vocab Â· Grammar Â· Reading`;
  document.getElementById('ppProgFill').style.width = '0%';
  showScreen('ppScreen');
  renderPP();
}

function renderPP() {
  const q = ppPool[ppIdx];
  if (!q) { endPastPaper(); return; }
  ppAnswered = false;
  clearInterval(ppTimer);

  document.getElementById('ppProgFill').style.width = `${Math.round(ppIdx/ppPool.length*100)}%`;
  document.getElementById('ppMeta').textContent = `Q ${ppIdx+1} / ${ppPool.length} Â· ${currentLevel}`;

  const typeLabels = { vocab:'ðŸ“˜ Vocabulary', grammar:'ðŸ“— Grammar', reading:'ðŸ“™ Reading' };
  const diff = q.diff || (q.type==='reading' ? 'medium' : 'easy');
  const diffBadge = {easy:'ðŸŸ¢ Easy', medium:'ðŸŸ¡ Medium', hard:'ðŸ”´ Hard'}[diff] || '';
  const letters = ['â‘ ','â‘¡','â‘¢','â‘£'];
  const timeLimit = q.type === 'reading' ? 45 : 25;
  ppTimeLeft = timeLimit;
  const circLen = (2 * Math.PI * 13).toFixed(1);

  document.getElementById('ppContent').innerHTML = `
    <div class="pp-body">
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px">
        <div class="pp-q-type ${q.type}">${typeLabels[q.type]||q.type}</div>
        <div style="display:flex;align-items:center;gap:8px">
          <span style="font-size:0.68rem;color:var(--stone)">${diffBadge}</span>
          <div style="position:relative;display:inline-flex;align-items:center;justify-content:center;width:32px;height:32px">
            <svg width="32" height="32" viewBox="0 0 32 32">
              <circle cx="16" cy="16" r="13" fill="none" stroke="var(--border)" stroke-width="2.5"/>
              <circle id="ppTimerCircle" cx="16" cy="16" r="13" fill="none" stroke="var(--crimson)" stroke-width="2.5"
                stroke-dasharray="${circLen}" stroke-dashoffset="0"
                stroke-linecap="round" transform="rotate(-90 16 16)"
                style="transition:stroke-dashoffset .95s linear,stroke .4s"/>
            </svg>
            <span id="ppTimerNum" style="position:absolute;font-size:0.6rem;font-weight:800;color:var(--crimson)">${timeLimit}</span>
          </div>
        </div>
      </div>
      <div class="pp-question">${formatPPQuestion(q.q)}</div>
      <div class="pp-opts" id="ppOpts">
        ${q.opts.map((opt,i) => `
          <button class="pp-opt" id="ppOpt${i}" onclick="answerPP(${i})">
            <span class="pp-opt-letter">${letters[i]}</span><span>${opt}</span>
          </button>`).join('')}
      </div>
      <div class="pp-explanation" id="ppExplanation">${q.exp}</div>
      <button class="next-btn" id="ppNextBtn" onclick="nextPP()" style="display:none;margin-top:14px">
        ${ppIdx+1 < ppPool.length ? 'Next Question â†’' : 'See Results â†’'}
      </button>
    </div>`;

  const circEl = document.getElementById('ppTimerCircle');
  const numEl  = document.getElementById('ppTimerNum');
  const circumference = parseFloat(circLen);
  ppTimer = setInterval(() => {
    ppTimeLeft--;
    if (numEl) numEl.textContent = Math.max(0, ppTimeLeft);
    if (circEl) {
      circEl.style.strokeDashoffset = circumference * (1 - ppTimeLeft / timeLimit);
      if (ppTimeLeft <= 8) circEl.style.stroke = '#e67e22';
      if (ppTimeLeft <= 4) circEl.style.stroke = 'var(--crimson)';
    }
    if (ppTimeLeft <= 0) { clearInterval(ppTimer); if (!ppAnswered) answerPP(-1); }
  }, 1000);
}

function formatPPQuestion(q) {
  return q.replace(/ï¼ˆã€€ï¼‰/g, '<span class="blank">ï¼ˆã€€ï¼‰</span>').replace(/\n/g, '<br>');
}

function answerPP(idx) {
  if (ppAnswered) return;
  ppAnswered = true;
  clearInterval(ppTimer);
  const q = ppPool[ppIdx];
  const correct = idx === q.ans;
  ppResults.push({ correct, chosen:idx, q });

  document.querySelectorAll('.pp-opt').forEach((btn, i) => {
    btn.disabled = true;
    if (i === q.ans) btn.classList.add('correct');
    else if (i === idx && !correct) btn.classList.add('wrong');
  });

  if (idx === -1) {
    const d = document.createElement('div');
    d.style.cssText = 'font-size:.78rem;color:var(--crimson);font-weight:700;margin-top:6px;text-align:center';
    d.textContent = 'â° Time\'s up!';
    document.getElementById('ppOpts')?.after(d);
  }

  document.getElementById('ppExplanation').classList.add('show');
  const nb = document.getElementById('ppNextBtn');
  if (nb) nb.style.display = 'block';

  if (correct) { soundCorrect(); showXpPop(20); }
  else { soundWrong(); saveMistake(q); }
}
function nextPP() {
  ppIdx++;
  if (ppIdx >= ppPool.length) { endPastPaper(); return; }
  renderPP();
}

function endPastPaper() {
  const correct = ppResults.filter(r => r.correct).length;
  const total   = ppResults.length;
  const pct     = total > 0 ? Math.round((correct / total) * 100) : 0;
  // JLPT pass threshold ~60-70%
  const passed  = pct >= 60;

  const letters = ['â‘ ','â‘¡','â‘¢','â‘£'];
  const reviewHTML = ppResults.map((r, i) => `
    <div class="pp-review-item">
      <div class="pp-review-dot ${r.correct ? 'hit' : 'miss'}">${r.correct ? 'âœ“' : 'âœ—'}</div>
      <div>
        <div style="font-weight:700;margin-bottom:2px">${r.q.q.replace(/\n/g,'ã€€').slice(0,50)}â€¦</div>
        <div style="color:var(--stone);font-size:0.75rem">
          Correct: ${letters[r.q.ans]} ${r.q.opts[r.q.ans]}
          ${!r.correct ? ` Â· You chose: ${letters[ppResults[i]?.chosen ?? r.q.ans]} ${r.q.opts[ppResults[i]?.chosen ?? r.q.ans] || 'â€”'}` : ''}
        </div>
      </div>
    </div>`).join('');

  document.getElementById('ppContent').innerHTML = `
    <div class="pp-score-wrap">
      <div class="pp-score-jp">${passed ? 'åˆæ ¼ï¼' : 'ä¸åˆæ ¼'}</div>
      <div class="pp-score-en">${passed ? 'PASS â€” Well Done!' : 'Not Yet â€” Keep Studying!'}</div>
      <div class="pp-score-num">${correct}</div>
      <div class="pp-score-denom">/ ${total} correct (${pct}%)</div>
      <div class="pp-pass-badge ${passed ? 'pass' : 'fail'}">${passed ? 'âœ“ JLPT Pass Threshold Met' : 'âœ— Below 60% Pass Threshold'}</div>
      <div class="pp-review">
        <div class="pp-review-title">Question Review</div>
        ${reviewHTML}
      </div>
      <div style="display:flex;gap:10px;flex-wrap:wrap">
        <button class="sc-btn sc-home" style="flex:1" onclick="goHome()">ðŸ  Home</button>
        <button class="sc-btn sc-again" style="flex:2;background:var(--gold);color:var(--ink)" onclick="startPastPaper()">ã‚‚ã†ä¸€åº¦ â†’</button>
      </div>
    </div>`;

  document.getElementById('ppProgFill').style.width = '100%';

  // Award XP
  const earned = correct * 20;
  const p = getProgress();
  const oldXp = p.totalXP || 0;
  p.totalXP = oldXp + earned;
  saveProgress(p);
  setTimeout(() => checkRankUp(oldXp, p.totalXP), 600);
  if (earned > 0) showXpPop(earned);
}


// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// DAILY WORD OF THE DAY
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const allVocabLevels = ['N5','N4','N3','N2','N1'];

function getDayIndex() {
  // Deterministic index based on calendar day (same word for everyone today)
  const d = new Date();
  return Math.floor(d.getTime() / 86400000); // days since epoch
}

function getDailyWord() {
  // Collect all vocab across all levels
  const allWords = [];
  for (const lv of allVocabLevels) {
    if (vocab[lv]) vocab[lv].forEach(w => allWords.push({ ...w, lv }));
  }
  const idx = getDayIndex() % allWords.length;
  return allWords[idx] || allWords[0];
}

// Mini story templates for words without custom hooks
function generateMiniStory(word) {
  const k = word.k, f = word.f, m = word.m, pos = word.pos || '';
  const lv = word.lv || '';

  // Story templates based on part of speech
  const verbTemplates = [
    `Picture a ninja who must ${m} every single day to master their jutsu. Every time they ${m}, they shoutã€Œ${k}ï¼ã€(${f}) â€” until the word is burned into their soul! ðŸ¥·`,
    `A Naruto-style training arc: the hero wakes at dawn determined to ${m}. Their sensei points at the kanji ${k} (${f}) painted on a stone â€” "Master this word, master the skill!" âš”ï¸`,
    `Imagine a determined student at a mountain monastery. Their daily mission: ${m}. Written on their headband: ${k} (${f}, meaning "${m}"). They never forget it! ðŸŽŒ`,
  ];
  const nounTemplates = [
    `Visualise the kanji ${k} carved above the gate of a great dojo. Every student who enters bows and saysã€Œ${f}ã€â€” a reminder that ${m} is at the heart of all training. ðŸ¯`,
    `In your mind's eye, see ${k} (${f}) floating in neon lights over a Tokyo street, glowing the colour of ${lv}. Below it: the meaning "${m}" â€” unforgettable! ðŸŒŸ`,
    `An anime hero clutches a scroll with ${k} written in bold ink. Their master says: "Never forget this â€” ${f}. It means ${m}. It will guide you in the hardest moments." ðŸ“œ`,
  ];
  const adjTemplates = [
    `Imagine rating everything around you: is it ${m}? Look at the kanji ${k} (${f}) and feel the word take shape. A true ${lv} warrior can read this in a flash! â­`,
    `Picture a character in an anime describing their rival: "They are ${k} (${f}) â€” ${m}!" The subtitles flash the word three times. Your brain locks it in! ðŸ“º`,
  ];

  if (pos.includes('verb')) {
    return verbTemplates[Math.floor(Math.random() * verbTemplates.length)];
  } else if (pos.includes('adj')) {
    return adjTemplates[Math.floor(Math.random() * adjTemplates.length)];
  } else {
    return nounTemplates[Math.floor(Math.random() * nounTemplates.length)];
  }
}

function initDailyWord() {
  const word = getDailyWord();
  if (!word) return;

  document.getElementById('dwKanji').textContent = word.k;
  document.getElementById('dwReading').textContent = `${word.f} (${word.r})`;
  document.getElementById('dwMeaning').textContent = word.m;
  document.getElementById('dwLevel').textContent = word.lv;

  // Memory hook â€” generate a mini-story if no hook exists
  let hook;
  if (word.origin && word.origin.hook) {
    hook = word.origin.hook;
  } else {
    hook = generateMiniStory(word);
  }
  document.getElementById('dwHook').textContent = 'âœ¨ ' + hook;

  // Streak tracking
  const p = getProgress();
  const today = new Date().toDateString();
  const dwHistory = p.dwHistory || {};
  const streak = p.dwStreak || 0;
  const lastSeen = p.dwLastSeen || '';

  // Mark as seen today
  if (lastSeen !== today) {
    const newStreak = (p.dwLastSeen === new Date(Date.now()-86400000).toDateString()) ? streak + 1 : 1;
    p.dwStreak = newStreak;
    p.dwLastSeen = today;
    dwHistory[today] = word.k;
    p.dwHistory = dwHistory;
    saveProgress(p);
    document.getElementById('dwSeenBadge').textContent = 'ðŸ†• New today';
    document.getElementById('dwSeenBadge').className = 'dw-seen-badge new';
  } else {
    document.getElementById('dwSeenBadge').textContent = 'âœ“ Seen today';
    document.getElementById('dwSeenBadge').className = 'dw-seen-badge';
  }

  const currentStreak = p.dwStreak || 1;
  document.getElementById('dwStreakBadge').textContent = `ðŸ”¥ ${currentStreak} day${currentStreak === 1 ? '' : 's'}`;

  // Level color
  const lv = word.lv;
  const colors = { N5:'#27ae60', N4:'#2980b9', N3:'#8e44ad', N2:'#e67e22', N1:'#c0392b' };
  const el = document.getElementById('dwLevel');
  if (colors[lv]) el.style.color = colors[lv];
}

function startDailyWordPractice() {
  // Set level to word's level and start a mini session with that word
  const word = getDailyWord();
  if (!word) return;

  // Find the level card and select it
  document.querySelectorAll('.level-card').forEach(c => {
    c.classList.toggle('selected', c.dataset.level === word.lv);
  });
  currentLevel = word.lv;

  // Set to meaning mode and start
  document.querySelectorAll('.mode-pill').forEach(p => {
    p.classList.toggle('sel', p.dataset.mode === 'meaning');
  });
  currentMode = 'meaning';

  // Show a toast
  showXpPop('ðŸ“…');
  setTimeout(() => startGame(), 300);
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// MISTAKE BANK
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function saveMistake(q) {
  if (!q) return;
  try {
    const p = getProgress();
    if (!p.mistakes) p.mistakes = [];
    // avoid duplicates by question text
    if (!p.mistakes.find(m => m.q === q.q)) {
      p.mistakes.unshift({ lv: currentLevel, type: q.type, q: q.q, opts: q.opts, ans: q.ans, exp: q.exp, ts: Date.now() });
      if (p.mistakes.length > 50) p.mistakes = p.mistakes.slice(0, 50);
      saveProgress(p);
    }
  } catch(e) {}
}

function openMistakeBank() {
  const p = getProgress();
  const mistakes = p.mistakes || [];
  const overlay = document.getElementById('mistakeBankOverlay');
  const body    = document.getElementById('mistakeBankBody');
  const letters = ['â‘ ','â‘¡','â‘¢','â‘£'];
  const typeIcons = { vocab:'ðŸ“˜', grammar:'ðŸ“—', reading:'ðŸ“™' };

  if (!mistakes.length) {
    body.innerHTML = '<div style="text-align:center;padding:30px 0;color:var(--stone)"><div style="font-size:2.5rem;margin-bottom:10px">ðŸ†</div><div>No mistakes yet! Keep studying.</div></div>';
  } else {
    body.innerHTML = mistakes.map((m,i) => `
      <div style="border:1.5px solid var(--border);border-radius:12px;padding:12px 14px;margin-bottom:10px;background:white">
        <div style="display:flex;align-items:center;gap:8px;margin-bottom:8px">
          <span style="font-size:0.65rem;background:var(--crimson-lt);color:var(--crimson);border-radius:6px;padding:2px 8px;font-weight:700;letter-spacing:1px">${(typeIcons[m.type]||'')+' '+(m.lv||'')}</span>
          <button onclick="clearMistake(${i})" style="margin-left:auto;background:none;border:none;color:var(--stone);cursor:pointer;font-size:0.75rem">âœ• clear</button>
        </div>
        <div style="font-family:'Noto Serif JP',serif;font-size:0.88rem;color:var(--ink);line-height:1.7;margin-bottom:8px">${m.q.replace(/\n/g,'<br>')}</div>
        <div style="font-size:0.75rem;color:#27ae60;font-weight:700">âœ“ Correct: ${letters[m.ans]} ${m.opts[m.ans]}</div>
        <details style="margin-top:6px">
          <summary style="font-size:0.7rem;color:var(--stone);cursor:pointer">Why?</summary>
          <div style="font-size:0.78rem;color:var(--ink);margin-top:5px;line-height:1.6">${m.exp}</div>
        </details>
      </div>`).join('');
  }

  overlay.style.display = 'flex';
}

function clearMistake(idx) {
  const p = getProgress();
  if (p.mistakes) { p.mistakes.splice(idx, 1); saveProgress(p); }
  openMistakeBank(); // refresh
}

function closeMistakeBank() {
  document.getElementById('mistakeBankOverlay').style.display = 'none';
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DARK MODE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function toggleDarkMode() {
  const isDark = document.body.classList.toggle('dark');
  localStorage.setItem('jlpt_dark', isDark ? '1' : '0');
  document.getElementById('dmToggle').textContent = isDark ? 'â˜€ï¸ Light' : 'ðŸŒ™ Dark';
}

function initDarkMode() {
  const saved = localStorage.getItem('jlpt_dark');
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
  if (saved === '1' || (saved === null && prefersDark)) {
    document.body.classList.add('dark');
    document.getElementById('dmToggle').textContent = 'â˜€ï¸ Light';
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ONBOARDING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let _obSlide = 0;
const _obTotal = 3;

function initOnboarding() {
  const seen = localStorage.getItem('jlpt_onboard_done');
  if (!seen) {
    document.getElementById('onboardOverlay').classList.add('show');
  }
}

function onboardNext() {
  _obSlide++;
  if (_obSlide >= _obTotal) { closeOnboarding(); return; }
  document.getElementById('onboardSlides').style.transform = `translateX(-${_obSlide * 100}%)`;
}

function closeOnboarding() {
  document.getElementById('onboardOverlay').classList.remove('show');
  localStorage.setItem('jlpt_onboard_done', '1');
  _obSlide = 0;
  document.getElementById('onboardSlides').style.transform = 'translateX(0)';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATS DASHBOARD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openStats() {
  const p = getProgress();
  const totalWords = Object.values(p.seenWords).reduce((a, b) => a + b.length, 0);
  const mistakes = (p.mistakes || []).length;

  // Estimate accuracy from sessions vs mistakes
  const totalAnswers = (p.totalSessions || 0) * 10; // rough estimate
  const acc = totalAnswers > 0
    ? Math.max(0, Math.round((1 - mistakes / Math.max(totalAnswers, 1)) * 100))
    : null;

  document.getElementById('stKpiXp').textContent      = p.totalXP || 0;
  document.getElementById('stKpiStreak').textContent  = p.streak || 0;
  document.getElementById('stKpiSessions').textContent= p.totalSessions || 0;
  document.getElementById('stKpiWords').textContent   = totalWords;
  document.getElementById('stKpiAcc').textContent     = acc !== null ? acc + '%' : 'â€”';
  document.getElementById('stKpiMistakes').textContent= mistakes;

  // Level bars
  const colors = { N5:'#27ae60', N4:'#2980b9', N3:'#8e44ad', N2:'#e67e22', N1:'#c0392b' };
  const container = document.getElementById('statsLevelBars');
  container.innerHTML = ['N5','N4','N3','N2','N1'].map(lv => {
    const seen  = p.seenWords[lv]?.length || 0;
    const total = (typeof vocab !== 'undefined' && vocab[lv]) ? vocab[lv].length : 1;
    const pct   = total > 0 ? Math.round((seen / total) * 100) : 0;
    return `<div class="stats-level-row">
      <div class="slr-badge" style="color:${colors[lv]}">${lv}</div>
      <div class="slr-bar-wrap">
        <div class="slr-bar-fill" style="width:0%;background:${colors[lv]}" data-pct="${pct}"></div>
      </div>
      <div class="slr-pct" style="color:${colors[lv]}">${pct}%</div>
      <div class="slr-seen">${seen}/${total}</div>
    </div>`;
  }).join('');

  // Animate bars after paint
  setTimeout(() => {
    container.querySelectorAll('.slr-bar-fill').forEach(el => {
      el.style.width = el.dataset.pct + '%';
    });
  }, 60);

  // Build heatmap
  buildHeatmap(p);

  document.getElementById('statsOverlay').classList.add('show');
}

function closeStats() {
  document.getElementById('statsOverlay').classList.remove('show');
}

function buildHeatmap(p) {
  const grid = document.getElementById('heatmapGrid');
  const history = p.sessionHistory || {};
  const today = new Date();
  const cells = [];
  const days = 105; // 15 columns Ã— 7 rows

  for (let i = days - 1; i >= 0; i--) {
    const d = new Date(today);
    d.setDate(today.getDate() - i);
    const key = d.toISOString().slice(0, 10);
    const count = history[key] || 0;
    let lvl = 0;
    if (count >= 1) lvl = 1;
    if (count >= 3) lvl = 2;
    if (count >= 6) lvl = 3;
    if (count >= 10) lvl = 4;
    const tip = count > 0 ? `${key}: ${count} session${count !== 1 ? 's' : ''}` : key;
    cells.push(`<div class="hm-cell${lvl ? ' l'+lvl : ''}" data-tip="${tip}"></div>`);
  }
  grid.innerHTML = cells.join('');
}

// Hook recordSession to also track sessionHistory
const _origRecordSession = recordSession;
function recordSession(lv, wordsStudied, sessionResults) {
  // Track daily session count for heatmap
  const p = getProgress();
  const today = new Date().toISOString().slice(0, 10);
  if (!p.sessionHistory) p.sessionHistory = {};
  p.sessionHistory[today] = (p.sessionHistory[today] || 0) + 1;
  saveProgress(p);

  // Check achievements before calling original (so XP is updated after)
  const result = _origRecordSession(lv, wordsStudied, sessionResults);

  // Check achievements after session
  setTimeout(() => checkAchievements(), 1200);
  return result;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ACHIEVEMENTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const ACHIEVEMENTS = [
  { id:'first_session',  icon:'ðŸŽŒ', name:'First Steps',        desc:'Complete your first session' },
  { id:'streak_3',       icon:'ðŸ”¥', name:'On Fire',            desc:'Reach a 3-day streak' },
  { id:'streak_7',       icon:'ðŸŒŠ', name:'Week Warrior',       desc:'Reach a 7-day streak' },
  { id:'streak_30',      icon:'âš¡', name:'Unstoppable',        desc:'Reach a 30-day streak' },
  { id:'words_50',       icon:'ðŸ“š', name:'Word Collector',     desc:'See 50 unique words' },
  { id:'words_200',      icon:'ðŸ“–', name:'Vocabulary Builder', desc:'See 200 unique words' },
  { id:'words_500',      icon:'ðŸ›ï¸', name:'Scholar',           desc:'See 500 unique words' },
  { id:'xp_100',         icon:'â­', name:'XP Rookie',          desc:'Earn 100 XP total' },
  { id:'xp_1000',        icon:'ðŸ’«', name:'XP Hunter',          desc:'Earn 1,000 XP total' },
  { id:'xp_5000',        icon:'ðŸŒŸ', name:'XP Legend',          desc:'Earn 5,000 XP total' },
  { id:'n5_complete',    icon:'ðŸ¥‹', name:'N5 Master',          desc:'See all N5 words' },
  { id:'n4_complete',    icon:'âš”ï¸', name:'N4 Master',          desc:'See all N4 words' },
  { id:'no_mistakes',    icon:'ðŸ’Ž', name:'Flawless',           desc:'Finish a session with no mistakes' },
  { id:'sessions_10',    icon:'ðŸŽ¯', name:'Dedicated',          desc:'Complete 10 sessions' },
  { id:'sessions_50',    icon:'ðŸ†', name:'JLPT Champion',      desc:'Complete 50 sessions' },
];

function getUnlockedAchievements() {
  const raw = localStorage.getItem('jlpt_achievements');
  return raw ? JSON.parse(raw) : [];
}

function unlockAchievement(id) {
  const unlocked = getUnlockedAchievements();
  if (unlocked.includes(id)) return false;
  unlocked.push(id);
  localStorage.setItem('jlpt_achievements', JSON.stringify(unlocked));
  return true;
}

function checkAchievements() {
  const p = getProgress();
  const totalWords = Object.values(p.seenWords).reduce((a, b) => a + b.length, 0);
  const n5Total  = typeof vocab !== 'undefined' ? (vocab['N5']?.length || 0) : 0;
  const n4Total  = typeof vocab !== 'undefined' ? (vocab['N4']?.length || 0) : 0;
  const toCheck = [];

  if ((p.totalSessions || 0) >= 1)  toCheck.push('first_session');
  if ((p.streak || 0) >= 3)          toCheck.push('streak_3');
  if ((p.streak || 0) >= 7)          toCheck.push('streak_7');
  if ((p.streak || 0) >= 30)         toCheck.push('streak_30');
  if (totalWords >= 50)               toCheck.push('words_50');
  if (totalWords >= 200)              toCheck.push('words_200');
  if (totalWords >= 500)              toCheck.push('words_500');
  if ((p.totalXP || 0) >= 100)       toCheck.push('xp_100');
  if ((p.totalXP || 0) >= 1000)      toCheck.push('xp_1000');
  if ((p.totalXP || 0) >= 5000)      toCheck.push('xp_5000');
  if (n5Total > 0 && (p.seenWords['N5']?.length || 0) >= n5Total) toCheck.push('n5_complete');
  if (n4Total > 0 && (p.seenWords['N4']?.length || 0) >= n4Total) toCheck.push('n4_complete');
  if ((p.totalSessions || 0) >= 10)  toCheck.push('sessions_10');
  if ((p.totalSessions || 0) >= 50)  toCheck.push('sessions_50');

  // Check flawless (no mistakes this session) â€” triggered externally
  let delay = 0;
  toCheck.forEach(id => {
    if (unlockAchievement(id)) {
      const ach = ACHIEVEMENTS.find(a => a.id === id);
      if (ach) setTimeout(() => showAchievementToast(ach), delay);
      delay += 3200;
    }
  });
}

function checkFlawless() {
  if (unlockAchievement('no_mistakes')) {
    const ach = ACHIEVEMENTS.find(a => a.id === 'no_mistakes');
    if (ach) showAchievementToast(ach);
  }
}

let _toastTimer = null;
function showAchievementToast(ach) {
  const toast = document.getElementById('achToast');
  document.getElementById('achToastIcon').textContent = ach.icon;
  document.getElementById('achToastName').textContent = ach.name;
  document.getElementById('achToastDesc').textContent = ach.desc;
  toast.classList.add('show');
  clearTimeout(_toastTimer);
  _toastTimer = setTimeout(() => toast.classList.remove('show'), 3000);
}

function openAchievements() {
  const unlocked = getUnlockedAchievements();
  document.getElementById('achHeaderSub').textContent = `${unlocked.length} / ${ACHIEVEMENTS.length} unlocked`;
  const grid = document.getElementById('achGrid');
  grid.innerHTML = ACHIEVEMENTS.map(a => {
    const isUnlocked = unlocked.includes(a.id);
    return `<div class="ach-card ${isUnlocked ? 'unlocked' : 'locked'}">
      ${isUnlocked ? '<div class="ach-unlocked-badge">âœ“ DONE</div>' : ''}
      <div class="ach-icon">${a.icon}</div>
      <div class="ach-name">${a.name}</div>
      <div class="ach-desc">${isUnlocked ? 'âœ“ Unlocked!' : a.desc}</div>
    </div>`;
  }).join('');
  document.getElementById('achOverlay').classList.add('show');
}

function closeAchievements() {
  document.getElementById('achOverlay').classList.remove('show');
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ROMAJI TOGGLE
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function toggleRomaji() {
  const body = document.body;
  body.classList.toggle('hide-romaji');
  const btn = document.getElementById('romajiToggle');
  const isHidden = body.classList.contains('hide-romaji');
  btn.textContent = isHidden ? 'RÅmaji âœ—' : 'RÅmaji âœ“';
  btn.classList.toggle('hidden-romaji', isHidden);
  localStorage.setItem('jlpt_hide_romaji', isHidden ? '1' : '');
}
function initRomaji() {
  if (localStorage.getItem('jlpt_hide_romaji')) {
    document.body.classList.add('hide-romaji');
    const btn = document.getElementById('romajiToggle');
    if (btn) { btn.textContent = 'RÅmaji âœ—'; btn.classList.add('hidden-romaji'); }
  }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// KEYBOARD SHORTCUTS
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let _kbActive = false;
function initKeyboardShortcuts() {
  document.addEventListener('keydown', e => {
    const gameActive = document.getElementById('gameScreen').classList.contains('active');
    if (!gameActive) return;

    // Show kb hints on first keypress
    const hints = document.getElementById('kbHints');
    if (hints) hints.style.display = 'flex';

    // 1-4: select answer option
    if (!answered && ['1','2','3','4'].includes(e.key)) {
      const opts = document.querySelectorAll('.opt-btn:not(:disabled)');
      const idx = parseInt(e.key) - 1;
      if (opts[idx]) opts[idx].click();
      return;
    }

    // Enter or Space: next question
    if ((e.key === 'Enter' || e.key === ' ') && answered) {
      e.preventDefault();
      const nextBtn = document.getElementById('nextBtn');
      if (nextBtn && nextBtn.classList.contains('show')) nextBtn.click();
      return;
    }

    // O: open origin panel
    if (e.key.toLowerCase() === 'o' && currentEntry) {
      openOrigin();
    }

    // F: flip flashcard
    if (e.key.toLowerCase() === 'f' && currentMode === 'flash') {
      const card = document.getElementById('flashCard');
      if (card) flipCard();
    }
  });
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ANIME SENSEI CHARACTER SYSTEM
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const SENSEIS = [
  { name: 'All Might', correct: 'ðŸ’ªðŸ˜„', wrong: 'ðŸ˜…ðŸ’ª', streak: 'ðŸ”¥ðŸ’ª', src: 'â€” My Hero Academia' },
  { name: 'L Lawliet', correct: 'ðŸ§ ðŸ˜Œ', wrong: 'ðŸ¤”ðŸ°', streak: 'ðŸ˜ŽðŸ°', src: 'â€” Death Note' },
  { name: 'Rock Lee', correct: 'ðŸ¥‹ðŸ˜', wrong: 'ðŸ˜¤ðŸŒ¿', streak: 'ðŸ”¥ðŸ¥‹', src: 'â€” Naruto' },
  { name: 'Senku', correct: 'ðŸ§ªðŸ˜', wrong: 'ðŸ¤¯ðŸ§ª', streak: 'âš—ï¸âœ¨', src: 'â€” Dr. Stone' },
  { name: 'Nezuko', correct: 'ðŸŒ¸ðŸ˜Š', wrong: 'ðŸ¥ºðŸŒ¸', streak: 'ðŸ”¥ðŸŒ¸', src: 'â€” Demon Slayer' },
  { name: 'Goku', correct: 'âš¡ðŸ˜„', wrong: 'ðŸ˜¤âš¡', streak: 'ðŸ’«âš¡', src: 'â€” Dragon Ball Z' },
];
const SENSEI_MSGS = {
  correct: [
    'Excellent work! Your progress is undeniable!',
    'That is correct. Logic and persistence â€” a winning combination.',
    'Nice one! Keep moving forward â€” that\'s the way of the ninja!',
    'Ten billion percent correct! Science of learning prevails!',
    'Perfect! Every correct answer protects what matters most.',
    'You\'re getting stronger! Power level rising!',
  ],
  wrong: [
    'Even the greatest heroes fall before they fly. Again!',
    'Incorrect. But gathering data on mistakes is also progress.',
    'Failure is just another step on the path of the Leaf!',
    'A setback? Good. Use it as fuel for the next ten billion attempts!',
    'Don\'t give up! Your heart is stronger than any mistake.',
    'A Super Saiyan never stays down. Rise again!',
  ],
  streak: [
    'I am here â€” and so is your streak! Plus Ultra!!',
    'Impressive deduction. N consecutive correct answers detected.',
    'The flames of youth burn bright! Don\'t let them go out!',
    'This is science â€” repeated success builds mastery!',
    'Your strength makes me want to cry happy tears!',
    'This power... could it be... a new transformation!?',
  ],
};
let _currentSensei = null;
let _streakCount = 0;

function getSenseiReaction(type) {
  if (!_currentSensei) _currentSensei = SENSEIS[Math.floor(Math.random() * SENSEIS.length)];
  const senseiIdx = SENSEIS.indexOf(_currentSensei);
  const msgs = SENSEI_MSGS[type] || SENSEI_MSGS.correct;
  const msg = msgs[senseiIdx] || msgs[0];
  const avatar = type === 'correct' ? _currentSensei.correct
               : type === 'wrong' ? _currentSensei.wrong
               : _currentSensei.streak;
  return { avatar, msg, name: _currentSensei.name, src: _currentSensei.src };
}

function showSenseiCharacter(type) {
  const s = getSenseiReaction(type);
  const el = document.getElementById('senseiQuote');
  el.innerHTML = `
    <div class="sensei-char-wrap ${type}-style">
      <div class="sensei-avatar">${s.avatar}</div>
      <div class="sensei-bubble">
        <div class="sensei-char-name">${s.name} ${s.src}</div>
        <div class="sensei-char-text">${s.msg}</div>
      </div>
    </div>`;
  el.className = 'sensei-quote show';
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// DAILY CHALLENGE
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let isDailyChallengeMode = false;
const DC_SIZE = 10;

function getDailyChallengeSeed() {
  const d = new Date();
  return `${d.getFullYear()}-${d.getMonth()+1}-${d.getDate()}`;
}

function seededShuffle(arr, seed) {
  // Simple seeded pseudo-random using seed string
  let s = 0;
  for (let i = 0; i < seed.length; i++) s = (s + seed.charCodeAt(i)) & 0xffffffff;
  const a = [...arr];
  for (let i = a.length - 1; i > 0; i--) {
    s = (s * 1664525 + 1013904223) & 0xffffffff;
    const j = Math.abs(s) % (i + 1);
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}

function getDailyChallengeWords() {
  // Combine all levels, seeded shuffle, pick 10
  const allWords = Object.values(vocab).flat();
  const seed = getDailyChallengeSeed();
  return seededShuffle(allWords, seed).slice(0, DC_SIZE);
}

function getDailyChallengeProgress() {
  const raw = localStorage.getItem('jlpt_daily_challenge');
  const today = getDailyChallengeSeed();
  if (!raw) return { date: '', completed: false, score: 0, answered: 0 };
  const p = JSON.parse(raw);
  if (p.date !== today) return { date: today, completed: false, score: 0, answered: 0 };
  return p;
}

function saveDailyChallengeProgress(data) {
  localStorage.setItem('jlpt_daily_challenge', JSON.stringify({ ...data, date: getDailyChallengeSeed() }));
}

function initDailyChallenge() {
  const dc = getDailyChallengeProgress();
  const fill = document.getElementById('dcProgressFill');
  const label = document.getElementById('dcProgressLabel');
  const card = document.getElementById('dailyChallengeCard');
  const title = document.getElementById('dcTitle');
  const sub = document.getElementById('dcSub');
  const resetLabel = document.getElementById('dcResetLabel');

  if (dc.completed) {
    if (fill) fill.style.width = '100%';
    if (label) label.textContent = `${dc.score} / ${DC_SIZE} âœ“`;
    const badge = document.createElement('div');
    badge.className = 'dc-completed-badge';
    badge.textContent = `âœ… Today's challenge complete! Score: ${dc.score}/${DC_SIZE}`;
    const row = document.getElementById('dcProgressRow');
    if (row) { row.innerHTML = ''; row.appendChild(badge); }
    if (resetLabel) resetLabel.textContent = 'âœ“ Done today';
  } else {
    const pct = dc.answered > 0 ? (dc.answered / DC_SIZE * 100) : 0;
    if (fill) fill.style.width = pct + '%';
    if (label) label.textContent = `${dc.answered} / ${DC_SIZE}`;
  }
}

function startDailyChallenge() {
  const dc = getDailyChallengeProgress();
  if (dc.completed) {
    // Show results toast
    const ach = { icon: 'ðŸ†', name: 'Daily Done!', desc: `Today's score: ${dc.score}/${DC_SIZE} Â· Come back tomorrow!` };
    showAchievementToast(ach);
    return;
  }

  isDailyChallengeMode = true;
  _currentSensei = SENSEIS[Math.floor(Math.random() * SENSEIS.length)];
  qIdx = dc.answered || 0; score = dc.score || 0; lives = 99; results = []; answered = false; _sessionXP = 0;
  pool = getDailyChallengeWords();
  currentLevel = 'N5'; // mixed, but use N5 for XP
  currentMode = 'meaning';

  // If partially done, fast-forward
  if (dc.answered > 0) {
    qIdx = dc.answered;
    score = dc.score;
  }

  document.getElementById('progFill').style.background = 'linear-gradient(90deg, var(--gold), #f0c040)';
  document.getElementById('gtLevel').textContent = 'ðŸ† Daily Challenge';
  document.getElementById('gtLevel').style.color = 'var(--gold)';
  document.getElementById('gtRank').textContent = `${DC_SIZE} questions Â· 2Ã— XP`;

  const dcHeader = document.getElementById('dcGameHeader');
  if (dcHeader) dcHeader.style.display = 'block';

  showScreen('gameScreen');
  updateXpHUD();
  updateQCounter();
  renderQ();
}

function endDailyChallenge() {
  const dc = getDailyChallengeProgress();
  saveDailyChallengeProgress({ completed: true, score, answered: DC_SIZE });
  isDailyChallengeMode = false;

  // Award 2x XP
  const p = getProgress();
  const earned = calcSessionXP(results, 'N5') * 2;
  const oldXp = p.totalXP || 0;
  p.totalXP = oldXp + earned;
  p.totalSessions = (p.totalSessions || 0) + 1;
  const today = new Date().toISOString().slice(0,10);
  const yesterday = new Date(Date.now()-86400000).toISOString().slice(0,10);
  if (p.lastVisit === yesterday) p.streak = (p.streak||0) + 1;
  else if (p.lastVisit !== today) p.streak = 1;
  p.lastVisit = today;
  saveProgress(p);
  setTimeout(() => checkRankUp(oldXp, p.totalXP), 800);

  showScreen('scoreScreen');

  const correct = results.filter(Boolean).length;
  const total = results.length;
  const pct = total > 0 ? correct/total : 0;
  let jp, en, sub;
  if (pct===1)     {jp='å®Œç’§ï¼'; en='Daily Challenge: Perfect!'; sub='Legendary! All 10 questions correct â€” see you tomorrow!';}
  else if(pct>=.8) {jp='ç´ æ™´ã‚‰ã—ã„ï¼'; en='Daily Challenge: Excellent!'; sub='Great work on today\'s challenge!';}
  else if(pct>=.6) {jp='è‰¯ã„ï¼'; en='Daily Challenge: Good Work!'; sub='Solid effort â€” try again tomorrow for a better score!';}
  else             {jp='é ‘å¼µã‚Œï¼'; en='Daily Challenge: Keep Going!'; sub='Every attempt improves your skills. Tomorrow is a new day!';}

  document.getElementById('scoreJP').textContent = jp;
  document.getElementById('scoreEN').textContent = en;
  document.getElementById('scoreNum').textContent = correct;
  document.getElementById('scoreDenom').textContent = `/ ${DC_SIZE} correct (2Ã— XP bonus!)`;
  document.getElementById('scoreSub').textContent = sub;
  document.getElementById('dotsRow').innerHTML = results.map(r=>`<div class="dot ${r?'hit':'miss'}">${r?'âœ…':'âŒ'}</div>`).join('');

  const prog = getXpProgress(p.totalXP || 0);
  document.getElementById('sxpTitle').textContent = `ðŸ† Daily Challenge Complete! 2Ã— XP Bonus Applied!`;
  document.getElementById('sxpSub').textContent = `Total XP: ${p.totalXP||0} Â· Streak: ðŸ”¥${p.streak||0}`;
  document.getElementById('sxpTotal').textContent = `+${earned}`;

  const q = animeQuotes[Math.floor(Math.random() * animeQuotes.length)];
  document.getElementById('sqJP').textContent = q.jp;
  document.getElementById('sqEN').textContent = q.en;
  document.getElementById('sqSRC').textContent = q.src;
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// PER-WORD ACCURACY TRACKING
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function getWordAccuracy() {
  const raw = localStorage.getItem('jlpt_word_accuracy');
  return raw ? JSON.parse(raw) : {};
}
function saveWordAccuracy(data) {
  localStorage.setItem('jlpt_word_accuracy', JSON.stringify(data));
}
function recordWordAnswer(kanji, correct) {
  const acc = getWordAccuracy();
  if (!acc[kanji]) acc[kanji] = { correct: 0, total: 0 };
  acc[kanji].total++;
  if (correct) acc[kanji].correct++;
  saveWordAccuracy(acc);
}

let _wordAccFilter = 'all';
function openWordAcc() {
  renderWordAccList();
  document.getElementById('wordAccOverlay').classList.add('show');
}
function closeWordAcc() {
  document.getElementById('wordAccOverlay').classList.remove('show');
}
function filterWordAcc(el, filter) {
  _wordAccFilter = filter;
  document.querySelectorAll('.waf-pill').forEach(p => p.classList.remove('sel'));
  el.classList.add('sel');
  renderWordAccList();
}
function renderWordAccList() {
  const acc = getWordAccuracy();
  const allWords = Object.values(vocab).flat();
  const list = document.getElementById('wordAccList');
  if (!list) return;

  let items = Object.entries(acc).map(([k, v]) => {
    const word = allWords.find(w => w.k === k);
    if (!word) return null;
    return { ...word, correct: v.correct, total: v.total, pct: v.total > 0 ? v.correct / v.total : 0 };
  }).filter(Boolean);

  if (_wordAccFilter === 'weak') items = items.filter(i => i.pct < 0.5);
  else if (_wordAccFilter === 'strong') items = items.filter(i => i.pct >= 0.8);

  items.sort((a, b) => a.pct - b.pct);

  if (items.length === 0) {
    list.innerHTML = `<div style="text-align:center;padding:30px;color:var(--stone);font-size:0.82rem">
      ${_wordAccFilter === 'all' ? 'No words tracked yet. Complete some sessions first!' : 'No words match this filter.'}
    </div>`;
    return;
  }

  list.innerHTML = items.slice(0, 100).map(item => {
    const pct = Math.round(item.pct * 100);
    const color = pct >= 80 ? '#27ae60' : pct >= 50 ? '#e67e22' : '#c0392b';
    return `<div class="word-acc-item">
      <div class="wai-kanji">${item.k}</div>
      <div class="wai-info">
        <div class="wai-reading">${item.f} Â· ${item.r}</div>
        <div class="wai-meaning">${item.m}</div>
      </div>
      <div class="wai-bar-wrap">
        <div class="wai-bar-track"><div class="wai-bar-fill" style="width:${pct}%;background:${color}"></div></div>
        <div class="wai-pct" style="color:${color}">${pct}% (${item.correct}/${item.total})</div>
      </div>
    </div>`;
  }).join('');
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// WEEKLY REPORT CARD
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function getWeeklyData() {
  const raw = localStorage.getItem('jlpt_weekly');
  return raw ? JSON.parse(raw) : {};
}
function saveWeeklyData(data) {
  localStorage.setItem('jlpt_weekly', JSON.stringify(data));
}
function recordWeeklySession(xpEarned, correct, total) {
  const today = new Date().toISOString().slice(0,10);
  const data = getWeeklyData();
  if (!data[today]) data[today] = { xp: 0, correct: 0, total: 0, sessions: 0 };
  data[today].xp += xpEarned;
  data[today].correct += correct;
  data[today].total += total;
  data[today].sessions++;
  saveWeeklyData(data);
}

function openWeekly() {
  renderWeeklyReport();
  document.getElementById('weeklyOverlay').classList.add('show');
}
function closeWeekly() {
  document.getElementById('weeklyOverlay').classList.remove('show');
}
function renderWeeklyReport() {
  const data = getWeeklyData();
  const today = new Date();
  const DAY_NAMES = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];

  // Last 7 days
  const days = [];
  for (let i = 6; i >= 0; i--) {
    const d = new Date(today);
    d.setDate(d.getDate() - i);
    const key = d.toISOString().slice(0,10);
    days.push({ key, name: DAY_NAMES[d.getDay()], ...( data[key] || { xp:0, correct:0, total:0, sessions:0 }) });
  }

  // Compute KPIs
  const totalWords = days.reduce((s,d) => s + d.total, 0);
  const totalXP = days.reduce((s,d) => s + d.xp, 0);
  const totalCorrect = days.reduce((s,d) => s + d.correct, 0);
  const totalAnswered = days.reduce((s,d) => s + d.total, 0);
  const avgAcc = totalAnswered > 0 ? Math.round(totalCorrect / totalAnswered * 100) + '%' : 'â€”';
  const bestDay = days.reduce((best, d) => d.xp > (best?.xp || 0) ? d : best, null);

  document.getElementById('wkWords').textContent = totalWords;
  document.getElementById('wkXP').textContent = totalXP;
  document.getElementById('wkAcc').textContent = avgAcc;
  document.getElementById('wkBestDay').textContent = bestDay?.xp > 0 ? bestDay.name : 'â€”';

  // Date range label
  const start = days[0].key.slice(5);
  const end = days[6].key.slice(5);
  document.getElementById('weeklyDateRange').textContent = `${start} â†’ ${end}`;

  // Days row
  const p = getProgress();
  document.getElementById('weeklyDaysRow').innerHTML = days.map(d => `
    <div class="weekly-day">
      <div class="wd-name">${d.name}</div>
      <div class="wd-dot ${d.sessions > 0 ? 'studied' : ''}"></div>
      <div class="wd-xp">${d.xp > 0 ? '+'+d.xp : 'â€”'}</div>
    </div>`).join('');

  // Rank summary
  const rank = getXpRank(p.totalXP || 0);
  const prog = getXpProgress(p.totalXP || 0);
  document.getElementById('wkRankSummary').innerHTML =
    `${rank.badge} <strong>${rank.name}</strong> Â· Total XP: ${p.totalXP || 0} ` +
    (prog.next ? `Â· ${prog.inRank}/${prog.rankTotal} XP to <strong>${prog.next.name}</strong>` : 'Â· <strong>Max Rank!</strong>');
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// LEVEL COMPLETION CERTIFICATE
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let _certLevel = '';
function showCertificate(level) {
  _certLevel = level;
  const totalWords = vocab[level]?.length || 0;
  const lvMeta = { N5:{stamp:'ðŸ¥‹',color:'#27ae60'}, N4:{stamp:'âš”ï¸',color:'#2980b9'}, N3:{stamp:'ðŸ—¡ï¸',color:'#8e44ad'}, N2:{stamp:'ðŸ‘ï¸',color:'#e67e22'}, N1:{stamp:'ðŸŒŸ',color:'#c0392b'} };
  const m = lvMeta[level] || { stamp:'ðŸ†', color:'var(--crimson)' };

  document.getElementById('certStamp').textContent = m.stamp;
  document.getElementById('certLevel').textContent = level;
  document.getElementById('certLevel').style.background = m.color;
  document.getElementById('certWordCount').textContent = totalWords;
  document.getElementById('certDate').textContent = new Date().toLocaleDateString('en-US', { year:'numeric', month:'long', day:'numeric' });

  document.getElementById('certOverlay').classList.add('show');

  // Sound celebration
  soundLevelUp();
}

function closeCert() {
  document.getElementById('certOverlay').classList.remove('show');
}

function shareCertificate() {
  const level = _certLevel;
  const totalWords = vocab[level]?.length || 0;
  const text = `ðŸŽŒ I just mastered all ${totalWords} ${level} words on JLPT Vocabulary Master!\n\n${level === 'N1' ? 'ðŸŒŸ Near-native level achieved!' : 'ðŸ¥‹ Levelling up to the next challenge!'}\n\nhttps://jlptvocabmaster.github.io/jlpt-vocab-master/`;
  if (navigator.share) {
    navigator.share({ title: `JLPT ${level} Complete!`, text });
  } else {
    navigator.clipboard.writeText(text).then(() => {
      const ach = { icon: 'ðŸ“‹', name: 'Copied!', desc: 'Certificate text copied to clipboard' };
      showAchievementToast(ach);
    });
  }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// EXPORT CSV
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function exportCSV() {
  const acc = getWordAccuracy();
  const allWords = Object.values(vocab).flat();
  const p = getProgress();

  const rows = [['Kanji','Furigana','Romaji','Meaning','Level','Seen','Correct','Total','Accuracy%']];
  allWords.forEach(w => {
    const level = Object.entries(vocab).find(([l,ws]) => ws.some(v => v.k === w.k))?.[0] || '';
    const seen = p.seenWords[level]?.includes(w.k) ? 'Yes' : 'No';
    const a = acc[w.k] || { correct:0, total:0 };
    const pct = a.total > 0 ? Math.round(a.correct/a.total*100) : '';
    rows.push([w.k, w.f, w.r, w.m, level, seen, a.correct, a.total, pct]);
  });

  const csv = rows.map(r => r.map(c => `"${String(c).replace(/"/g,'""')}"`).join(',')).join('\n');
  const blob = new Blob([csv], { type: 'text/csv' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = 'jlpt_vocab_progress.csv'; a.click();
  URL.revokeObjectURL(url);
}

function shareProgressImage() {
  const p = getProgress();
  const rank = getXpRank(p.totalXP || 0);
  const totalWords = Object.values(p.seenWords).reduce((s,v)=>s+v.length,0);
  const text = `ðŸŽŒ JLPT Vocabulary Progress Report\n\n${rank.badge} Rank: ${rank.name}\nâ­ Total XP: ${p.totalXP||0}\nðŸ”¥ Streak: ${p.streak||0} days\nðŸ“š Words Studied: ${totalWords}\n\nStart your journey: https://jlptvocabmaster.github.io/jlpt-vocab-master/`;
  if (navigator.share) {
    navigator.share({ title: 'My JLPT Progress', text });
  } else {
    navigator.clipboard.writeText(text).then(() => {
      const ach = { icon: 'ðŸ“‹', name: 'Copied!', desc: 'Progress report copied to clipboard' };
      showAchievementToast(ach);
    });
  }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// INTRO TOGGLE
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function toggleIntro() {
  const body    = document.getElementById('introBody');
  const chevron = document.getElementById('introChevron');
  const btn     = document.getElementById('introToggleBtn');
  const isOpen  = body.classList.contains('open');
  body.classList.toggle('open', !isOpen);
  chevron.classList.toggle('open', !isOpen);
  btn.setAttribute('aria-expanded', String(!isOpen));
  // round top corners when open
  btn.style.borderRadius = !isOpen ? '14px 14px 0 0' : '14px';
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// INIT
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
initDarkMode();
loadHomeQuote();
initCanvas();
initHomeUI();
initDailyWord();
initDailyChallenge();
updateStudyAllSub();
checkAchievements();
initRomaji();
initKeyboardShortcuts();
// Show onboarding after a small delay so the page renders first
setTimeout(initOnboarding, 400);
</script>
<!-- Mistake Bank overlay -->
<div id="mistakeBankOverlay" onclick="if(event.target===this)closeMistakeBank()" style="display:none;position:fixed;inset:0;z-index:9999;background:rgba(26,26,46,.65);backdrop-filter:blur(4px);align-items:flex-start;justify-content:center;padding:20px;overflow-y:auto">
  <div style="background:var(--paper);border-radius:20px;padding:0;max-width:500px;width:100%;margin:auto;overflow:hidden;box-shadow:0 24px 80px rgba(0,0,0,.3)">
    <div style="background:linear-gradient(135deg,var(--ink),#2c3e50);padding:20px 22px;display:flex;align-items:center;justify-content:space-between">
      <div>
        <div style="font-family:'DM Serif Display',serif;font-size:1.2rem;color:white">âŒ Mistake Bank</div>
        <div style="font-size:0.68rem;color:#94a3b8;margin-top:3px">Questions you got wrong â€” review &amp; master them</div>
      </div>
      <button onclick="closeMistakeBank()" style="background:rgba(255,255,255,.1);border:none;border-radius:10px;padding:8px 12px;color:white;cursor:pointer;font-size:0.85rem">âœ• Close</button>
    </div>
    <div id="mistakeBankBody" style="padding:16px;max-height:70vh;overflow-y:auto"></div>
  </div>
</div>


<!-- â”€â”€ LEVEL COMPLETION CERTIFICATE â”€â”€ -->
<div class="cert-overlay" id="certOverlay" onclick="if(event.target===this)closeCert()">
  <div class="cert-box" id="certBox">
    <div class="cert-border-top"></div>
    <div class="cert-header">
      <span class="cert-stamp" id="certStamp">ðŸ¥‹</span>
      <div class="cert-title">Certificate of Mastery</div>
      <div class="cert-sub">æ—¥æœ¬èªžå˜èªžãƒžã‚¹ã‚¿ãƒ¼</div>
    </div>
    <div class="cert-body">
      <div style="font-size:0.72rem;color:var(--stone);margin-bottom:8px">This certifies that you have studied every word in</div>
      <div class="cert-level-badge" id="certLevel">N5</div>
      <div class="cert-words-count" id="certWordCount">0</div>
      <div class="cert-words-label">vocabulary words mastered</div>
      <div class="cert-date" id="certDate"></div>
      <div style="font-family:'DM Serif Display',serif;font-size:0.9rem;color:var(--stone);border-top:1px solid var(--border);padding-top:12px;margin-top:4px">
        JLPT Vocabulary Master Â· Always Free
      </div>
    </div>
    <div class="cert-border-bottom"></div>
    <div class="cert-actions">
      <button class="cert-btn cert-btn-share" onclick="shareCertificate()">ðŸ“¤ Share Certificate</button>
      <button class="cert-btn cert-btn-close" onclick="closeCert()">âœ• Close</button>
    </div>
  </div>
</div>

<!-- â”€â”€ PER-WORD ACCURACY OVERLAY â”€â”€ -->
<div class="word-acc-overlay" id="wordAccOverlay" onclick="if(event.target===this)closeWordAcc()">
  <div class="word-acc-box">
    <div class="word-acc-header">
      <div>
        <div class="word-acc-title">ðŸ“Š Word Accuracy</div>
        <div style="font-size:0.68rem;color:#94a3b8;margin-top:2px">Track which words you always get right or wrong</div>
      </div>
      <button onclick="closeWordAcc()" style="background:rgba(255,255,255,.1);border:none;border-radius:10px;padding:8px 12px;color:white;cursor:pointer;font-size:0.85rem">âœ• Close</button>
    </div>
    <div class="word-acc-body">
      <div class="word-acc-filter">
        <button class="waf-pill sel" onclick="filterWordAcc(this,'all')">All Words</button>
        <button class="waf-pill" onclick="filterWordAcc(this,'weak')">âŒ Weak (&lt;50%)</button>
        <button class="waf-pill" onclick="filterWordAcc(this,'strong')">âœ… Strong (â‰¥80%)</button>
      </div>
      <div id="wordAccList"></div>
    </div>
  </div>
</div>

<!-- â”€â”€ WEEKLY REPORT OVERLAY â”€â”€ -->
<div class="weekly-overlay" id="weeklyOverlay" onclick="if(event.target===this)closeWeekly()">
  <div class="weekly-box">
    <div class="weekly-header">
      <div class="weekly-header-title">ðŸ“… Weekly Report Card</div>
      <div class="weekly-header-sub" id="weeklyDateRange">This week's study summary</div>
    </div>
    <div class="weekly-body">
      <div class="weekly-kpi-grid">
        <div class="weekly-kpi">
          <div class="weekly-kpi-val" id="wkWords">0</div>
          <div class="weekly-kpi-lbl">Words Studied</div>
        </div>
        <div class="weekly-kpi">
          <div class="weekly-kpi-val" id="wkXP">0</div>
          <div class="weekly-kpi-lbl">XP Earned</div>
        </div>
        <div class="weekly-kpi">
          <div class="weekly-kpi-val" id="wkAcc">â€”</div>
          <div class="weekly-kpi-lbl">Avg Accuracy</div>
        </div>
        <div class="weekly-kpi">
          <div class="weekly-kpi-val" id="wkBestDay">â€”</div>
          <div class="weekly-kpi-lbl">Best Day</div>
        </div>
      </div>
      <div style="font-size:0.72rem;font-weight:700;color:var(--stone);margin-bottom:8px;letter-spacing:1px;text-transform:uppercase">Activity This Week</div>
      <div class="weekly-days-row" id="weeklyDaysRow"></div>
      <div style="font-size:0.72rem;font-weight:700;color:var(--stone);margin-bottom:8px;letter-spacing:1px;text-transform:uppercase">Rank Progress</div>
      <div id="wkRankSummary" style="background:var(--white);border-radius:12px;padding:12px 14px;font-size:0.82rem;color:var(--stone);line-height:1.6;border:1px solid var(--border)"></div>
      <div class="weekly-export-row">
        <button class="weekly-export-btn" onclick="exportCSV()">â¬‡ï¸ Export CSV</button>
        <button class="weekly-export-btn" onclick="shareProgressImage()">ðŸ“¤ Share Progress</button>
        <button class="weekly-export-btn" onclick="closeWeekly()">âœ• Close</button>
      </div>
    </div>
  </div>
</div>

<!-- Custom back confirm (replaces browser confirm() which fails on mobile) -->
<div id="backConfirmOverlay" onclick="if(event.target===this)closeBackConfirm()" style="display:none;position:fixed;inset:0;z-index:10000;background:rgba(26,26,46,.6);backdrop-filter:blur(4px);align-items:center;justify-content:center;padding:20px">
  <div style="background:white;border-radius:20px;padding:28px 24px;max-width:300px;width:100%;text-align:center;box-shadow:0 24px 80px rgba(0,0,0,.3)">
    <div style="font-size:2.2rem;margin-bottom:8px">ðŸ </div>
    <div style="font-family:'DM Serif Display',serif;font-size:1.15rem;color:var(--ink);margin-bottom:6px">Go back to home?</div>
    <div style="font-size:0.78rem;color:var(--stone);margin-bottom:20px">Your progress is saved automatically.</div>
    <div style="display:flex;gap:10px">
      <button onclick="closeBackConfirm()" style="flex:1;padding:12px;background:#f1f5f9;border:none;border-radius:12px;font-family:'DM Serif Display',serif;font-size:0.9rem;cursor:pointer;color:var(--ink)">Cancel</button>
      <button onclick="closeBackConfirm();goHome()" style="flex:1;padding:12px;background:var(--crimson);border:none;border-radius:12px;font-family:'DM Serif Display',serif;font-size:0.9rem;cursor:pointer;color:white">Yes, Home</button>
    </div>
  </div>
</div>

</body>
</html>
